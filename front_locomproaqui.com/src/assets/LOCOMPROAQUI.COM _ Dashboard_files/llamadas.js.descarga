
jQuery(document).ready(function($) {



   

  $('#dropDownDir').click(function(){

    $('.drop-downDir').toggleClass('drop-downDir--active');

  });





   $('li').click(function() {

    index=$(this).index();

		$(':radio').eq(index).prop('checked', true);

	});

	

	/*$('#query').on('keyup',function(event) {

		

		$.get('search_product.php', { query: $(this).val() }, function (data) 

		{

			data = $.parseJSON(data);

			console.info(data);

		});

	});*/

	

	/*$('#query').typeahead({

      	source: function (query, process) {

			return $.get('search_product.php', { query: query }, function (data) 

			{	

				

                //return process(objects);



				data = $.parseJSON(data);

				console.log(data);

				//return data;

				return process(data);

			});

		},

      	highlighter: function(item) {

      	//console.log(item);

      	console.log("Name: " + item);

        var parts = item.split('#'),

        html = '<div><div class="typeahead-inner" id="' + parts[2] + '">';

        html += '<div class="item-img" style="background-image: url(' + parts[1] + ')"></div>';

        html += '<div class="item-body">';

        html += '<p class="item-heading">' + parts[0] + '</p>';

        html += '</div>';

        html += '</div></div>';



        var query = this.query;

        var reEscQuery = query.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");

        var reQuery = new RegExp('(' + reEscQuery + ')', "gi");

        var jElem = $(html);

        var textNodes = $(jElem.find('*')).add(jElem).contents().filter(function() {

          return this.nodeType === 3;

        });

        textNodes.replaceWith(function() {

          return $(this).text().replace(reQuery, '<strong>$1</strong>');

        });



        return jElem.html();

      },

      updater: function(selectedName) {

      	console.log("opcion" + selectedName);

        var name = selectedName.split('#')[0];

        console.log("Seleccion" + name );

        return name;

      }

    });

*/

	var $input = $('#bustxtproducto');

	$input.typeahead({

		source: function (query, process) {

			return $.get('search_product.php', { query: query }, function (data) 

			{

				console.log(data);

				data = $.parseJSON(data);

				return process(data);

			});

		},

		showHintOnFocus:false,

		items: 20,

		autoSelect:false,

		afterSelect:function(){

			$('#idcategoria').val('');

			 $('#gadcategoria').html($input.val());

			//$('#buscatalogo').val($input.val());

			CRUDPEDIDOS('LISTAPRODUCTOS','','');

		}

	});



	$input.on('keyup',function(e){

		if(e.which==13) {

			$('#idcategoria').val('');

			$('#gadcategoria').html($input.val());

			CRUDPEDIDOS('LISTAPRODUCTOS','','');

		}

	});



	$btnsearch = $('#search-btn');

	$btnsearch.on('click',function(e){		

		

			$('#idcategoria').val('');

			$('#gadcategoria').html($input.val());

			CRUDPEDIDOS('LISTAPRODUCTOS','','');

		}

	);





   

	/*var $input2 = $('#busquedageneral');

	$input2.typeahead({

		source: function (query, process) {



			return $.get('search_product.php', { query: query }, function (data) 

			{

				data = $.parseJSON(data);

				return process(data);

			});

		},

		showHintOnFocus:false

,		items: 20,

		autoSelect:false,

		afterSelect:function(){

			$('#buscatalogo').val($input2.val());

			CRUDPEDIDOS('LISTAPRODUCTOS','','');

		}

	});



	$input2.on('keyup',function(e){

		$('#buscatalogo').val($input2.val());

		if(e.which==13) {

			CRUDPEDIDOS('LISTAPRODUCTOS','','');

		}

	});

	*/

	



});



  const toast = swal.mixin({

      toast: true,

      position: 'bottom-end',

      showConfirmButton: false,

      timer: 5000

    });

  function ok(msn)

  {

  	toast({

  		type: 'success',

  		title: msn

	})

  }

   function info(msn)

  {

  	toast({

  		type: 'success',

  		title: msn

	})

  }



  function error(msn)

  {

  	toast({

  		type: 'error',

  		title: msn

	})

  }



  function ok2(msn)

  {

	  swal({

		position: 'center',

		type: 'success',

		title: msn,

		showConfirmButton: true,

		confirmButtonText:"Aceptar"

		})

  }

  function error2(msn)

  {

	swal({

	position: 'center',

	type: 'error',

	title: msn,

	showConfirmButton: true,

	confirmButtonText:"Aceptar"

	//timer: 1500

	})

  }



  function validar_texto(e)

	{

	    tecla = (document.all) ? e.keyCode : e.which;	

	    //Tecla de retroceso para borrar, siempre la permite

	    if (tecla==8)

	    {

	        return true;

	    }	

	    // Patron de entrada, en este caso solo acepta numeros

	   	patron =/[0-9\.]/g, "0";	

	    tecla_final = String.fromCharCode(tecla);	

	    return patron.test(tecla_final);

	} 

	String.prototype.trim = function () {

	return this.replace(/^\s+/, '').replace(/\s+$/, '');

	};

	  

	String.prototype.capitalizeParagraph = function() {

		 var res = "";

        //var paragraphs = this.split(".")

		res  = this.toUpperCase();

        /*for(var i = 0; i < paragraphs.length ; i++) {

            var temp = paragraphs[i];

            res += "." + temp.charAt(0).toUpperCase() + temp.slice(1);

        }*/

        return res;//.slice(1);

	};

function CAMBIAR()

{

	var ant = formcambiar.anterior.value;

	var nue = formcambiar.nueva.value;

	var conf = formcambiar.confirmar.value;



	$.post('funciones/usuarios/fnCambiarContrasena.php', { cambiarcon:'si',ant:ant,nue:nue,conf:conf }, function(data){

		if(data == "1")

		{

			ok("Contraseña cambiada correctamente.");

			data = "Contraseña cambiada correctamente.";

		}

		else

		{

			error(data);

		}



		$('#datoscambiar').html(data);

	});

}

function INICIALIZAR(mod)

{

	console.info(mod);

	$('#divfiltropedido').addClass('hide');

	$('#bustxtproducto').val('');

	if(mod=="Home")

	{

		$(".connectedSortable").sortable({

		placeholder: "sort-highlight",

		connectWith: ".connectedSortable",

		handle: ".box-header, .nav-tabs",

		forcePlaceholderSize: true,

		zIndex: 999999

		});

		$(".connectedSortable .box-header, .connectedSortable .nav-tabs-custom").css("cursor", "move");



		//jQuery UI sortable for the todo list

		$(".todo-list").sortable({

		placeholder: "sort-highlight",

		handle: ".handle",

		forcePlaceholderSize: true,

		zIndex: 999999

		});



		//bootstrap WYSIHTML5 - text editor

		$(".textarea").wysihtml5();



		$('.daterange').daterangepicker({

		ranges: {

		'Today': [moment(), moment()],

		'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],

		'Last 7 Days': [moment().subtract(6, 'days'), moment()],

		'Last 30 Days': [moment().subtract(29, 'days'), moment()],

		'This Month': [moment().startOf('month'), moment().endOf('month')],

		'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]

		},

		startDate: moment().subtract(29, 'days'),

		endDate: moment()

		}, function (start, end) {

		window.alert("You chose: " + start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));

		});



		/* jQueryKnob */

		$(".knob").knob();



		//jvectormap data

		var visitorsData = {

		"US": 398, //USA

		"SA": 400, //Saudi Arabia

		"CA": 1000, //Canada

		"DE": 500, //Germany

		"FR": 760, //France

		"CN": 300, //China

		"AU": 700, //Australia

		"BR": 600, //Brazil

		"IN": 800, //India

		"GB": 320, //Great Britain

		"RU": 3000 //Russia

		};

		//World map by jvectormap

		$('#world-map').vectorMap({

		map: 'world_mill_en',

		backgroundColor: "transparent",

		regionStyle: {

		initial: {

		fill: '#e4e4e4',

		"fill-opacity": 1,

		stroke: 'none',

		"stroke-width": 0,

		"stroke-opacity": 1

		}

		},

		series: {

		regions: [{

		values: visitorsData,

		scale: ["#92c1dc", "#ebf4f9"],

		normalizeFunction: 'polynomial'

		}]

		},

		onRegionLabelShow: function (e, el, code) {

		if (typeof visitorsData[code] != "undefined")

		el.html(el.html() + ': ' + visitorsData[code] + ' new visitors');

		}

		});



		//Sparkline charts

		var myvalues = [1000, 1200, 920, 927, 931, 1027, 819, 930, 1021];

		$('#sparkline-1').sparkline(myvalues, {

		type: 'line',

		lineColor: '#92c1dc',

		fillColor: "#ebf4f9",

		height: '50',

		width: '80'

		});

		myvalues = [515, 519, 520, 522, 652, 810, 370, 627, 319, 630, 921];

		$('#sparkline-2').sparkline(myvalues, {

		type: 'line',

		lineColor: '#92c1dc',

		fillColor: "#ebf4f9",

		height: '50',

		width: '80'

		});

		myvalues = [15, 19, 20, 22, 33, 27, 31, 27, 19, 30, 21];

		$('#sparkline-3').sparkline(myvalues, {

		type: 'line',

		lineColor: '#92c1dc',

		fillColor: "#ebf4f9",

		height: '50',

		width: '80'

		});



		//The Calender

		$("#calendar").datepicker();



		//SLIMSCROLL FOR CHAT WIDGET

		$('#chat-box').slimScroll({

		height: '250px'

		});



		/* Morris.js Charts */

		// Sales chart

		var area = new Morris.Area({

		element: 'revenue-chart',

		resize: true,

		data: [

		{y: '2015 Q1', item1: 2666, item2: 2666},

		{y: '2015 Q2', item1: 2778, item2: 2294},

		{y: '2015 Q3', item1: 4912, item2: 1969},

		{y: '2015 Q4', item1: 3767, item2: 3597},

		{y: '2016 Q1', item1: 6810, item2: 1914},

		{y: '2017 Q2', item1: 5670, item2: 4293},

		{y: '2017 Q3', item1: 4820, item2: 3795},

		{y: '2018 Q4', item1: 15073, item2: 5967},

		{y: '2018 Q1', item1: 10687, item2: 4460},

		{y: '2018 Q2', item1: 8432, item2: 5713}

		],

		xkey: 'y',

		ykeys: ['item1', 'item2'],

		labels: ['Item 1', 'Item 2'],

		lineColors: ['#a0d0e0', '#3c8dbc'],

		hideHover: 'auto'

		});





		/*var line = new Morris.Line({

		element: 'line-chart',

		resize: true,

		data: [

		{y: '2015 Q1', item1: 2666},

		{y: '2015 Q2', item1: 2778},

		{y: '2015 Q3', item1: 4912},

		{y: '2015 Q4', item1: 3767},

		{y: '2016 Q1', item1: 6810},

		{y: '2017 Q2', item1: 5670},

		{y: '2017 Q3', item1: 4820},

		{y: '2018 Q4', item1: 15073},

		{y: '2018 Q1', item1: 10687},

		{y: '2018 Q2', item1: 8432}

		],

		xkey: 'y',

		ykeys: ['item1'],

		labels: ['Item 1'],

		lineColors: ['#efefef'],

		lineWidth: 2,

		hideHover: 'auto',

		gridTextColor: "#fff",

		gridStrokeWidth: 0.4,

		pointSize: 4,

		pointStrokeColors: ["#efefef"],

		gridLineColor: "#efefef",

		gridTextFamily: "Open Sans",

		gridTextSize: 10

		});*/



		//Donut Chart

		var donut = new Morris.Donut({

		element: 'sales-chart',

		resize: true,

		colors: ["#3c8dbc", "#f56954", "#00a65a"],

		data: [

		{label: "Download Sales", value: 12},

		{label: "In-Store Sales", value: 30},

		{label: "Mail-Order Sales", value: 20}

		],

		hideHover: 'auto'

		});



		//Fix for charts under tabs

		$('.box ul.nav a').on('shown.bs.tab', function () {

		area.redraw();

		donut.redraw();

		//line.redraw();

		});



		/* The todo list plugin */

		$(".todo-list").todolist({

		onCheck: function (ele) {

		window.console.log("The element has been checked");

		return ele;

		},

		onUncheck: function (ele) {

		window.console.log("The element has been unchecked");

		return ele;

		}

		});

		$('#divbusquedageneral').hide();

		setTimeout(function(){

			CRUDPEDIDOS('CONTADORPEDIDOS','','');

		},100);

	}

	else if(mod=="Productos")

	{

		//$('#divbusquedageneral').hide();

		//

		//$('#busquedageneral').val('');

		$('#showvista').show();

		$('#hidevista').hide();

		//$('#btnbusqueda').attr('onclick',"CRUDPRODUCTOS('LISTAPRODUCTOS','')");

		$('#busproducto').attr('onchange',"CRUDPRODUCTOS('LISTAPRODUCTOS','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS',''),100);

		//setTimeout(CRUDPRODUCTOS('LISTAPRODUCTOS',''),200);

	}

	else if(mod=="ListaPrecios")

	{

		//$('#divbusquedageneral').hide();

		//$('#busquedageneral').val('');

		//$('#btnbusqueda').attr('onclick',"CRUDPRODUCTOS('LISTAPRECIOS','')");



		setTimeout(CRUDPRODUCTOS('FILTROS2',''),100);

		//setTimeout(CRUDPRODUCTOS('LISTAPRECIOS',''),200);



	}

	else if(mod=="VistaMosaico")

	{	

		//$('#divbusquedageneral').hide();	

		//$('#busquedageneral').val('');

		$('#showvista').hide();

		$('#hidevista').show();

		//$('#btnbusqueda').attr('onclick',"CRUDPRODUCTOS('VISTAMOSAICO','')");

		$('#busproducto').attr('onchange',"CRUDPRODUCTOS('VISTAMOSAICO','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS3',''),100);

		//setTimeout(CRUDPRODUCTOS('VISTAMOSAICO',''),200);

	}

	else if(mod=="Categorias")

	{

		//$('#divbusquedageneral').hide();

		//$('#busquedageneral').val('');

		//$('#btnbusqueda').attr('onclick',"CRUDCATEGORIAS('LISTACATEGORIAS','')");

	}

	else if(mod=="Usuarios")

	{

		//$('#divbusquedageneral').hide();

		//$('#busquedageneral').val('');

		//$('#btnbusqueda').attr('onclick',"CRUDUSUARIOS('LISTAUSUARIOS','')");

		setTimeout(CRUDUSUARIOS('FILTROS',''),100);

	}

	else if(mod=="Ofertas")

	{

		$('#divbusquedageneral').hide();

		$('#busproducto').hide();

		$('#contenidomodalleft').html('');

		//$('#busquedageneral').val('');		

		//$('#btnbusqueda').attr('onclick',"CRUDOFERTAS('LISTAOFERTAS','')");

		$('#busproducto').attr('onchange',"CRUDOFERTAS('LISTAOFERTAS','')");

		$('#busproducto').selectpicker('refresh');



		setTimeout(CRUDOFERTAS('NUEVO',''),100);

		//setTimeout(CRUDPRODUCTOS('LISTAPRODUCTOS',''),200);

	}

	else if(mod=="VistaMosaicoOfertas")

	{

		//$('#divbusquedageneral').hide();

		console.error(mod);

		$('#busproducto').show();

		//$('#busquedageneral').val('');	



		//$('#btnbusqueda').attr('onclick',"CRUDOFERTAS('VISTAMOSAICO','')");

		$('#busproducto').attr('onchange',"CRUDOFERTAS('VISTAMOSAICO','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS4',''),100);

		//setTimeout(CRUDPRODUCTOS('VISTAMOSAICO',''),200);

	}

	else if(mod=="ListaOfertas")

	{		

		//$('#divbusquedageneral').hide();

		$('#busproducto').show();

		//$('#busquedageneral').val('');		

		//$('#btnbusqueda').attr('onclick',"CRUDOFERTAS('LISTAOFERTAS','')");

		$('#busproducto').attr('onchange',"CRUDOFERTAS('LISTAOFERTAS','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS5',''),100);

	}

	else if(mod=="Inventario")

	{	

		//$('#divbusquedageneral').hide();	

		$('#busproducto').show();

		//$('#busquedageneral').val('');		

		//$('#btnbusqueda').attr('onclick',"CRUDINVENTARIO('LISTAINVENTARIO','')");

		$('#busproducto').attr('onchange',"CRUDINVENTARIO('LISTAINVENTARIO','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS6',''),100);

		setTimeout(menulateral(),100);

	}

	else if(mod=="Entradas")

	{		

		//$('#divbusquedageneral').hide();

		$('#busproducto').show();

		//$('#busquedageneral').val('');		

		//$('#btnbusqueda').attr('onclick',"CRUDINVENTARIO('LISTAENTRADAS','')");

		$('#busproducto').attr('onchange',"CRUDINVENTARIO('LISTAENTRADAS','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS7',''),100);

		setTimeout(menulateral(),100);

	}

	else if(mod=="Ventas")

	{

		//$('#divbusquedageneral').hide();

		$('#busproducto').show();

		//$('#busquedageneral').val('');

		//$('#btnbusqueda').attr('onclick',"CRUDINVENTARIO('LISTAENTRADAS','')");

		$('#busproducto').attr('onchange',"CRUDINVENTARIO('LISTAENTRADAS','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS10',''),100);

		setTimeout(menulateral(),100);

	}

	else if(mod=="Cobros")

	{

		//$('#divbusquedageneral').hide();

		$('#busproducto').show();

		//$('#busquedageneral').val('');

		//$('#btnbusqueda').attr('onclick',"CRUDINVENTARIO('LISTAENTRADAS','')");

		$('#busproducto').attr('onchange',"CRUDINVENTARIO('LISTAENTRADAS','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS11',''),100);

		setTimeout(menulateral(),100);

	}

	else if(mod=="Salidas")

	{		

		//$('#divbusquedageneral').hide();

		$('#busproducto').show();

		//$('#busquedageneral').val('');		

		//$('#btnbusqueda').attr('onclick',"CRUDINVENTARIO('LISTASALIDAS','')");

		$('#busproducto').attr('onchange',"CRUDINVENTARIO('LISTASALIDAS','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS8',''),100);

		setTimeout(menulateral(),100)	

	}

	else if(mod=="Pedidos")

	{

		//$('#divbusquedageneral').show();

		console.log("Modulo Pedidos");

		$('#divfiltropedido').removeClass('hide');

		$('#busproductopedido').show();

		//$('#busquedageneral').val('');

		//$('#btnbusqueda').attr('onclick',"CRUDPEDIDOS('LISTAPRODUCTOS','')");

		$('#busproductopedido').attr('onchange',"CRUDPEDIDOS('LISTAPRODUCTOS','')");

		$('#busproductopedido').selectpicker('refresh');

		setTimeout(CRUDPRODUCTOS('FILTROS9',''),100);

		//setTimeout(CRUDPEDIDOS('LISTADIRECCIONES',''),100)

	}

	else if(mod=="Proveedor")

	{

		//$('#divbusquedageneral').hide();

		$('#busproveedor').show();

		//$('#busquedageneral').val('');		

		//$('#btnbusqueda').attr('onclick',"CRUDPROVEEDORES('LISTAPROVEEDORES','')");

		$('#busproveedor').attr('onchange',"CRUDPROVEEDORES('LISTAPROVEEDORES','')");

		$('#busproducto').selectpicker('refresh');

		setTimeout(CRUDPROVEEDORES('FILTROS',''),100);		//setTimeout(CRUDPEDIDOS('LISTADIRECCIONES',''),100)		

	}

	else if(mod=="Pqr")

	{	

		//$('#divbusquedageneral').hide();	

		setTimeout(CRUDPQR('VERPQR',''),100);		//setTimeout(CRUDPEDIDOS('LISTADIRECCIONES',''),100)		

	}





}



function INICIARSESIONNUEVO(email,pass)

{	

	var datos = new FormData();	

	datos.append("loginmail", email);

	datos.append("loginpass", pass);

		

	$.ajax({

    url: "data/validarUsuariospg.php",

    type: "POST",

    data: datos,     

    async:false,       

    contentType: false,

    cache: false,

    processData:false,

    dataType:"json",

    crossDomain : true,

    }).                               

    done( function(data)

    {

    	console.log(data);

    	var res = data.res;

    	var msn = data.msn;

    	var url = data.url;

    	console.log("res=" + res);

        if(jQuery.trim(res)=="error")

        {

           

            jQuery('#btnlogin').button('reset');                    

            error2(msn);

         	num = 1;

         	result = false;

        }                

        else if(jQuery.trim(res)=="ok")

        {

        	localStorage.removeItem('notapedido');

        	num = 1;

        	window.location.href = url; 

        	window.location.reload();

        }

    })

   .fail(function( jqXHR, textStatus, errorThrown ) {

	     if ( console && console.log ) {

	         console.log( "La solicitud a fallado: " +  textStatus);

             result = true;

	     }

	});

       		



}

function INICIARSESION()

{

	//var formData  = new FormData(jQuery("#formlogin"));

	var codcat = grecaptcha.getResponse();

	console.log("codigo captcha" + codcat);

	 var num = 0;



	var datos = new FormData();	

	datos.append("loginmail", $('#loginmail').val());

	datos.append("loginpass", $('#loginpass').val());

	datos.append('g-recaptcha-response',codcat);



	 $("#formlogin").on('submit',(function(e)

    {	

		e.preventDefault();

		if(num==0)

		{

				$.ajax({

	            url: "data/validarUsuariospg.php",

	            type: "POST",

	            data: datos,     

	            async:false,       

	            contentType: false,

	            cache: false,

	            processData:false,

	            dataType:"json",

	            crossDomain : true,

	            }).                               

	            done( function(data)

	            {

	            	console.log(data);

	            	var res = data.res;

	            	var msn = data.msn;

	            	var url = data.url;

	            	console.log("res=" + res);

	                if(jQuery.trim(res)=="error")

	                {

	                    grecaptcha.reset();

	                    jQuery('#btnlogin').button('reset');                    

	                    error2(msn);

	                 	num = 1;

	                 	result = false;

	                }                

	                else if(jQuery.trim(res)=="ok")

	                {

	                	num = 1;

	                	localStorage.removeItem('notapedido');

	                	window.location.href = url; 

	                	window.location.reload();

	                }

	            })

	           .fail(function( jqXHR, textStatus, errorThrown ) {

				     if ( console && console.log ) {

				         console.log( "La solicitud a fallado: " +  textStatus);

	                     result = true;

				     }

				});

       		}



       }));

}

function CRUDCUENTA(o,id)

{

	if(o=="NUEVO")

	{



	}

	else if(o=="NUEVODOMICILIARIO")

	{

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},function(data){

			$('#acount').html(data);

		})

	}

	else if(o=="AJUSTECUENTA")

	{

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},function(data){

			$('#acount').html(data);

		})

	}

	else if(o=="GUARDARAJUSTE")

	{

		$('#formcuenta').validator();

    	var nom = $('#txtnombre').val();

    	var ape = $('#txtapellido').val();

    	var tel = $('#txttelefono').val();

    	var fec = $('#txtfecha').val();

    	var pass1 = $('#txtpass1').val();

		var pais = $('#selpais').val();

		var ciu = $('#txtciudad').val();

		var dir = $('#txtdireccion').val();

		var urlFacebook = $('#txtfacebook').val();
		var urlInstagram = $('#txtinstagram').val();
		var urlYoutube = $('#txtyoutube').val();

		var corr = $('#txtcorreo').val();

    	var gen = $('input:radio[name="radgenero"]:checked').val();

    	var rut = $('#rutaimagen').text();

		var color = $('#favcolor').val();

		var rutced = $('#rutacedula').text();

		var rutser = $('#rutaservicios').text();



    	if(nom=="")

    	{

    		error("Debes ingresar tu nombre");

    	}

    	else if(pass1=="")

    	{

    		error("Debes ingresar la contraseña de verificacion");

    	}

    	else if(pass1!="" && pass1.length<4)

		{

			error('La contraseña debe ser igual o mayor a 4 digitos . Verificar');

		}

    	else

    	{

    		$.post('funciones/usuarios/fnUsuarios.php', {opcion:o,nom:nom,ape:ape,tel:tel,fec:fec,pass1:pass1,pais:pais,ciu:ciu,dir:dir,corr:corr,color:color,rut:rut,rutced:rutced,rutser:rutser,id:id,gen:gen, url_youtube: urlYoutube,url_facebook:urlFacebook,url_instagram:urlInstagram}, function(data, textStatus, xhr) {

    			/*optional stuff to do after success */

    			var res = data[0].res;

    			var msn = data[0].msn;

    			if(res=="ok")

    			{

    				ok(msn);

    				setTimeout(CRUDUSUARIOS('AJUSTECUENTA',''),1000);

    			}

    			else

    			{

    				error(msn);

    			}



    		},"json");

    	}

	}



}



'use strict';



function RECUPERARCONTRASENA()

{





	//var formData  = new FormData(jQuery("#formrecuperar"));

	var datos = new FormData();

	var email = $('#txtrecuperar').val();

	datos.append("opcion", 'RECUPERARCONTRASENA');

	datos.append("email", email);

	var num = 0;



	$("#formrecuperar").on('submit',(function(e)

    {	

		e.preventDefault();

		if(num==0)

		{

			jQuery.ajax({

	        url: "funciones/usuarios/fnUsuarios.php",

	        type: "POST",

	       	data: datos,     

	        async:false,       

	        contentType: false,

	        cache: false,

	        processData:false,

	        dataType:"json",

	        crossDomain : true,

	        }).                               

	        done( function(data)

	        {

	        	var res = data[0].res;

				var msn  =data[0].msn;

				if(res=="ok")

				{

					ok2(msn);

					setTimeout(function(){

						CRUDUSUARIOS('LOGIN','','');

					},100);

				}

				else

				{

					error2(msn);

				}             

	        })

	       .fail(function( jqXHR, textStatus, errorThrown ) {

			     if ( console && console.log ) {

			         console.log( "La solicitud a fallado: " +  textStatus);

	                 result = true;

			     }

			});

		}

	}));

}



/*async function RECUPERARCONTRASENA()

{

	const {value: email} = await swal({

  	title: 'Ingresa tu correo electrónico para recuperar tu cuenta',

  	input: 'email',

  	inputPlaceholder: 'Correo electrónico',

  	confirmButtonText:"Recuperar contraseña",

  		inputValidator: (value) => {

    	return !value && 'Correo electrónico invalido';

  		}

	})



	if (email) 

	{	

		$.post("funciones/usuarios/fnUsuarios.php",{opcion:"RECUPERARCONTRASENA",email:email},

		function(data){

			var res = data[0].res;

			var msn  =data[0].msn;

			if(res=="ok")

			{

				ok2(msn);

			}

			else

			{

				error2(msn);

			}

		},"json");  		

	}

}

*/

function RESTABLECER(cod)

{

	var con1 = $("#contrasena1").val();

	var con2 = $("#contrasena2").val();

	if(con1=="")

	{

		error("Ingresar la nueva contraseña");

	}

	else if(con2=="")

	{

		error("Ingresar la contraseña de verificacion");

	}

	else if(con1!=con2)

	{

		error("Las contraseñas no coinciden");

	}

	else

	{

		$.post('funciones/usuarios/fnUsuarios.php', {opcion: 'RESTABLECER',con1:con1,con2:con2,cod:cod}, function(data, textStatus, xhr) {

			var res = data[0].res;

			var msn = data[0].msn;



			if(res=="ok")

			{

				swal({

				title: msn,

				type: 'info',

				html:'<a href="index.php">Iniciar sesión</a>',

				showCloseButton: true,

				showCancelButton: false,

				focusConfirm: false,

				confirmButtonText:

				'<i class="fa fa-thumbs-up"></i> Ok!',				

				})

			}

			else

			{

				error(msn);

			}

			/*optional stuff to do after success */

		},"json");

	}



	

	

}



function CRUDPQR(o,id)

{

	if(o=="VERPQR")

	{

		$('#tabladatos').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/pqr/fnPqr.php',{opcion:o},

		function(data)

		{		

			$('#tabladatos').html(data);

		});

	}

	else if(o=="MOSTRARPQR")

	{

		$('#divcontenidopqr').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/pqr/fnPqr.php',{opcion:o},

		function(data)

		{		

			$('#divcontenidopqr').html(data);

		});

	}

	else if(o=="GUARDARPREGUNTA")

	{

		var datos = new FormData();

		datos.append("opcion", o);		

		datos.append("txtpqr", $('#txtpqr').val());		

		var num = 0;



	 	$("#forpregunta").on('submit',(function(e)

    	{	

			e.preventDefault();

			if(num==0)

			{

				$.ajax({

	            url: "funciones/pqr/fnPqr.php",

	            type: "POST",

	            data: datos,     

	            async:false,       

	            contentType: false,

	            cache: false,

	            processData:false,

	            dataType:"json",

	            crossDomain : true,

	            }).                               

	            done( function(data)

	            {

	            	console.log(data);

	            	var res = data.res;

	            	var msn = data.msn;

	            	

	                if(jQuery.trim(res)=="error")

	                {

	                   

	                    jQuery('#btnenviarpregunta').button('reset');                    

	                    error2(msn);

	                 	num = 1;

	                 	result = false;

	                }                

	                else if(jQuery.trim(res)=="ok")

	                {

	                	num = 1;

	                	$('#txtpqr').val('');

	                	jQuery('#btnenviarpregunta').button('reset');  

	                	ok(msn);   

	                	setTimeout(CRUDPQR('MOSTRARPQR',''),1000);

	                }

	            })

	           .fail(function( jqXHR, textStatus, errorThrown ) {

				     if ( console && console.log ) {

				         console.log( "La solicitud a fallado: " +  textStatus);

	                     result = true;

				     }

				});

       		}



       }));

	}

}

function CRUDUSUARIOS(o,id,ti)

{

	if(ti=="" || ti==null){ti=$('#tipo').val();}else{ti=ti; $('#tipo').val(ti);}

	var url = String(window.location); //window.location; 

	var indv2 = url.indexOf('localhost');

	if(o=="RECUPERAR")

   {



		$('#titlelogin').html("Recuperacion Contraseña en locomproaqui.com");

		$('#divlogin').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

        {

			$('#divlogin').html(data);

		});		

   }

   else	

   if(o=="LOGIN")

   {



		$('#titlelogin').html("Iniciar Sesión en locomproaqui.com");

		$('#divlogin').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

        {

			$('#divlogin').html(data);

		});		

   }

   else

   if(o=="REGISTRONUEVO")

   {

		$('#titlelogin').html("Registrate y gana un 7% de tus ventas");

		$('#divlogin').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

        {

			$('#divlogin').html(data);

			//$('#selcategoria1').selectpicker('refresh');

			$('#selpais').selectpicker({

				liveSearch: true,

				hideDisabled: true



			})

		});

   }

   else

   if(o=="NUEVO")

   {

		$('#btnguardar').attr('onclick',"CRUDUSUARIOS('GUARDAR','','')");

		$('#titlemodal').html("Registro Nuevo Usuario");

		$('#contenidomodal').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

        {

			$('#contenidomodal').html(data);

		});		

   }   

   else if(o=="EDITAR")

   {

		$('#btnguardar').attr('onclick',"CRUDUSUARIOS('GUARDAREDICION','"+id+"','')").show();

		$('#titlemodal').html("Editar Usuario");

		$('#contenidomodal').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o,id:id},

		function(data)

		{

			$('#contenidomodal').html(data);

		})

   }

   else if(o=="CONFIRMAR")

   {

		$('#btnguardar').attr('onclick',"CRUDUSUARIOS('GUARDARCONFIRMAR','"+id+"','')").html("Confirmar domiciliario");

		$('#titlemodal').html("Confirmar Usuario");

		$('#contenidomodal').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:"EDITAR",id:id},

		function(data)

		{

			$('#contenidomodal').html(data);

		})

   }

   else if(o=="VALIDARPERFIL")

   {

   		var selperfil = $('#selperfil').val();

   		if(selperfil==3)

   		{

   			$('#divmercado').show();

   			$('#divsectores').addClass('hide');

   			$('#selmercado>option[value=""]').attr("selected","selected");

   			$('#selmercado').selectpicker('refresh');

   		}

   		else if(selperfil==2)

   		{

   			$('#divmercado').hide();

   			$('#divsectores').removeClass('hide');

   			$('#selmercado>option[value=""]').attr("selected","selected");

   			$('#selmercado').selectpicker('refresh');

   		}	

   		else

   		{

   			$('#divmercado').hide();

   			$('#divsectores').addClass('hide');

   			$('#selmercado>option[value=""]').attr("selected","selected");

   			$('#selmercado').selectpicker('refresh');

   		}

   }

   else if(o=="GUARDAR")

   {	  

        var txtnombre = $('#txtnombre').val();

        var txtapellido = $('#txtapellido').val();

		var txtusuario = $('#txtusuario').val();

		var lu = txtusuario.length;

		var txtpass = $('#txtpass').val();

		var lc = txtpass.length;

		var txtpass1 = $('#txtpass1').val();

		var selperfil = $('#selperfil').val();

		var txtemail = $('#txtemail').val();

		var color = $('#favcolor').val();

		var ckactivo = $('input:checkbox[name=ckactivo]:checked').val();

		var ruta = $('#rutausuario').text();

		var mer = $('#selmercado').val();

		var sec = $('#selsectores').val();

		var tel = $('#txttelefono').val();

		var doc = $('#txtdocumento').val();



		//infovehiculo

		var placa = $('#txtplaca').val();

		var marca = $('#txtmarca').val();

		var linea = $('#txtlinea').val();

		var modelo = $('#txtmodelo').val();

		var cilindrada = $('#txtcilindrada').val();

		var colvehiculo = $('#txtcolor').val();

		var soat = $('#txtsoat').val();

		var soatcom = $('#txtsoatcompany').val();

		var soatven = $('#txtsoatvencimiento').val();

		var tecno = $('#txttecno').val();

		var tecnocom = $('#txttecnocompany').val();

		var tecnoven = $('#txttecnovencimiento').val();

		

		if(txtnombre=="" || txtnombre==null)

		{

			error('Diligenciar el nombre completo del usuario. Verificar');

		}

		/*else if(txtusuario=="" || txtusuario ==null)

		{

			error('Diligenciar el usuario. Verificar');

		} */

		else if(selperfil==2 && (doc=="" || doc==null || doc==undefined))

		{

			error("Diligenciar el numero de documento");

		}

		else if(selperfil==2 && (tel=="" || tel==null || tel==undefined))

		{

			error("Diligenciar el numero de telefono");

		}

		/*else if(lu<4)

		{

			error('El usuario debe ser igual o mayor a 4 digitos. Verificar');

     	}*/

		else if(txtpass== "" || txtpass==null)

		{

			error('Diligenciar la contraseña. Verificar');

		}

		else if(lc<4)

		{

			error('La contraseña debe ser igual o mayor a 4 digitos . Verificar');

		}

		else if(txtpass1=="" || txtpass1==null)

		{

			error('Diligenciar la contraseña de verificacion. Verificar');

		}

		else if(txtpass!=txtpass1)

		{

			error('Las contraseñas no coinciden. Verificar');

		}

		else if(selperfil=="" || selperfil==null)

		{

			error('Seleccionar el perfil. Verificar');

		}

		/*else if(selperfil==3 && (mer<=0 || mer==""))

		{

			error('Seleccionar el mercado al que pertenece el cliente. Verificar');

		}*/

		else if(txtemail=="" ||  txtemail==null)

		{

			error('Diligenciar el correo electrónico. Verificar<');

		}

		else if(txtemail.indexOf('@', 0) == -1 || txtemail.indexOf('.', 0) == -1) 

		{

			error('Formato de correo electrónico no valido.Verificar<br>Ejemplo:example@mail.com. ');

		}

		else if(selperfil==2 && (sec=="" || sec==null || sec==undefined))

		{

			error("Seleccionar uno o varios sectores para los que desee aplicar");

		}



		else if(selperfil==2 && (placa=="" || placa==null || placa==undefined))

		{

			error("Diligenciar el numero de placa del vehiculo");

		}

		else if(selperfil==2 && (marca=="" || marca==null || marca==undefined))

		{

			error("Diligenciar la marcar del vehiculo");

		}

		else if(selperfil==2 && (linea=="" || linea==null || linea==undefined))

		{

			error("Diligenciar la linea del vehiculo");

		}

		else if(selperfil==2 && (modelo=="" || modelo==null || modelo==undefined))

		{

			error("Diligenciar el modelo del vehiculo");

		}

		else if(selperfil==2 && (cilindrada=="" || cilindrada==null || cilindrada==undefined))

		{

			error("Diligenciar el cilindraje del vehiculo");

		}

		else if(selperfil==2 && (colvehiculo=="" || colvehiculo==null || colvehiculo==undefined))

		{

			error("Diligenciar el color del vehiculo");

		}

		else if(selperfil==2 && (soat=="" || soat==null || soat==undefined))

		{

			error("Diligenciar el numero del soat");

		}

		else if(selperfil==2 && (soatcom=="" || soatcom==null || soatcom==undefined))

		{

			error("Diligenciar la compañia del soat");

		}

		else if(selperfil==2 && (soatven=="" || soatven==null || soatven==undefined))

		{

			error("Seleccionar la fecha de vencimiento del soat");

		}

		else if(selperfil==2 && (tecno=="" || tecno==null || tecno==undefined))

		{

			error("Diligenciar el numero de la tecnicomecanica");

		}

		else if(selperfil==2 && (tecnocom=="" || tecnocom==null || tecnocom==undefined))

		{

			error("Diligenciar la compañia de la tecnicomecanica");

		}

		else if(selperfil==2 && (tecnoven=="" || tecnoven==null || tecnoven==undefined))

		{

			error("Seleccionar la fecha de vencimiento de la tecnicomecanica");

		}

		else

		{

		   $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,nombre:txtnombre,usuario:txtusuario,pass:txtpass,perfil:selperfil,email:txtemail,activo:ckactivo,ruta:ruta,color:color,mer:mer,apellido:txtapellido,sec:sec,doc:doc,tel:tel,placa:placa,marca:marca,linea:linea,modelo:modelo,cilindrada:cilindrada,colvehiculo:colvehiculo,soat:soat,soatcom:soatcom,soatven:soatven,tecno:tecno,tecnocom:tecnocom,tecnoven:tecnoven},

		   function(data)

		   {

			   var res = $.trim( data[0].res );

				if(res=="error1")

				{

					error('El usuario ingresado ya existe. Verificar');		

				}

				else if(res=="error2")

				{

					error('El e-mail ingresado ya existe. Verificar');

				}

				else if(res=="error3")

				{

					error('Surgió un error al guardar el usuario. Verificar');

				}

				else if(res=="error4")

				{

					error('No se copio la imagen. Verificar');

				}

				else if(res=="ok")

				{

					ok('Usuario registrado correctamente');

					$('#contenidomodal').modal('hide');

					if(data[0].imagen!="")

					{

					//$('#imgperfil').attr('src',data[0].imagen);

					//$('#imgperfil1').attr('src',data[0].imagen);

					}

					setTimeout(CRUDUSUARIOS('LISTAUSUARIOS','',''),1000);

					setTimeout(CRUDUSUARIOS('TODOS','',''),1000);

				}

		   },"json");		   

		}

   }



   else  if(o=="GUARDAREDICION")

   {

        var txtnombre = $('#txtnombre').val();

        var txtapellido = $('#txtapellido').val();

		var txtusuario = $('#txtusuario').val();

		var lu = txtusuario.length;

		var txtpass = $('#txtpass').val();

		var lc = txtpass.length

		var txtpass1 = $('#txtpass1').val();

		var selperfil = $('#selperfil').val();

		var txtemail = $('#txtemail').val();

		var ckactivo = $('input:checkbox[name=ckactivo]:checked').val();

		var color = $('#favcolor').val();

		var ruta = $('#rutausuario').text();

		var mer = $('#selmercado').val();

		var sec = $('#selsectores').val();

		var doc = $('#txtdocumento').val();

		var tel = $('#txttelefono').val();



		//infovehiculo

		var placa = $('#txtplaca').val();

		var marca = $('#txtmarca').val();

		var linea = $('#txtlinea').val();

		var modelo = $('#txtmodelo').val();

		var cilindrada = $('#txtcilindrada').val();

		var colvehiculo = $('#txtcolor').val();

		var soat = $('#txtsoat').val();

		var soatcom = $('#txtsoatcompany').val();

		var soatven = $('#txtsoatvencimiento').val();

		var tecno = $('#txttecno').val();

		var tecnocom = $('#txttecnocompany').val();

		var tecnoven = $('#txttecnovencimiento').val();

		

		if(txtnombre=="" || txtnombre==null)

		{

			error('Diligenciar el nombre completo del usuario. Verificar');

		}

		/*else if(txtusuario=="" || txtusuario ==null)

		{

			error('Diligenciar el usuario. Verificar');



		} 

		else if(lu<4)

		{

			error('El usuario debe ser igual o mayor a 4 digitos. Verificar');

     	}*/

     	else if(selperfil==2 && (doc=="" || doc==null))

		{

			error("Diligenciar el número de documento del domiciliario.");

		}

		else if(selperfil==2 && (tel=="" || tel==null))

		{

			error("Diligenciar el número de telefono.");

		}

		else if(txtpass== "" || txtpass==null)

		{

			error('>Diligenciar la contraseña. Verificar');

		}

		else if(lc<4)

		{

			error('La contraseña debe ser igual o mayor a 4 digitos . Verificar');

		}

		else if(txtpass1=="" || txtpass1==null)

		{

			error('Diligenciar la contraseña de verificacion. Verificar');

		}

		else if(txtpass!=txtpass1)

		{

		   error('Las contraseñas no coinciden. Verificar');

		}

		else if(selperfil=="" || selperfil==null)

		{

			error('Seleccionar el perfil. Verificar');

		}

		/*else if(selperfil==3 && (mer<=0 || mer=="") )

		{

			error('Seleccionar el mercado al que pertenece el cliente. Verificar');

		}*/

		else if(txtemail=="" ||  txtemail==null)

		{

			error('Diligenciar el correo electrónico. Verificar');

		}

		else if(txtemail.indexOf('@', 0) == -1 || txtemail.indexOf('.', 0) == -1) 

		{

			error('Formato de correo electrónico no valido. Ejemplo:example@mail.com. Verificar');

		}

		else if(selperfil==2 && (sec=="" || sec==null || sec==undefined))

		{

			error("Seleccionar uno o varios sectores para los que desee aplicar");

		}

		else if(selperfil==2 && (placa=="" || placa==null || placa==undefined))

		{

			error("Diligenciar el numero de placa del vehiculo");

		}

		else if(selperfil==2 && (marca=="" || marca==null || marca==undefined))

		{

			error("Diligenciar la marcar del vehiculo");

		}

		else if(selperfil==2 && (linea=="" || linea==null || linea==undefined))

		{

			error("Diligenciar la linea del vehiculo");

		}

		else if(selperfil==2 && (modelo=="" || modelo==null || modelo==undefined))

		{

			error("Diligenciar el modelo del vehiculo");

		}

		else if(selperfil==2 && (cilindrada=="" || cilindrada==null || cilindrada==undefined))

		{

			error("Diligenciar el cilindraje del vehiculo");

		}

		else if(selperfil==2 && (colvehiculo=="" || colvehiculo==null || colvehiculo==undefined))

		{

			error("Diligenciar el color del vehiculo");

		}

		else if(selperfil==2 && (soat=="" || soat==null || soat==undefined))

		{

			error("Diligenciar el numero del soat");

		}

		else if(selperfil==2 && (soatcom=="" || soatcom==null || soatcom==undefined))

		{

			error("Diligenciar la compañia del soat");

		}

		else if(selperfil==2 && (soatven=="" || soatven==null || soatven==undefined))

		{

			error("Seleccionar la fecha de vencimiento del soat");

		}

		else if(selperfil==2 && (tecno=="" || tecno==null || tecno==undefined))

		{

			error("Diligenciar el numero de la tecnicomecanica");

		}

		else if(selperfil==2 && (tecnocom=="" || tecnocom==null || tecnocom==undefined))

		{

			error("Diligenciar la compañia de la tecnicomecanica");

		}

		else if(selperfil==2 && (tecnoven=="" || tecnoven==null || tecnoven==undefined))

		{

			error("Seleccionar la fecha de vencimiento de la tecnicomecanica");

		}

		

		else

		{

		   $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,nombre:txtnombre,usuario:txtusuario,pass:txtpass,perfil:selperfil,email:txtemail,activo:ckactivo,edi:id,color:color,ruta:ruta,mer:mer,apellido:txtapellido,sec:sec,doc:doc,tel:tel,placa:placa,marca:marca,linea:linea,modelo:modelo,cilindrada:cilindrada,colvehiculo:colvehiculo,soat:soat,soatcom:soatcom,soatven:soatven,tecno:tecno,tecnocom:tecnocom,tecnoven:tecnoven},

		   function(data)

		   {

			   

			   var res = $.trim(data[0].res);

			   var msn = $(data[0].msn);

				

				if(res=="error")

				{

					error(msn);

				}

				else if(res=="ok")

				{

					ok('Usuario modificado correctamente');

					if(data[0].imagen!="")

					{

					//$('#imgperfil').attr('src',data[0].imagen);

					//$('#imgperfil1').attr('src',data[0].imagen);

					}

					var table = $('#tbUsuarios').DataTable();

				  	table.row('#row_'+id).draw(false);

					setTimeout(CRUDUSUARIOS('TODOS','',''),1000);	

				}

		   },"json");

		}

    }   

	else

	if(o=="GUARDARCONFIRMAR")

   {

        var txtnombre = $('#txtnombre').val();

        var txtapellido = $('#txtapellido').val();

		var txtusuario = $('#txtusuario').val();

		var lu = txtusuario.length;

		var txtpass = $('#txtpass').val();

		var lc = txtpass.length

		var txtpass1 = $('#txtpass1').val();

		var selperfil = $('#selperfil').val();

		var txtemail = $('#txtemail').val();

		var ckactivo = $('input:checkbox[name=ckactivo]:checked').val();

		var ckconfirmar  =  1;//$('input:radio[name=radconfirmar]:checked').val();

		var color = $('#favcolor').val();

		var ruta = $('#rutausuario').text();

		var mer = $('#selmercado').val();

		var sec = $('#selsectores').val();

		var doc = $('#txtdocumento').val();

		var tel = $('#txttelefono').val();

		var con = "";

		var tcon = "";

		var placa = $('#txtplaca').val();

		var marca = $('#txtmarca').val();

		var linea = $('#txtlinea').val();

		var modelo = $('#txtmodelo').val();

		var cilindrada = $('#txtcilindrada').val();

		var colvehiculo = $('#txtcolor').val();

		var soat = $('#txtsoat').val();

		var soatcom = $('#txtsoatcompany').val();

		var soatven = $('#txtsoatvencimiento').val();

		var tecno = $('#txttecno').val();

		var tecnocom = $('#txttecnocompany').val();

		var tecnoven = $('#txttecnovencimiento').val();



		if(ckconfirmar==2)

		{

			con = "Realmente desea descartar el domiciliario seleccionado?";

			tcon = "descartar";

		}

		else if(ckconfirmar==1)

		{

			con = "Realmente desea activar el domiciliario seleccionado?";

			tcon = "Activar";

		}

		if(ckconfirmar=="" || ckconfirmar==null || ckconfirmar==undefined)

		{

			error("Seleccionar si desea activar o descartar el domiciliario seleccionado");

		}

		else if((txtnombre=="" || txtnombre==null) && ckconfirmar==1)

		{

			error('Diligenciar el nombre completo del usuario. Verificar');

		}

		/*else if((txtusuario=="" || txtusuario ==null) && ckconfirmar==1)

		{

			error('Diligenciar el usuario. Verificar');



		} 

		else if(lu<4 && ckconfirmar==1)

		{

			error('El usuario debe ser igual o mayor a 4 digitos. Verificar');

     	}	*/		     	

		else if((txtpass== "" || txtpass==null) && ckconfirmar==1)

		{

			error('Diligenciar la contraseña. Verificar');

		}

		else if(lc<4 && ckconfirmar==1)

		{

			error('La contraseña debe ser igual o mayor a 4 digitos . Verificar');

		}

		else if((txtpass1=="" || txtpass1==null) && ckconfirmar==1)

		{

			error('Diligenciar la contraseña de verificacion. Verificar');

		}

		else if(txtpass!=txtpass1 && ckconfirmar==1)

		{

		   error('Las contraseñas no coinciden. Verificar');

		}							

		else if((txtemail=="" ||  txtemail==null) && ckconfirmar==1)

		{

			error('Diligenciar el correo electrónico. Verificar');

		}

		else if((txtemail.indexOf('@', 0) == -1 || txtemail.indexOf('.', 0) == -1) && ckconfirmar==1) 

		{

			error('Formato de correo electrónico no valido. Ejemplo:example@mail.com. Verificar');

		}

		else if(selperfil==2 && (sec=="" || sec==null || sec==undefined) && ckconfirmar==1)

		{

			error("Seleccionar uno o varios sectores para los que desee aplicar");

		}

		else if(selperfil==2 && (doc=="" || doc==null || doc==undefined) && ckconfirmar==1)

		{

			error("Diligenciar el número de documento del domiciliario.");

		}

		else if(selperfil==2 && (tel=="" || tel==null) && ckconfirmar==1)

		{

			error("Diligenciar el número de documento del domiciliario.");

		}

		else if(selperfil==2 && (placa=="" || placa==null || placa==undefined) && ckconfirmar==1)

		{

			error("Diligenciar el numero de placa del vehiculo");

		}

		else if(selperfil==2 && (marca=="" || marca==null || marca==undefined) && ckconfirmar==1)

		{

			error("Diligenciar la marcar del vehiculo");

		}

		else if(selperfil==2 && (linea=="" || linea==null || linea==undefined) && ckconfirmar==1)

		{

			error("Diligenciar la linea del vehiculo");

		}

		else if(selperfil==2 && (modelo=="" || modelo==null || modelo==undefined) && ckconfirmar==1)

		{

			error("Diligenciar el modelo del vehiculo");

		}

		else if(selperfil==2 && (cilindrada=="" || cilindrada==null || cilindrada==undefined) && ckconfirmar==1)

		{

			error("Diligenciar el cilindraje del vehiculo");

		}

		else if(selperfil==2 && (colvehiculo=="" || colvehiculo==null || colvehiculo==undefined) && ckconfirmar==1)

		{

			error("Diligenciar el color del vehiculo");

		}

		else if(selperfil==2 && (soat=="" || soat==null || soat==undefined) && ckconfirmar==1)

		{

			error("Diligenciar el numero del soat");

		}

		else if(selperfil==2 && (soatcom=="" || soatcom==null || soatcom==undefined) && ckconfirmar==1)

		{

			error("Diligenciar la compañia del soat");

		}

		else if(selperfil==2 && (soatven=="" || soatven==null || soatven==undefined) && ckconfirmar==1)

		{

			error("Seleccionar la fecha de vencimiento del soat");

		}

		else if(selperfil==2 && (tecno=="" || tecno==null || tecno==undefined) && ckconfirmar==1)

		{

			error("Diligenciar el numero de la tecnicomecanica");

		}

		else if(selperfil==2 && (tecnocom=="" || tecnocom==null || tecnocom==undefined) && ckconfirmar==1)

		{

			error("Diligenciar la compañia de la tecnicomecanica");

		}

		else if(selperfil==2 && (tecnoven=="" || tecnoven==null || tecnoven==undefined) && ckconfirmar==1)

		{

			error("Seleccionar la fecha de vencimiento de la tecnicomecanica");

		}

		else

		{

			swal({

				title: con,

				text: "",

				type: 'warning',

				showCancelButton: true,

				confirmButtonColor: '#3085d6',

				cancelButtonColor: '#d33',

				confirmButtonText: 'Si, ' + tcon + '!',

				cancelButtonText: 'No, ' + tcon + '!'

			}).then(function (result) {

				if (result.value) {

					$.post('funciones/usuarios/fnUsuarios.php', { opcion: o, nombre: txtnombre, usuario: txtusuario, pass: txtpass, perfil: selperfil, email: txtemail, activo: ckactivo, edi: id, color: color, ruta: ruta, mer: mer, apellido: txtapellido, sec: sec, doc: doc, confi: ckconfirmar, tel: tel, placa: placa, marca: marca, linea: linea, modelo: modelo, cilindrada: cilindrada, colvehiculo: colvehiculo, soat: soat, soatcom: soatcom, soatven: soatven, tecno: tecno, tecnocom: tecnocom, tecnoven: tecnoven }, function (data) {



						var res = $.trim(data[0].res);

						var msn = data[0].msn;

						if (res == "error") {

							error(msn);

						} else if (res == "ok") {

							ok(msn);

							var table = $('#tbUsuariosConfirmar').DataTable();

							table.row('#row_' + id).draw(false);

							setTimeout(CRUDUSUARIOS('TODOS', '', ''), 1000);

						}

					}, "json");

				}

			});	

		   

		}

				

		

    }   

    else if(o=="DESCARTAR")

    {

    	swal({

				title: "Realmente desea descartar el domiciliario seleccionado",

				text: "",

				type: 'warning',

				showCancelButton: true,

				confirmButtonColor: '#3085d6',

				cancelButtonColor: '#d33',

				confirmButtonText: 'Si, descartar!',

				cancelButtonText: 'No descartar!'

			}).then(function (result) {

				if (result.value) {

					$.post('funciones/usuarios/fnUsuarios.php', { opcion: o,edi: id }, function (data) {



						var res = $.trim(data[0].res);

						var msn = data[0].msn;

						if (res == "error") {

							error(msn);

						} else if (res == "ok") {

							ok(msn);

							var table = $('#tbUsuariosConfirmar').DataTable();

							table.row('#row_' + id).remove().draw(false);

							setTimeout(CRUDUSUARIOS('TODOS', '', ''), 1000);

						}

					}, "json");

				}

			});	

    }

	else if(o=="LISTAUSUARIOS" || o=="LISTACONFIRMAR")

	{

		$('#tabladatos').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

		{		

			$('#tabladatos').html(data);

		});

	}

	else if(o=="FILTROS")

	{

		$('#titleleft').html('Filtros Usuario')

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},function(data){

			$('#contenidomodalleft').html(data);

		})

	}

	else  if(o=="ACTIVAR")

    {		

		 $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,id:id},

		 function(data)

		 {

			 data = $.trim(data)

			 if(data==1)

			 {

				 var table = $('#tbUsuarios').DataTable();

				 table.row('#row_'+edi).draw(false);

			 }

			 else

			 {

				error('Ocurrio un Error al activar Usuario N '+id+'Verificar');

			 }

		 });

		

    }

	else if(o=="INACTIVAR")

    {

		

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o,id:id,indv2:indv2},

		function(data)

		{

			data = $.trim(data)

			if(data==1)

			{

			}

			else

			{

				error('Ocurrio un Error al inactivar usuario N '+id+'. Verificar');

			}

		});

		

    }

	else if(o=="ELIMINAR")

    {

    	swal({

				title: "Realmente desea eliminar el usuario seleccionado",

				text: "",

				type: 'warning',

				showCancelButton: true,

				confirmButtonColor: '#3085d6',

				cancelButtonColor: '#d33',

				confirmButtonText: 'Si, eliminar!',

				cancelButtonText: 'No eliminar!'

			}).then(function (result) {

				if (result.value) {

		

				 $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,id:id},

				 function(data)

				 {

					 var res = data[0].res;

					 var msn = data[0].msn;

					 if(res=="ok")

					 { 

					 	ok(msn);

						var table = $('#tbUsuarios').DataTable();

						table.row('#row_'+id).remove().draw(false);	

						setTimeout(CRUDUSUARIOS('TODOS','',''),1);

				     }

					 else

					 {

						 error(msn);

					 }

				 },"json");

			}

		});

				

    }

	else if(o=="TODOS")

	{	  

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

		{

			$('#divlistaestados').html(data);

		  

		});

	}

	else if(o=="CAMBIOCONTRASENA")

	{

        var txtusuario = $('#nusuario').val();

        var lu = txtusuario.length;

        var ruta = $('#ruta').text();

		var txtpass = $('#nueva').val();

		var txtpass1 = $('#confirmar').val();

		var ant = $('#anterior').val();

		var lc = txtpass.length;

		var vc = $('#vericaptcha').val();

        var txtemail = $('#nemail').val();

		

        if(txtusuario=="" || txtusuario ==null)

        {

            error('Diligenciar el usuario. Verificar');

        }

        else if(lu<4)

        {

            error('El usuario debe ser igual o mayor a 4 digitos. Verificar');

        }else

        if(txtemail=="" ||  txtemail==null)

        {

            error('Diligenciar el correo electrónico. Verificar<');

        }

        else if(txtemail.indexOf('@', 0) == -1 || txtemail.indexOf('.', 0) == -1)

        {

            error('Formato de correo electrónico no valido.Verificar<br>Ejemplo:example@mail.com. ');

        }

		if(ant=="" || ant == null)

		{

			error('Diligenciar la contraseña anterior. Verificar');

		}

		else if(txtpass== "" || txtpass==null)

		{

			error('Diligenciar la nueva contraseña. Verificar');

		}

		else if(lc<4)

		{

			error('La contraseña debe ser igual o mayor a 4 digitos . Verificar');

		}

		else if(txtpass1=="" || txtpass1==null)

		{

			error('Diligenciar la contraseña de verificación. Verificar<');

		}

		else

	    if(txtpass!=txtpass1)

		{

			error('Las contraseñas no coinciden. Verificar');

		}

		else

		if(vc=="" || vc == null)

		{

			error('Diligenciar la palabra que se halla en la imagen. Verificar');

		}

		else 

		{

		   $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,ant:ant,nue:txtpass,conf:txtpass1,captcha:vc,indv2:indv2,ruta:ruta,usuario:txtusuario,email:txtemail},

		   function(data)

		   {

			 var res  = $.trim(data[0].res);

			    if(res==1)

				{

					$('#nueva').val('');

					$('#confirmar').val('');

					$('#anterior').val('');

					$('#vericaptcha').val('');

                    if(data[0].imagen!="")

                    {

                        $('#imgperfil').attr('src',data[0].imagen);

                        $('#imgperfil1').attr('src',data[0].imagen);

                    }

					ok(data[0].msn);

					setTimeout(CRUDUSUARIOS('REFRESCARCAPTCHA','',''),1000);

				}

				else if(res==2)

				{

					error(data[0].msn);

				};

		   },"json");

		}

	}

	else if(o=="REFRESCARCAPTCHA")

	{

		$('#captcha').attr('src','dist/img/cargando.gif');

		$('#captcha').attr('src','modulos/cambiarcontrasena/captcha.php');

	}

	else if(o=="VERICAPTCHA")

	{

	    var vc = $('#vericaptcha').val()

		if(vc=="" || vc==null)

		{

		   $('#msn').html('');

		}

		else

		{

		  $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,captcha:vc},

		  function(data)

		  {

		     var res = $.trim(data[0].res);

			  if(res==1)

			  {

				

			  }

			  else

			  {

				  //error('Los caracteres de verificacion no coinciden con los de la imagen');

			  }

		  },"json");

		}		

	}

	else

	if(o=="PERMISOS")

    {	  

		$('#btnguardar').attr('name','GUARDARPERMISO');

		$('#btnguardar').css('display','none');

		$('#titlemodal').html("Asignacion de Permisos");

		$('.modal-dialog').addClass('modal-lg');

		$('#contenido').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o,id:id},

		function(data)

        {

			$('#contenido').html(data);

		});			

    }

    else if(o=="NUEVOREGISTRO")

   {	  

        var txtnombre = $('#txtnombrenue').val();

        var txtapellido = $('#txtapellidonue').val();		

		var txtpass = $('#txtpassnue').val();

		var txttelefono = $('#txttelefononue').val();

	    var selpais = $('#selpais').val();

	    var txtciudad = $('#txtciudad').val();

	    var txtdireccion = $('#txtdireccion').val();

		var lc = txtpass.length;

		var txtpass1 = $('#txtpass1nue').val();		

		var txtemail = $('#txtemailnue').val();		

		var ckterminos = $('input:checkbox[name=ckterminos]:checked').val();

	    /*var rutced = $('#rutacedula').text();

	    var rutser = $('#rutaservicios').text();*/



		if(txtnombre=="" || txtnombre==null)

		{

			error('Diligenciar el nombre. Verificar');

			$('#txtnombrenue').focus();

		}

	    else

	    if(txtciudad=="" || txtciudad==null)

	    {

		    error('Diligenciar la ciudad. Verificar');

		    $('#txtciudad').focus();

	    }

		else

		if(txtdireccion=="" || txtdireccion==null)

		{

			error('Diligenciar la dirección. Verificar');

			$('#txtdireccion').focus();

		}

		else

		if(txttelefono=="" || txttelefono==null)

		{

			error('Diligenciar el numero de celular. Verificar');

			$('#txttelefononue').focus();

		}

		else

		if(txtemail=="" || txtemail==null)

		{

			error('Diligenciar el correo electrónico. Verificar');

			$('#txtemailnue').focus();

		}

		else if(txtemail.indexOf('@', 0) == -1 || txtemail.indexOf('.', 0) == -1)

		{

			error('Formato de correo electrónico no valido.Verificar<br>Ejemplo:example@mail.com. ');

			$('#txtemailnue').focus();

		}

		else if(txtpass== "" || txtpass==null)

		{

			error('Diligenciar la contraseña. Verificar');

			$('#txtpassnue').focus();

		}

		else if(lc<4)

		{

			error('La contraseña debe ser igual o mayor a 4 digitos . Verificar');

			$('#txtpassnue').focus();

		}

		else if(txtpass1=="" || txtpass1==null)

		{

			error('Diligenciar la contraseña de verificacion. Verificar');

			$('#txtpass1nue').focus();

		}

		else if(txtpass!=txtpass1)

		{

			error('Las contraseñas no coinciden. Verificar');

		}

		/*else if(rutced<=0 || rutced==undefined || rutced=="")

		{

			error("Debe adjuntar la imagen de su Cédula. Verificar");

		}

		else if(rutser<=0 || rutser==undefined || rutser=="")

		{

			error('Debe adjuntar la imagen de uno de sus servicios públicos. Verificar');

		}*/

		else if(ckterminos<=0 || ckterminos==undefined)

		{

			error("Debe indicar si esta de acuerdo con los terminos");

			$('input:checkbox[name=ckterminos]').focus();

		}

		else

		{

		   $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,nombre:txtnombre,apellido:txtapellido,pais:selpais,ciudad:txtciudad,direccion:txtdireccion,telefono:txttelefono,email:txtemail,terminos:ckterminos,pass:txtpass},

		   function(data)

		   {

			   var res = $.trim( data[0].res );

			   var msn = data[0].msn;

				if(res=="error")

				{

					error(msn);

				}				

				else if(res=="ok")

				{

					swal({

						title: msn,

						type: 'info',

						html:'',

						showCloseButton: true,

						showCancelButton: false,

						focusConfirm: false,

						confirmButtonText:

						'<i class="fa fa-thumbs-up"></i> Ok!',				

					})	

					.then(function (result) {

					if (result.value) {

							INICIARSESIONNUEVO(txtemail,txtpass)

						}

						else

						{

							CRUDUSUARIOS('LOGIN','','');	

						}

					});

				}

		   },"json");		   

		}

   }

   else if(o=="GUARDARDOMICILIARIO")

   {	  

   		var txtnombre = $('#txtnombre').val();

        var txtapellido = $('#txtapellido').val();		

		var txtpass = $('#txtpass1').val();

		var lc = txtpass.length

		var txtpass1 = $('#txtpass2').val();

		var sec = $('#selsectores').val();

		var doc = $('#txtdocumento').val();	

        var tel = $('#txttelefono').val(); 

		var txtemail = $('#txtcorreo').val();	

		var rutasoat = $('#rutasoat').text();	

		var rutarunt = $('#rutarunt').text();	

		var rutatecno = $('#rutatecno').text();	

		var rutacedula = $('#rutacedula').text();	

		var rutapase = $('#rutapase').text();	

		//var ckterminos = $('input:checkbox[name=ckterminos]:checked').val();

		//INFO VEHICULO

		var placa = $('#txtplaca').val();

		var marca = $('#txtmarca').val();

		var linea = $('#txtlinea').val();

		var modelo = $('#txtmodelo').val();

		var cilindrada = $('#txtcilindrada').val();

		var colvehiculo = $('#txtcolor').val();

		var soat = $('#txtsoat').val();

		var soatcom = $('#txtsoatcompany').val();

		var soatven = $('#txtsoatvencimiento').val();

		var tecno = $('#txttecno').val();

		var tecnocom = $('#txttecnocompany').val();

		var tecnoven = $('#txttecnovencimiento').val();



		if((txtnombre=="" || txtnombre==null))

		{

			error('Diligenciar el nombre. Verificar');

			$('#txtnombre').focus();

		}

		/*else if((txtusuario=="" || txtusuario ==null) && ckconfirmar==1)

		{

			error('Diligenciar el usuario. Verificar');



		} 

		else if(lu<4 && ckconfirmar==1)

		{

			error('El usuario debe ser igual o mayor a 4 digitos. Verificar');

     	}	*/

     	else if((doc=="" || doc==null || doc==undefined) )

		{

			error("Diligenciar el número de documento.");

			$('#txtdocumento').focus();

		}

		else if((txtemail=="" ||  txtemail==null) )

		{

			error('Diligenciar el correo electrónico. Verificar');

			 $('#txtcorreo').focus()

		}

		else if((txtemail.indexOf('@', 0) == -1 || txtemail.indexOf('.', 0) == -1) ) 

		{

			error('Formato de correo electrónico no valido. Ejemplo:example@mail.com. Verificar');

			 $('#txtcorreo').focus()

		}		     	

		else if((txtpass== "" || txtpass==null))

		{

			error('Diligenciar la contraseña. Verificar');

			 $('#txtpass1').focus()

		}

		else if(lc<4)

		{

			error('La contraseña debe ser igual o mayor a 4 digitos . Verificar');

			 $('#txtpass1').focus()

		}

		else if((txtpass1=="" || txtpass1==null))

		{

			error('Diligenciar la contraseña de verificacion. Verificar');

			 $('#txtpass2').focus()

		}

		else if(txtpass!=txtpass1)

		{

		   error('Las contraseñas no coinciden. Verificar');

		}							

		

		else if((sec=="" || sec==null || sec==undefined))

		{

			error("Seleccionar uno o varios sectores para los que desee aplicar");

		}

		

		else if((tel=="" || tel==null) )

		{

			error("Diligenciar el número de celular.");

		}

		else if((placa=="" || placa==null || placa==undefined) )

		{

			error("Diligenciar el numero de placa del vehiculo");

		}

		else if((marca=="" || marca==null || marca==undefined))

		{

			error("Diligenciar la marcar del vehiculo");

		}

		else if((linea=="" || linea==null || linea==undefined) )

		{

			error("Diligenciar la linea del vehiculo");

		}

		else if((modelo=="" || modelo==null || modelo==undefined))

		{

			error("Diligenciar el modelo del vehiculo");

		}

		else if((cilindrada=="" || cilindrada==null || cilindrada==undefined) )

		{

			error("Diligenciar el cilindraje del vehiculo");

		}

		else if( (colvehiculo=="" || colvehiculo==null || colvehiculo==undefined) )

		{

			error("Diligenciar el color del vehiculo");

		}

		else if((soat=="" || soat==null || soat==undefined))

		{

			error("Diligenciar el numero del soat");

		}

		else if((soatcom=="" || soatcom==null || soatcom==undefined))

		{

			error("Diligenciar la compañia del soat");

		}

		else if( (soatven=="" || soatven==null || soatven==undefined))

		{

			error("Seleccionar la fecha de vencimiento del soat");

		}

		else if((tecno=="" || tecno==null || tecno==undefined))

		{

			error("Diligenciar el numero de la tecnicomecanica");

		}

		else if((tecnocom=="" || tecnocom==null || tecnocom==undefined))

		{

			error("Diligenciar la compañia de la tecnicomecanica");

		}

		else if((tecnoven=="" || tecnoven==null || tecnoven==undefined))

		{

			error("Seleccionar la fecha de vencimiento de la tecnicomecanica");

		}

		else if(rutacedula=="" || rutacedula==null || rutacedula=="tmpcedula/")

		{

			error("Adjuntar la copia de la cedula");

		}

		else if(rutapase=="" || rutapase==null || rutapase=="tmppase/")

		{

			error("Adjuntar la copia del pase");

		}		

		else if(rutarunt=="" || rutarunt==null || rutarunt=="tmprunt/")

		{

			error("Adjuntar la copia del runt");

		}

		else if(rutasoat=="" || rutasoat==null || rutasoat=="tmpsoat/")

		{

			error("Adjuntar la copia del soat");

		}		

		else 

		{		 

		

		

		   $.post('funciones/usuarios/fnUsuarios.php',{opcion:o,nombre: txtnombre, pass: txtpass, email: txtemail,apellido: txtapellido, sec: sec, doc: doc, tel: tel, placa: placa, marca: marca, linea: linea, modelo: modelo, cilindrada: cilindrada, colvehiculo: colvehiculo, soat: soat, soatcom: soatcom, soatven: soatven, tecno: tecno, tecnocom: tecnocom, tecnoven: tecnoven,rutarunt:rutarunt,rutasoat:rutasoat,rutatecno:rutatecno,rutacedula:rutacedula,rutapase:rutapase},

		   function(data)

		   {

			   var res = $.trim( data[0].res );

			   var msn = data[0].msn;

				if(res=="error")

				{

					error(msn);

				}				

				else if(res=="ok")

				{

					CRUDCUENTA('NUEVODOMICILIARIO','');

					swal({

						title: msn,

						type: 'info',

						html:'',

						showCloseButton: true,

						showCancelButton: false,

						focusConfirm: false,

						confirmButtonText:

						'<i class="fa fa-thumbs-up"></i> Ok!',				

					})		

					

				}

		   },"json");		   

		}

   }

   else if(o=="POLITICAS")

   {

   	var ck = $('#ckterminos:checked').val();

   	console.log(ck);

   	if(ck==1)

   	{



   	}

   	else

   	{

   		$("#modalright").modal("show");

		$('#titleright').html('<i class="glyphicon glyphicon-alert text-red"></i> Terminos de Privacidad.')

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},function(data){

			$('#contenidomodalright').html(data);

		})

	}

	

   }



}



function CRUDPERFILES(o,id,idd)

{

	var url = String(window.location); //window.location; 

	var indv2 = url.indexOf('localhost');

   if(o=="NUEVO")

   {

		$('#btnguardar').attr('onclick',"CRUDPERFILES('GUARDAR','','')")

		$('#titlemodal').html("Registro Nuevo Perfil");

		$('#contenidomodal').html('');

		$.post('funciones/perfiles/fnPerfiles.php',{opcion:o},

		function(data)

        {

			$('#contenidomodal').html(data);

		});

   }

    else if(o=="EDITAR")

   {

	   $('#btnguardar').attr('onclick',"CRUDPERFILES('GUARDAREDICION','"+id+"','')")

	   $('#titlemodal').html("Editar Perfil");

	    $('#contenidomodal').html('');

	   $.post('funciones/perfiles/fnPerfiles.php',{opcion:o,id:id},

	   function(data)

	   {

		   $('#contenidomodal').html(data);

	   })

	   

   }

   else if(o=="GUARDAR")

   {

		var txtdescripcion = $('#txtdescripcion').val();

		if(txtdescripcion=="" || txtdescripcion ==null)

		{

			error('Diligenciar la descripción. Verificar');

		} 

		else

		{

		   $.post('funciones/perfiles/fnPerfiles.php',{opcion:o,descripcion:txtdescripcion},

		   function(data)

		   {

			   data = $.trim( data );

				

				 if(data=="error1")

				{

					error('La descripcion ingresada ya existe. Verificar');

				}

				else if(data=="error2")

				{

					error('Surgió un error al guardar el perfil. Verificar');

				}

				else if(data=="error3")

				{

					error('No posee permisos para crear perfiles. Verificar');

				}

				else if(data=="ok")

				{

					ok('Perfil registrado correctamente');

					setTimeout(CRUDPERFILES('CARGARLISTAPERFILES',''),1000);

				}

		   });

		   

		}

   }

   else  if(o=="GUARDAREDICION")

   {

	   	var edi = id;

		var txtdescripcion = $('#txtdescripcion').val();

		if(txtdescripcion=="" || txtdescripcion ==null)

		{

			error('Diligenciar la descripción. Verificar');

		} 		

		

		else

		{

		   $.post('funciones/perfiles/fnPerfiles.php',{opcion:o,descripcion:txtdescripcion,id:id},

		   function(data)

		   {

			     data = $.trim( data );

				if(data=="error1")

				{

					error('La descripcion ingresada ya existe. Verificar');

				}

				else if(data=="error2")

				{

					error('Surgió un error al modificar el perfil. Verificar');

				}

				else if(data=="error3")

				{

					error('No posee permisos para modificar perfiles. Verificar');

				}

				else if(data=="ok")

				{

					error('Perfil modificado correctamente');

					setTimeout(CRUDPERFILES('CARGARLISTAPERFILES',''),1000);

				}

		   });

		   

		}

   }

   else if(o=="CARGARPERMISOS")

   {

	  var ide = $('#idedicion').val();

	  $('#permisos').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div>          <div class="loader-section section-right"></div></div>');

      $.post('funciones/fnPerfiles.php',{opcion:o,id:ide},

	  function(data)

	  {

		  $('#permisos').html(data);

	   });

   }

   else if(o=="AGREGARPERMISO")

   {

	   var ide = $('#idedicion').val();

	   $.post('funciones/fnPerfiles.php',{opcion:o,idp:ide,ventana:idd},

	   function(data)

	   {

		   if(data=="ok")

		   {

			   ok('Permiso(s) agregado(s) correctamente');

		   }

		   else

	       {

			   error('Surgió un error al agregar permiso(s). Verificar');

		   }

	   });

   }

   else if(o=="AGREGARPERMISO1")

   {

	   var ide = $('#idedicion').val();

	   $.post('funciones/fnPerfiles.php',{opcion:'AGREGARPERMISO',idp:ide,ventana:idd},

	   function(data)

	   {

		   if(data=="ok")

		   {

			   ok('Permiso(s) agregado(s) correctamente');

			   setTimeout(CRUDPERFILES('CARGARPERMISOS','',''),1000);

		   }

		   else

	       {

			   error('Surgió un error al agregar permiso(s). Verifica');

		   }

	   });

   }

   else if(o=="ELIMINARPERMISO")

   {

	  

	   $.post('funciones/fnPerfiles.php',{opcion:o,id:idd},

	   function(data)

	   {

		   if(data=="ok")

		   {

			   ok('Permiso(s) eliminado(s) correctamente');

		   }

		   else

	       {

			   error('Surgió un error al eliminar permiso(s). Verificar');

		   }

	   });

   }

   else if(o=="ELIMINARPERMISO1")

   {

	   var ide = $('#idedicion').val();

	   $.post('funciones/fnPerfiles.php',{opcion:'ELIMINARPERMISO',id:idd},

	   function(data)

	   {

		   if(data=="ok")

		   {

			   ok('Permiso(s) eliminados(s) correctamente');

			   setTimeout(CRUDPERFILES('CARGARPERMISOS','',''),1000);

		   }

		   else

	       {

			   error('Surgió un error al eliminar permiso(s). Verificar');

		   }

	   });

   }

    else if(o=="AGREGARTODOS")

   {

	   var ide = $('#idedicion').val();

	   $.post('funciones/fnPerfiles.php',{opcion:o,id:ide},

	   function(data)

	   {

		   if(data=="ok")

		   {

			   ok('Permiso(s) agregado(s) correctamente');

			   setTimeout(CRUDPERFILES('CARGARPERMISOS','',''),1000);

		   }

		   else

	       {

			   error('Surgió un error al agregar permiso(s). Verificar');

		   }

	   });

   }

   else if(o=="ELIMINARTODOS")

   {

	   var ide = $('#idedicion').val();

	   $.post('funciones/fnPerfiles.php',{opcion:o,id:ide},

	   function(data)

	   {

		   if(data=="ok")

		   {

			   ok('Permiso(s) eliminados(s) correctamente');

			   setTimeout(CRUDPERFILES('CARGARPERMISOS','',''),1000);

		   }

		   else

	       {

			   error('Surgió un error al eliminar permiso(s). Verificar');

		   }

	   });

   }

     else if(o=="MODIFICARPERMISO")

   {

	   var ide = $('#idedicion').val();

	   $.post('funciones/fnPerfiles.php',{opcion:o,metodo:id,ventana:idd},

	   function(data)

	   {

		   if(data=="ok")

		   {

			   ok('Permiso modificado correctamente');

		   }

		   else

	       {

			   error('Surgió un error al modificar permiso. Verificar');

		   }

	   });

   }

 	else if(o=="ELIMINAR")

	{

	   jConfirm('Realmente desea eliminar el perfil seleccionado?', 'Dialogo de Confirmación HD',null, function(r) {

	   if(r==true)

	   {

		    $.post('funciones/fnPerfiles.php',{opcion:o,id:id},

			function(data)

			{

			    if(data==1)

			   { 

			        ok('Perfil eliminado correctamente');

					var table = $('#tbperfiles').DataTable();

					table.row('#row_per'+id).remove().draw(false);				 

			   }

			   else

			   {

				   error('Surgió un error al eliminar el perfil. Verificar');

			   }

			});

	   }

	   else

	   {

		  return false;  

	   }

	   });

	}

	else

	if(o=="PERMISOSPERFIL")

    {

		$('#btnguardar').attr('name','');

		$('#btnguardar').css('display','none');

		$('#myModalLabel').html("Asignacion de Permisos");

		$('.modal-dialog').addClass('modal-lg');

		$('#contenido').html('');

		$.post('funciones/perfiles/fnPerfiles.php',{opcion:o,id:id},

		function(data)

        {

			$('#contenido').html(data);

		});			

    }

    else if(o=="CARGARLISTAPERFILES")

    {

    	$.post('funciones/perfiles/fnPerfiles.php',{opcion:o},

		function(data)

        {

			$('#tabladatos').html(data);

		});		

    }	

}



function CRUDCATEGORIAS(o,id)

{

	if(o=="NUEVO")

	{

		$('#titlemodal').html("Registro Categoria");

		$('#btnguardar').attr('onclick',"CRUDCATEGORIAS('GUARDAR','')");

            

		$.post('funciones/productos/fnCategorias.php', {opcion: o}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodal').html(data);

		});

	}

	else

	if(o=="EDITAR")

	{

		$('#titlemodal').html("Edición Categoria");

		$('#btnguardar').attr('onclick',"CRUDCATEGORIAS('GUARDAREDICION','"+id+"')");

		$.post('funciones/productos/fnCategorias.php', {opcion: o,id:id}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodal').html(data);

		});

	}

	else if(o=="GUARDAR")

	{

		var nom = $('#txtnombre').val();

		var pal = $('#txtpalabra').val();

		var desc = $('#txtdescripcion').val().replace(new RegExp("\n","g"), "<br>");

		var pad = $('#selpadre').val();

		var ruta = $('#rutacategoria').text();

		var ckactivo = $('input:checkbox[name=ckactivo]:checked').val();

		if(nom=="")

		{

			error("Diligenciar el nombre de la categoria. Verificar");

			$('#txtnombre').focus();

		}

		else if(desc=="")

		{

			error("Diligenciar una descripción corta de la categoria. Verificar");

			$('#txtdescripcion').focus();

		}

		else

		{

			$.post('funciones/productos/fnCategorias.php',{opcion:o,nom:nom,pal:pal,ruta:ruta,act:ckactivo,desc:desc,pad:pad},function(data){

				var res = data[0].res;

				if(res=="error_sesion")

				{



				}

				else if(res=="error")

				{

					var msn = data[0].msn;

					error(msn);

				}

				else

				{

					var msn = data[0].msn;

					ok(msn);

					setTimeout(CRUDCATEGORIAS('LISTACATEGORIAS',''),1000);

				}



			},"json");

		}

		

	}

	else if(o=="GUARDAREDICION")

	{

		var nom = $('#txtnombre').val();

		var pal = $('#txtpalabra').val();

		var desc = $('#txtdescripcion').val().replace(new RegExp("\n","g"), "<br>");

		var pad = $('#selpadre').val();

		var ruta = $('#rutacategoria').text();

		var ckactivo = $('input:checkbox[name=ckactivo]:checked').val();

		if(nom=="")

		{

			error("Diligenciar el nombre de la categoria. Verificar");

			$('#txtnombre').focus();

		}

		else if(desc=="")

		{

			error("Diligenciar una descripción corta de la categoria. Verificar");

			$('#txtdescripcion').focus();

		}

		else

		{

			$.post('funciones/productos/fnCategorias.php',{opcion:o,nom:nom,pal:pal,ruta:ruta,act:ckactivo,desc:desc,pad:pad,id:id},function(data){

				var res = data[0].res;

				if(res=="error_sesion")

				{



				}

				else if(res=="error")

				{

					var msn = data[0].msn;

					error(msn);

				}

				else

				{

					var msn = data[0].msn;

					ok(msn);

					setTimeout(CRUDCATEGORIAS('LISTACATEGORIAS',''),1000);

				}



			},"json");

		}

		

	}

	else if(o=="ELIMINARCATEGORIA")

	{

		swal({

			title: 'Estas seguro de eliminar la categoria seleccionada?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/productos/fnCategorias.php', { opcion: o, id: id }, function (dato) {

					var res = dato[0].res;

					var msn = dato[0].msn;

					if (res == "ok") {

						$('#cat_' + id).fadeOut('slow');

						ok(msn);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="LISTACATEGORIAS")

	{

		var bus = $('#busquedageneral').val();

		$.post('funciones/productos/fnCategorias.php',{opcion:o,bus:bus},function(data){

			$('#tabladatos').html(data);

		})

	}

}

function CRUDPROVEEDORES(o,id,idc)

{

	if(o=="NUEVO")

	{

		$('#titlemodal').html("Registro Proveedor");

		$('#modalregistro > .modal-dialog').addClass('modal-lg');

		$('#btnguardar').attr('onclick',"CRUDPROVEEDORES('GUARDAR','','','')");

		$('')

            

		$.post('funciones/proveedor/fnProveedor.php', {opcion: o}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodal').html(data);

		});

	}

	else if(o=="GUARDAREDICION")

	{

		var nom = $('#nombre').val();

		var num = $('#numdoc').val();

		var tip = $('#tipo').val();

		var ema = $('#email').val();

		var tel1 = $('#telefono1').val();

		var tel2 = $('#telefono2').val();

		var dir = $('#direccion').val();

		var obs = $('#observacion').val();		

		var act = $('input:checkbox[name=activo]:checked').val();

		if(act=="" || act==null){ act=0;}

		



		$.post('funciones/proveedor/fnProveedor.php',{opcion:"GUARDAREDICION",nom:nom,num:num,tip:tip,ema:ema,tel1:tel1,tel2:tel2,dir:dir,obs:obs,act:act,id:id},

		function (data) {

            

            var res = data[0].res;

            var msn = data[0].msn;

            if(res=="ok")

            {

            	var table = $('#tbproveedor').DataTable();

            	table.row('#rowp_').draw(false);

            	ok(msn);

            }

            else

            {

            	error(msn);

            }

        },"json");

	}

	else if(o=="GUARDAR")

	{

		var nom = $('#nombre').val();

		var num = $('#numdoc').val();

		var tip = $('#tipo').val();

		var ema = $('#email').val();

		var tel1 = $('#telefono1').val();

		var tel2 = $('#telefono2').val();

		var dir = $('#direccion').val();

		var obs = $('#observacion').val();		

		var act = $('input:checkbox[name=activo]:checked').val();		

		if(act=="" || act==null){ act=0;}



		$.post('funciones/proveedor/fnProveedor.php',{opcion:"GUARDAR",nom:nom,num:num,tip:tip,ema:ema,tel1:tel1,tel2:tel2,dir:dir,obs:obs,act:act},

		function (data) {

            

            var res = data[0].res;

            var msn = data[0].msn;

            if(res=="ok")

            {

            	var table = $('#tbproveedor').DataTable();

            	table.row('#rowp_').draw(false);

            	ok(msn);

            }

            else

            {

            	error(msn);

            }

        },"json");

	}

	else if(o=="EDITAR")

	{

		$('#modalregistro > .modal-dialog').addClass('modal-lg');

		$('#titlemodal').html("Edición Proveedor");

		$('#btnguardar').attr('onclick',"CRUDPROVEEDORES('GUARDAREDICION','"+id+"','','')");

		$.post('funciones/proveedor/fnProveedor.php', {opcion:o,id:id}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodal').html(data);

		});

	}

	else if(o=="FILTROS")

	{

		$('#titleleft').html('Filtros Proveedor')

		$.post('funciones/proveedor/fnProveedor.php',{opcion:o},function(data){

			$('#contenidomodalleft').html(data);

		})

	}

	else if(o=="ELIMINARPROVEEDOR")

	{

		swal({

			title: 'Estas seguro de eliminar el proveedor seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/proveedor/fnProveedor.php', { opcion: o, id: id }, function (dato) {

					var res = dato[0].res;

					var msn = dato[0].msn;

					if (res == "ok") {

						var table = $('#tbproveedor').DataTable();

						table.row('#rowp_' + id).remove().draw(false);

						ok(msn);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="LISTAPROVEEDORES" )

	{		

		$.post('funciones/proveedor/fnProveedor.php',{opcion:o},function(data){

			$('#tabladatos').html(data);

		});

	}

	else if(o=="HABILITARASIGNAR")

	{

		var sel = $("input:checkbox[name=ckseleccion_"+id+"]:checked").val();

		var valo = $("#valor_" + id).val();

		var ant = $("#valor_" + id).attr("data-old");

		var cal = $('#tbProductosProveedor').attr('data-calidad');

		if(sel==1)

		{  

			$("#valor_" + id).prop('disabled',false).focus(); 

		}

		else 

		{ 

			$("#valor_" + id).prop('disabled',true).val(0);

			CRUDPROVEEDORES('ASIGNARPRODUCTO',id,cal);

		}



	}

	else if(o=="LISTAPRODUCTOS")

	{

		if($('#jsproductosasignados').length>0)

		{

			var arcjs = document.getElementById('jsproductosasignados');

			var idproveedor=arcjs.getAttribute('data-proveedor');

			var idcalidad = arcjs.getAttribute('data-calidad');

		}

		if(idcalidad!="" && idcalidad>0 && idcalidad!=undefined && idc=="")

		{

			idc = idcalidad;

		}

		$.post('funciones/proveedor/fnProveedor.php',{opcion:o,idproveedor:id,idcalidad:idc},function(data){

			$('#divproductosproveedor').html(data);

		});

	}

	else if(o=="TODOSPRODUCTOS")

	{

		$.post('funciones/proveedor/fnProveedor.php',{opcion:o,idproveedor:id,idcalidad:idc},function(data){

			$('#divlistacalidad').html(data);

		});

	}

	else if(o=="ASIGNARPRODUCTO")

	{

		var sel = $("input:checkbox[name=ckseleccion_"+id+"]:checked").val();

		var valo = $("#valor_" + id).val(); 

		var ant = $("#valor_" + id).attr("data-old");

		var arcjs = document.getElementById('jsproductosasignados');

		var idproveedor=arcjs.getAttribute('data-proveedor');

		var idcalidad = arcjs.getAttribute('data-calidad');

		if(sel==1 && (valo<=0 || valo=="") )

		{

			console.info(valo)

			error("El producto debe tener un valor de compra mayor a cero");

		}	

		else

		{

		 	$.post('funciones/proveedor/fnProveedor.php', {opcion: o,idproducto:id,idproveedor:idproveedor,valor:valo,ck:sel,idcalidad:idcalidad}, function(data, textStatus, xhr) {

		 		/*optional stuff to do after success */

		 		var res = data[0].res;

		 		var msn = data[0].msn;

		 		if(res=="ok")

		 		{

		 			//ok(msn);

		 			setTimeout(CRUDPROVEEDORES('TODOSPRODUCTOS',idproveedor,idcalidad),100);

		 		}

		 		else if(res=="ok1")

		 		{

		 			ok(msn);

		 			setTimeout(CRUDPROVEEDORES('TODOSPRODUCTOS',idproveedor,idcalidad),100);

		 		}

		 		else

		 		{

		 			error(msn);

		 		}

		 	},"json");

		}

	}



}

function CRUDPRODUCTOS(o,id,idm,idc)//opcion,prodycto, mercado, clasificacion

{

	$('#btnenviar').hide();

	if(o=="MODIFICARESTADO")

	{

		var estp = $('#ckestado_' + id+':checked').val();

		if(estp=="" || estp==null || estp==undefined){ estp = 0;}

		$.post('funciones/productos/fnProductos.php', {opcion: o,idp:id,estp:estp}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			var res = data[0].res;

			var msn = data[0].msn;

			if(res=="ok")

			{

				ok(msn);

			}

			else

			{

				error(msn);

			}

			

		},"json");

	}

	else

	if(o=="NUEVO")

	{

		$('#titlemodal').html("Registro Producto");

		$('#btnguardar').attr('onclick',"CRUDPRODUCTOS('GUARDAR','','','')");

            

		$.post('funciones/productos/fnProductos.php', {opcion: o}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodal').html(data);

		});

	}

	else

	if(o=="ZOOMPRODUCTOS")

	{

		$('#titleinfo').html("Info Producto");	

		$('#btnenviar').hide();

		$.post('funciones/productos/fnProductos.php', {opcion: o,id:id}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodalinfo').html(data);

		});

	}

	else

	if(o=="EDITAR")

	{

		$('#titlemodal').html("Edición Producto");

		$('#btnguardar').attr('onclick',"CRUDPRODUCTOS('GUARDAREDICION','"+id+"','','')");

		$.post('funciones/productos/fnProductos.php', {opcion:o,id:id}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodal').html(data);

		});

	}

	else if(o=="GUARDAR")

	{

		var nom = $('#txtnombre').val();

		var pal = $('#txtpalabra').val();

		var desc = $('#txtdescripcion').val().replace(new RegExp("\n","g"), "<br>");

		var descbreve = $('#txtdescripcionbreve').val().replace(new RegExp("\n","g"), "<br>");

		var mar = $('#txtmarca').val();

		var cat = $('#selcategoria').val();

		var tt = $('#seltipotalla').val();

		var pre = $('#txtprecio').val();

		pre = pre.replace('$', "");

		pre = pre.replace('.', "");

		pre = pre.replace(/,/g, "");



		var cod = $('#txtcodigo').val();

		var ruta = $('#rutaproducto').text();

		var act = $('input:checkbox[name=ckactivo]:checked').val();

		var ago = $('input:checkbox[name=ckagotado]:checked').val();



		var puc = $('input:checkbox[name=ckunidadcompra]:checked').val();

		var ppc = $('input:checkbox[name=ckpesocompra]:checked').val();

		var puv = $('input:checkbox[name=ckunidadventa]:checked').val();

		var ppv = $('input:checkbox[name=ckpesoventa]:checked').val();

		var tall = $('input:checkbox[name=cktallas]:checked').val();

		var mad = $('input:checkbox[name=ckmaduracion]:checked').val();

		var tam = $('input:checkbox[name=cktamano]:checked').val();

		if(act<=0 || act==undefined){ act=0; }

		if(ago<=0 || ago==undefined){ ago=0; }

		if(mad<=0 || mad==undefined){ mad=0; }

		if(tam<=0 || tam==undefined){ tam=0; }

		if(puc<=0 || puc==undefined){ puc=0; }

		if(ppc<=0 || ppc==undefined){ ppc=0; }

		if(puv<=0 || puv==undefined){ puv=0; }

		if(ppv<=0 || ppv==undefined){ ppv=0; }

		if(tall<=0 || tall==undefined){ tall=0; }



		var pmuc = $('#txtunidadcompra').val();

		var pmpc = $('#txtpesocompra').val();

		var pmuv = $('#txtunidadventa').val(); 

		var pmpv = $('#txtpesoventa').val(); 



		if(pmuc<=0 || pmuc==null || pmuc==""){ pmuc = 0;  }else{

			pmuc = pmuc.replace(",", "").replace(",", "");

			pmuc = pmuc.replace(",", "").replace(",", "");

		}

		 

		if(pmpc<=0 || pmpc==null || pmpc==""){ pmpc = 0;  }else{

			pmpc = pmpc.replace(",", "").replace(",", "");

			pmpc = pmpc.replace(",", "").replace(",", "");

		}

		

		if(pmuv<=0 || pmuv==null || pmuv==""){ pmuv = 0; }else{

			pmuv = pmuv.replace(",", "").replace(",", "");

			pmuv = pmuv.replace(",", "").replace(",", "");

		}

		

		if(pmpv<=0 || pmpv==null || pmpv==""){ pmpv = 0; }else{

			pmpv = pmpv.replace(",", "").replace(",", "");

			pmpv = pmpv.replace(",", "").replace(",", "");

		}

		var kil = $('input:checkbox[name=ckkilo]:checked').val();

		var undkilo = 0;// $('#txtundkilo').val();

		if(kil<=0 || kil==undefined){ kil=0; undkilo = 0; 

		}



		if(nom=="")

		{

			error("Diligenciar el nombre del producto. Verificar");

			$('#txtnombre').focus();

		}

		else if(desc=="")

		{

			error("Diligenciar una descripción del producto. Verificar");

			$('#txtdescripcion').focus();

		}

		else if(cat=="" || cat==null)

		{

			error("Seleccionar la categoria del producto. Verificar");

			$('#selcategoria').focus();

		}

		else if(pre=="" || pre==null || pre < 0)

		{

			error("Diligenciar el precio al cliente. Verificar");

			$('#txtprecio').focus();

		}

		else

		if(puc==0 && ppc==0)

		{

			error("Debe indicar al menos una unidad de compra del producto. Verificar");

		}

		else if(puc==1 && pmuc<=0)

		{

			error("Debe indicar la cantidad minima de compra del producto. Verificar");

		}

		else if(ppc==1 && pmpc<=0)

		{

			error("Debe indicar el peso minimo de compra del producto")

		}

		else

		if(puv==0 && ppv==0)

		{

			error("Debe indicar al menos una unidad de venta del producto. Verificar");

		}

		else if(puv==1 && pmuv<=0)

		{

			error("Debe indicar la cantidad minima de venta del producto. Verificar");

		}

		else if(ppv==1 && pmpv<=0)

		{

			error("Debe indicar el peso minimo de venta del producto");

		}

		else if(tall==1 && tt=="")

		{

			error("Debe indicar el tipo de talla del producto. Verificar");

		}

		else

		{

			$.post('funciones/productos/fnProductos.php',{opcion:o,nom:nom,pal:pal,ruta:ruta,act:act,desc:desc,cat:cat,pre:pre,mar:mar,cod:cod,descbreve:descbreve,ago:ago,puc:puc,pmuc:pmuc,ppc:ppc,pmpc:pmpc,puv:puv,pmuv:pmuv,ppv:ppv,pmpv:pmpv,tall:tall,tt:tt,mad:mad,tam:tam,kil:kil,undkilo:undkilo},function(data){

				var res = data[0].res;

				var msn = data[0].msn;

				if(res=="error_sesion")

				{



				}

				else if(res=="error")

				{					

					error(msn);

				}

				else

				{					

					ok(msn);

					var table = $('#tbproductos').DataTable();

					table.draw('full-hold');

					setTimeout(CRUDPRODUCTOS('REFRESHPRODUCTOS','','',''),1000);

					setTimeout(CRUDPRODUCTOS('NUEVO','','',''),1000);

				}



			},"json");

		}

		

	}

	else if(o=="EDITARCOSTO" || o=="EDITARCOSTON")

	{

		var pre = $('#pre_' + idc ).val();

		var pesund = $('#pesund_' + idc).val();			

		pesund = pesund.replace("$", "").replace(",", "");

		pesund = pesund.replace(",", "").replace(",", "");

		pesund = pesund.replace(",", "").replace(",", "");

		pre = pre.replace("$", "").replace(",", "");

		pre = pre.replace(",", "").replace(",", "");

		pre = pre.replace(",", "").replace(",", "");

		$.post('funciones/productos/fnProductos.php',{opcion:o,idp:id,idc:idc,pre:pre,pes:pesund},function(data){

			var res =  data[0].res;

			var msn = data[0].msn;

			if(res=="error")

			{

				error(msn);

			}

			else

			{

				if(o=="EDITARCOSTO")

				{

				 	CRUDPRODUCTOS('LISTACOSTOS',id,'','');

				 	setTimeout(PRECIOS(id),1000);

				}

				else

				{

					CRUDPRODUCTOS('LISTACOSTOSN',id,'','');

				}

			}

		},"json");

	}

	else if(o=="LISTACOSTOS" || o=="LISTACOSTOSN")

	{

		var kil = $('input:checkbox[name=ckkilo]:checked').val();

		if(kil<=0 || kil==undefined){ kil=0;}

		$('#listacosto').html('Cargando lista de costos...');

		$.post('funciones/productos/fnProductos.php',{opcion:o,idp:id,kil:kil},function(data){

			$('#listacosto').html(data);

		})

	}

	else if(o=="GUARDAREDICION")

	{

		var nom = $('#txtnombre').val();

		var pal = $('#txtpalabra').val();

		var desc = $('#txtdescripcion').val().replace(new RegExp("\n","g"), "<br>");

		var descbreve = $('#txtdescripcionbreve').val().replace(new RegExp("\n","g"), "<br>");

		var mar = $('#txtmarca').val();

		var cat = $('#selcategoria').val();

		var tt = $('#seltipotalla').val();

		var pre = $('#txtprecio1').val();

		pre = pre.replace('$', "");

		pre = pre.replace('.', "");

		pre = pre.replace(/,/g, "");

		var cod = $('#txtcodigo').val();

		var ruta = $('#rutaproducto').text();

		var act = $('input:checkbox[name=ckactivo]:checked').val();

		var ago = $('input:checkbox[name=ckagotado]:checked').val();



		var puc = $('input:checkbox[name=ckunidadcompra]:checked').val();

		var ppc = $('input:checkbox[name=ckpesocompra]:checked').val();

		var puv = $('input:checkbox[name=ckunidadventa]:checked').val();

		var ppv = $('input:checkbox[name=ckpesoventa]:checked').val();

		var tall = $('input:checkbox[name=cktallas]:checked').val();

		var mad = $('input:checkbox[name=ckmaduracion]:checked').val();

		var tam = $('input:checkbox[name=cktamano]:checked').val();

		if(act<=0 || act==undefined){ act=0; }

		if(ago<=0 || ago==undefined){ ago=0; }

		if(mad<=0 || mad==undefined){ mad=0; }

		if(tam<=0 || tam==undefined){ tam=0; }

		if(puc<=0 || puc==undefined){ puc=0; }

		if(ppc<=0 || ppc==undefined){ ppc=0; }

		if(puv<=0 || puv==undefined){ puv=0; }

		if(ppv<=0 || ppv==undefined){ ppv=0; }

		if(tall<=0 || tall==undefined){ tall=0; }

		var kil = $('input:checkbox[name=ckkilo]:checked').val();

		var undkilo = $('#txtundkilo').val();

		if(kil<=0 || kil==undefined){ kil=0; 

			//undkilo = 0; 

		}



		var pmuc = $('#txtunidadcompra').val(); 

		var pmpc = $('#txtpesocompra').val();

		var pmuv = $('#txtunidadventa').val(); 

		var pmpv = $('#txtpesoventa').val(); 



		if(pmuc<=0 || pmuc==null || pmuc==""){ pmuc = 0;  }else{

			pmuc = pmuc.replace(",", "").replace(",", "");

			pmuc = pmuc.replace(",", "").replace(",", "");

		}

		 

		if(pmpc<=0 || pmpc==null || pmpc==""){ pmpc = 0;  }else{

			pmpc = pmpc.replace(",", "").replace(",", "");

			pmpc = pmpc.replace(",", "").replace(",", "");

		}

		

		if(pmuv<=0 || pmuv==null || pmuv==""){ pmuv = 0; }else{

			pmuv = pmuv.replace(",", "").replace(",", "");

			pmuv = pmuv.replace(",", "").replace(",", "");

		}

		

		if(pmpv<=0 || pmpv==null || pmpv==""){ pmpv = 0; }else{

			pmpv = pmpv.replace(",", "").replace(",", "");

			pmpv = pmpv.replace(",", "").replace(",", "");

		}



		if(nom=="")

		{

			error("Diligenciar el nombre del producto. Verificar");

			$('#txtnombre').focus();

		}

		else if(desc=="")

		{

			error("Diligenciar una descripción del producto. Verificar");

			$('#txtdescripcion').focus();

		}

		else if(cat=="" || cat==null)

		{

			error("Seleccionar la categoria del producto. Verificar");

			$('#selcategoria').focus();

		}

		else if(pre=="" || pre==null)

		{

			error("Diligenciar el Precio al Cliente. Verificar");

			$('#txtprecio').focus();

		}

		else

		if(puc==0 && ppc==0)

		{

			error("Debe indicar al menos una unidad de compra del producto. Verificar");

		}

		else if(puc==1 && pmuc<=0)

		{

			error("Debe indicar la cantidad minima de compra del producto. Verificar");

		}

		else if(ppc==1 && pmpc<=0)

		{

			error("Debe indicar el peso minimo de compra del producto")

		}

		else

		if(puv==0 && ppv==0)

		{

			error("Debe indicar al menos una unidad de venta del producto. Verificar");

		}

		else if(puv==1 && pmuv<=0)

		{

			error("Debe indicar la cantidad minima de venta del producto. Verificar");

		}

		else if(ppv==1 && pmpv<=0)

		{

			error("Debe indicar el peso minimo de venta del producto");

		}

		else if(tall==1 && tt=="")

		{

			error("Debe indicar el tipo de talla del producto. Verificar");

		}

		else

		{

			$.post('funciones/productos/fnProductos.php',{opcion:o,nom:nom,pal:pal,ruta:ruta,act:act,desc:desc,cat:cat,pre:pre,mar:mar,cod:cod,descbreve:descbreve,ago:ago,id:id,puc:puc,pmuc:pmuc,ppc:ppc,pmpc:pmpc,puv:puv,pmuv:pmuv,ppv:ppv,pmpv:pmpv,tall:tall,tt:tt,mad:mad,tam:tam,kil:kil,undkilo:undkilo},function(data){

				var res = data[0].res;

				if(res=="error_sesion")

				{



				}

				else if(res=="error")

				{

					var msn = data[0].msn;

					error(msn);

				}

				else

				{

					var msn = data[0].msn;

					ok(msn);

					var table = $('#tbproductos').DataTable();

					table.row('#row_' + id).draw(false);

					setTimeout(CRUDPRODUCTOS('REFRESHPRODUCTOS','','',''),1000);

				}



			},"json");

		}

		

	

}	else if(o=="FILTROS" || o=="FILTROS2" || o=="FILTROS3" || o=="FILTROS4" || o=="FILTROS5" || o=="FILTROS6" || o=="FILTROS7" || o=="FILTROS8" || o=="FILTROS9" || o=="FILTROS10" || o=="FILTROS11")

	{

		$('#titleleft').html('Filtros productos')

		$.post('funciones/productos/fnProductos.php',{opcion:o},function(data){

			$('#contenidomodalleft').html(data);

		})

	}

	else if(o=="LISTAIMAGENES")

	{

		$('#titleright').html('Lista Imagenes')

		$.post('funciones/productos/fnProductos.php',{opcion:o,idp:id},function(data){

			$('#contenidomodalright').html(data);

		})

	}

	

	else if(o=="ELIMINARPRODUCTO")

	{

		swal({

			title: 'Estas seguro de eliminar el producto seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/productos/fnProductos.php', { opcion: o, id: id }, function (dato) {

					var res = dato[0].res;

					var msn = dato[0].msn;

					if (res == "ok") {

						var table = $('#tbproductos').DataTable();

						table.row('#row_' + id).remove().draw(false);

						ok(msn);

						setTimeout(CRUDPRODUCTOS('REFRESHPRODUCTOS','','',''),1000);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="LISTAPRODUCTOS" || o=="LISTAPRECIOS" || o=="VISTAMOSAICO")

	{

		var bus = $('#busquedageneral').val();

		var nom = $('#busnombre').val();

		var mar = $('#busmarca').val();

		var cat = $('#buscategoria').val();

		var cod = $('#buscodigo').val();

		var mer = $('#busmercado').val();

		

		//var uni = $('#busunidad').val();

		var pro = $('#busproducto').val();



		$.post('funciones/productos/fnProductos.php',{opcion:o,bus:bus,nom:nom,cod:cod,mar:mar,cat:cat,pro:pro,mer:mer,cla:""},function(data){//uni:uni,

			$('#tabladatos').html(data);

		})

	}

	else if(o=="INFOPRODUCTO2")

	{

		var mer = $('#busmercado').val();

		var canp = $('#product_quantity_' + id ).val();

		$('#titleinfo').html("Info Producto");	

		$('#btnenviar').hide();

		$('#contenidomodalinfo').html('');

		$.post('funciones/productos/fnProductos.php', {opcion: o,idproducto:id,canp:canp,idmercado:mer}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodalinfo').html(data);

		});

	}

	else if(o=="CAMBIARPRECIO")

	{

		var mer = $('#busmercado').val();

		$.post('funciones/productos/fnProductos.php', {opcion: o,idp:id,cla:idc,idmercado:mer}, function(data) {

			/*optional stuff to do after success */

			var ven = data[0].venta;

			//var pesounidad = data[0].pesounidad;

			$('#precio_'+ id).html(ven);

			$('#product_price_'+ id).val(ven);	

			//$('#product_quantity4_' + id).attr( 'data-peso-unidad',pesounidad  ); 

			//console.log( "unidad por defecto" + $('#product_quantity4_' + id).attr( 'data-peso-unidad'  ));		

			$('.currency2').formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

			//setTimeout(IncDec('plusminus3 '),1000);

		},"json");

	}

	else if(o=="AGREGARIMAGENES")

	{

		var fileUpload = $("#nuevaimagenproducto")[0];

		var h = 1280;

		var w = 1080;

		var er = 0;

		 var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(.jpg|.jpeg|.png|.gif)$");

        if (regex.test(fileUpload.value.toLowerCase())) {

            //Check whether HTML5 is supported.

            if (typeof (fileUpload.files) != "undefined") {

                //Initiate the FileReader object.

                var reader = new FileReader();

                //Read the contents of Image File.

                reader.readAsDataURL(fileUpload.files[0]);

                reader.onload = function (e) {

                    //Initiate the JavaScript Image object.

                    var image = new Image();

                    //Set the Base64 string return from FileReader as source.

                    image.src = e.target.result;

                    image.onload = function () {

                        //Determine the Height and Width.

                        var height = this.height;

                        var width = this.width;

                        /*if (height > h || width > w || height < h || width<w) {

                            error("El Ancho y alto de la imagen deben ser de 1280x1080.");

                            er = 0;

                        }

                        else

                        {

                        //ok("Uploaded image has valid Height and Width.");

                        

	                        var ruta = $('#rutanueva').text();

							$.post('funciones/productos/fnProductos.php',{opcion:o,ruta:ruta,id:id},function(data){

								var res = data[0].res;

								var msn = data[0].msn;

								if(res=="ok")

								{				

									ok(msn);

									setTimeout(CRUDPRODUCTOS('LISTAIMAGENES',id),10);

									setTimeout(CRUDPRODUCTOS('REFRESHPRODUCTOS','','',''),1000);

								}

								else

								{

									error(msn);

								}

							},"json")

						}*/

						var ruta = $('#rutanueva').text();

							$.post('funciones/productos/fnProductos.php',{opcion:o,ruta:ruta,id:id},function(data){

								var res = data[0].res;

								var msn = data[0].msn;

								if(res=="ok")

								{				

									ok(msn);

									setTimeout(CRUDPRODUCTOS('LISTAIMAGENES',id),10);

									setTimeout(CRUDPRODUCTOS('REFRESHPRODUCTOS','','',''),1000);

								}

								else

								{

									error(msn);

								}

							},"json")

                    };

                }

               

            } else {

                error("Este navegador no es compatible con HTML5.");

                er = 0;

            }

        } else {

            error("Por favor, seleccione un archivo de imagen válido.");

            er = 0;

        }

	}

	else if(o=="ACTIVARIMAGEN")

	{

		var acti = $('input:checkbox[name=imp'+id+']:checked').val();

		if(acti<=0){ acti = 0; }



		$.post('funciones/productos/fnProductos.php',{opcion:o,idip:id,act:acti},function(data){

			var res = data[0].res;

			var msn = data[0].msn;

			if(res=="ok")

			{				

				

				

			}

			else

			{

				error(msn);

			}

		},"json")

	}

	else if(o=="ELIMINARIMAGEN")

	{

		swal({

			title: 'Estas seguro de eliminar la imagen seleccionada?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/productos/fnProductos.php', { opcion: o, id: id }, function (dato) {

					var res = dato[0].res;

					var msn = dato[0].msn;

					if (res == "ok") {

						$('#imgpro_' + id).fadeOut('slow');

						ok(msn);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="EDITARPRECIO")

	{



		$.post('funciones/productos/fnProductos.php',{opcion:o,id:id,idm:idm,idc:idc},function(data){

			$('#contenidomodalright').html(data);

		})

	}

	else if(o=="PRECIOTMP")

	{

		var ven = $('#valorpro_'+id+'_mer_' + idm + '_cla_' + idc).val();

		ven = ven.replace("$", "");

		ven = ven.replace(",", "").replace(",", "");

		ven = ven.replace(",", "").replace(",", "");



		var pu = $('#pesund_'+id+'_mer_' + idm + '_cla_' + idc).val();



		$.post('funciones/productos/fnProductos.php',{opcion:o,id:id,idm:idm,idc:idc,ven:ven,pu:pu},function(data){

			var res = data[0].res;

			var msn = data[0].msn;

			var gan = data[0].gan;

			if(res=="ok")

			{

				//ok(msn);				

			}

			else

			{

				error(msn);

			}

		},"json");

	}	

	else if(o=="GUARDARCAMBIOPRECIO")

	{

		swal({

			title: 'Realmente desea modificar el producto con los precios establecidos?',

			text: "",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, guardar!',

			cancelButtonText: 'No, guardar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/productos/fnProductos.php', { opcion: o, idp: id }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						setTimeout(function(){

							PRECIOS(id)

						},1000);						

					} 

					else 

					{

						error(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="GUARDARPRECIO")

	{

		var cos = $('#txtcosto').val();

		var ven = $('#txtventa').val();

		cos = cos.replace("$", "");

		cos = cos.replace(",", "").replace(",", "");

		cos = cos.replace(",", "").replace(",", "");

		ven = ven.replace("$", "");

		ven = ven.replace(",", "").replace(",", "");

		ven = ven.replace(",", "").replace(",", "");

		$.post('funciones/productos/fnProductos.php',{opcion:o,id:id,cos:cos,ven:ven},function(data){

			var res = data[0].res;

			var msn = data[0].msn;

			var gan = data[0].gan;

			if(res=="ok")

			{

				ok(msn);

				$('#txtganancia').val(gan);

				setTimeout(function() { PRECIOS ( id ); } ,100);

				setTimeout(function() { INICIALIZARCONTENIDO(); } ,200);

			}

			else

			{

				error(msn);

			}

		},"json");

	}

	else if(o=="GUARDARPRECIO2")

	{

		

		var cos = $('#txtcosto').val();

		var ven = $('#txtventa').val();

		cos = cos.replace("$", "");

		cos = cos.replace(",", "").replace(",", "");

		cos = cos.replace(",", "").replace(",", "");

		ven = ven.replace("$", "");

		ven = ven.replace(",", "").replace(",", "");

		ven = ven.replace(",", "").replace(",", "");

		$.post('funciones/productos/fnProductos.php',{opcion:o,id:id,idm:idm,idc:idc,ven:ven,cos:cos},function(data){

			var res = data[0].res;

			var msn = data[0].msn;

			var gan = data[0].gan;

			if(res=="ok")

			{

				ok(msn);

				$('#txtganancia').val(gan);

				setTimeout(function() { PRECIOS ( id ); } ,100);

				setTimeout(function() { INICIALIZARCONTENIDO(); } ,200);

			}

			else

			{

				error(msn);

			}

		},"json");

	}

	else if(o=="REFRESHPRODUCTOS")

	{

		var $sel1 = $('#busproducto');

		$sel1.find('option').remove().end().append('<option value="">Cargando...</option>').val('');  	

		var $group = "";

	  	$.post('funciones/productos/fnProductos.php',{opcion:o},

		function(data)

		{

			$sel1.empty();	

			var res = data[0].res;

			if(res=="no")

			{

				$sel1.selectpicker('refresh');

			}

		    else

		    {       

		        for (var i=0; i<data.length; i++)

		        {

		        	var tip = data[i].tipo;

		        	if(tip=="grupo")

		        	{

		        		$group = $("<optgroup>", { label: data[i].literal });

		        		$group.appendTo($sel1);

		        	}

		        	else

		        	{

		        		var $option = $("<option>",{text:data[i].literal, value: data[i].id  });

		        		$option.attr('data-content',data[i].literal + "<img class='pull-right' src='"+data[i].img+"'  width='20' height='20'/>")

		        		$option.appendTo($group);

		        	}

		        	

		        }

	       		 setTimeout(function(){

	        		$sel1.selectpicker('refresh');

	        	},1000);

			}

		},"json");

	}	

}





function CRUDOFERTAS(o,id)

{

	if (o == "NUEVO" || o=="VISTAMOSAICO" || o=="LISTAOFERTAS") //REGISTRO DE NUEVA CIUDAD

    {        

        var bus = $('#busquedageneral').val();

		var nom = $('#busnombre').val();

		var mar = $('#busmarca').val();

		var cat = $('#buscategoria').val();

		var cod = $('#buscodigo').val();

		//var uni = $('#busunidad').val();

		var pro = $('#busproducto').val();

		var est = $('#busestadooferta').val();

		var ofe = $('#busoferta').val();



		$.post('funciones/ofertas/fnOfertas.php',{opcion:o,bus:bus,nom:nom,cod:cod,mar:mar,cat:cat,pro:pro,est:est,ofe:ofe},function(data){//uni:uni,

			$('#tabladatos').html(data);

		})

    } 

    else if(o=="TIPODESCUENTO")

    {

    	var ti = $('#seltipodescuento').val();

    	if(ti==1)

    	{

    		$("#divtipodescuento").html("$");

    		$('#txtvalor').removeClass('currency2').removeClass('currency4').addClass('currency2');

    	}

    	else

    	if(ti==2)

    	{

    		$("#divtipodescuento").html("%");

    		$('#txtvalor').removeClass('currency2').removeClass('currency4').addClass('currency4');

    	}

    	setTimeout(INICIALIZARCONTENIDO(),100);

    }

    else if(o=="EDITAROFERTA")

    {

    	$('#modalregistro > .modal-dialog').addClass('modal-lg');

        $('#titlemodal').html("Edición Oferta");

		$('#btnguardar').attr('onclick',"CRUDOFERTAS('GUARDAREDICION','"+id+"')");

		$.post('funciones/ofertas/fnOfertas.php', {opcion:o,id:id}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodal').html(data);

		});

    }

    else if(o=="ASOCIARPRODUCTO")

    {

    	var idp = id;

    	var ido = $('#tblistaproductosofertasedicion').attr('data-id');



    	$.post('funciones/ofertas/fnOfertas.php', {opcion:o,idp:idp,ido:ido}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			var res = data[0].res;

			var msn  = data[0].msn;

			if(res=="error")

			{

				error(msn);

			}

		},"json");

    }

    else if(o=="GUARDAREDICION")

    {

    	var ruta = $('#rutaoferta').text();

    	var tit = $('#txttitulo').val();

    	var des = $('#txtdescripcion').val().replace(new RegExp("\n","g"), "<br>");  

    	var mer = $('#selmercado').val();    

    	var fi = $('#txtfechainicio').val();

    	var ff = $('#txtfechafin').val();

    	var hi = $('#txthorainicio').val();

    	var hf = $('#txthorafin').val();

    	var td = $('#seltipodescuento').val();

    	var vd = $('#txtvalor').val();



   		vd = vd.replace("$", "");

   		vd = vd.replace(",", "").replace(",", "");

   		vd = vd.replace(",", "").replace(",", "");

   		

   		var est = $('input:checkbox[name=ckestado]:checked').val();

	    if(est<1){est = 0;}

	    // var count = table.rows( { selected: true } ).count();

	    if(tit=="")

	    {

	      error("Diligencia el nombre de la oferta");

	    }

	    else if(des=="")

	    {

	      error("Diligenciar una descripcion de la oferta")

	    }

	    else if(mer=="" || mer==null)

	    {

	      error("Seleccionar el mercado al cual aplica la oferta");

	    }

	    else if(fi=="" || ff=="")

	    {

	      error("Ingresar la vigenciar de la oferta");

	    }

	    else if(td=="")

	    {

	      error("Seleccionar el tipo de descuento");

	    }

	    else if(vd<=0)

	    {

	      error("Ingresar el valor o porcentaje del descuento");

	    }	   

	   

	    else

	    {

	       

	       $.post('funciones/ofertas/fnOfertas.php',{opcion:o,tit:tit,des:des,fi:fi,ff:ff,hi:hi,hf:hf,ruta:ruta,td:td,vd:vd,est:est,mer:mer,id:id},

	         function(data)

	         {

	            var res = $.trim( data[0].res );

	            var msn = data[0].msn;

	            if(res=="error")

	            {

	               error(msn);      

	            }

	            else if(res=="ok")

	            {

	               ok(msn);

	               var table = $('#tblistaofertas').DataTable();

	               table.row('#rowo_' + id).draw(false);

	            }

	         },"json");      

	    }

	}

	else if(o=="ELIMINAROFERTA")

	{

		 swal({

			title: 'Realmente desea eliminar la oferta seleccionada?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/ofertas/fnOfertas.php', { opcion: o, id: id }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						var table = $('#tblistaofertas').DataTable();

						table.row('#rowo_' + id).remove().draw(false);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

	}



}

function CRUDUNIDADES(o, id) //v = CIUDAD, DEPARTAMENTO,PAIS

{    



    if (o == "NUEVO") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick', "CRUDUNIDADES('GUARDAR','')");

        $('#titlemodal').html("Registro Nueva Unidad de Medida");

        $('#contenidomodal').html('');

		$.post('funciones/unidades/fnUnidades.php', { opcion: o },

		function(data) {

			$('#contenidomodal').html(data);

		});

    } 

  

    else if (o == "EDITAR") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick', "CRUDUNIDADES('GUARDAREDICION','')");

        $('#titlemodal').html("Editar Unidad de Medida");

        $('#contenidomodal').html('');

        $.post('funciones/unidades/fnUnidades.php', { opcion: o,id: id },

            function(data) {

                $('#contenidomodal').html(data);

         })

    }

    //fin nuevo inicio guardar

    else if (o == "GUARDAR") {

        var txtcodigo = $('#txtcodigo').val();

        var txtnombre = $('#txtnombre').val();

        //var radestado = $('input:radio[name=radestado]:checked').val()

        if (txtcodigo == "" || txtcodigo == null) {

            error('Diligenciar el codigo de la unidad de medida. Verificar');

        } else

        if (txtnombre == "" || txtnombre == null) {

            error('Diligenciar el nombre de la unidad de medida. Verificar');

        } else 

        {

            $.post('funciones/unidades/fnUnidades.php', {

                    opcion: o,

                    codigo: txtcodigo,

                    nombre: txtnombre /*,estado:radestado*/

                },

                function(data) {

                    if (data == 1) {

                        ok('Unidad de Medida registrada correctamente');

                        var table = $('#tbunidades').DataTable();

                        table.draw(false);

                        // $('#myModal').modal('hide');

                        //setTimeout(cargarlistadostipo('CARGARLISTAUNIDADES'),1000);

                    } else if (data == 2) {

                        error('Ya hay una unidad de medida con el codigo o nombre ingresados. Verificar');

                    } else {

                        error('Surgió un error al guardar la unidad de medida. Verificar');

                    }

            });

        }

    }

    //fin guardar nuevo inicio guardar edicion

    else if (o == "GUARDAREDICION") 

    {

        var idedi = $('#idedicion').val();

        var txtcodigo = $('#txtcodigo').val();

        var txtnombre = $('#txtnombre').val();

        //var radestado = $('input:radio[name=radestado]:checked').val();

        if (txtcodigo == "" || txtcodigo == null) {

            error('Diligenciar el codigo de la unidad de medida. Verificar');

        }

        else if (txtnombre == "" || txtnombre == null) {

            error('Diligenciar el nombre de la unidad de medida');

        } 

        else 

        {

            $.post('funciones/unidades/fnUnidades.php', {

                    opcion: o,

                    nombre: txtnombre,

                    codigo: txtcodigo /*,estado:radestado*/ ,

                    id: idedi

                },

                function(data) {

                    if (data == 1) {

                        ok('Unidad de Medida actualizado correctamente');

                        // $('#myModal').modal('hide');

                        var table = $('#tbunidades').DataTable();

                        table.row('#row_uni' + idedi).draw(false);

                    } else if (data == 2) {

                        error('Ya hay una unidad de medida con el codigo o nombre ingresados. Verificar');

                    } else {

                        error('Surgió un error al actualizar el unidad de medida. Verificar');

                    }

                });

        }

    } 

    else if (o == "ELIMINAR") 

    {

    	 swal({

			title: 'Realmente desea eliminar la unidad seleccionada?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/unidades/fnUnidades.php', { opcion: o, id: id }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						var table = $('#tbunidades').DataTable();

						table.row('#row_uni' + id).remove().draw(false);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

    }

    else if(o=="LISTAUNIDADES")

    {

    	 $.post('funciones/unidades/fnUnidades.php', {opcion: o },

            function(data) {

                $('#tabladatos').html(data);

            });

    }

}



function CRUDMERCADO(o, id) //v = CIUDAD, DEPARTAMENTO,PAIS

{    



    if (o == "NUEVO") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick', "CRUDMERCADO('GUARDAR','')");

        $('#titlemodal').html("Registro Nuevo mercado");

        $('#contenidomodal').html('');

		$.post('funciones/mercados/fnMercados.php', { opcion: o },

		function(data) {

			$('#contenidomodal').html(data);

		});

    } 

    else if (o == "EDITAR") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick', "CRUDMERCADO('GUARDAREDICION','')");

        $('#titlemodal').html("Editar Mercado");

        $('#contenidomodal').html('');

        $.post('funciones/mercados/fnMercados.php', { opcion: o,id: id },

            function(data) {

                $('#contenidomodal').html(data);

         })

    }

    //fin nuevo inicio guardar

    else if (o == "GUARDAR") {

        var cla = $('#selclasificacion').val();

        var txtnombre = $('#txtnombre').val();

        var txtporcentaje = $('#txtporcentaje').val();

        var cktamano = $('input:checkbox[name=cktamano]:checked').val();v

       	var def = $('#seldefecto').val();



        if(cktamano==null || cktamano==""){ cktamano=0; }

        //var radestado = $('input:radio[name=radestado]:checked').val()

       

        if (txtnombre == "" || txtnombre == null) {

            error('Diligenciar el nombre del mercado. Verificar');

        }  

        else if (cla == "" || cla == null) 

        {

            error('Seleccionar al menos un clasificacion a la cual pertenece mercado. Verificar');

        } 

        else if(def=="" || def==null)

        {

        	error("Seleccionar el tipo de producto por defecto para mercado seleccionado. Verificar");

        }

        else 

        {

            $.post('funciones/mercados/fnMercados.php', {

                    opcion: o,

                    cla: cla,

                    nombre: txtnombre, /*,estado:radestado*/

                    tamano: cktamano,

                    porcentaje:txtporcentaje,

                    def:def

                },

                function(data) {

                	var res =  data[0].res;

                	var msn = data[0].msn;

                    if (res=="ok") {

                        ok(msn);

                        var table = $('#tbmercados').DataTable();

                        table.draw(false);

                        // $('#myModal').modal('hide');

                        //setTimeout(cargarlistadostipo('CARGARLISTAUNIDADES'),1000);

                    } 

                    else  

                    {

                        error(msn);

                    }

            },"json");

        }

    }

    //fin guardar nuevo inicio guardar edicion

    else if (o == "GUARDAREDICION") 

    {

        var idedi = $('#idedicion').val();

       	var cla = $('#selclasificacion').val();

        var txtnombre = $('#txtnombre').val();

         var txtporcentaje = $('#txtporcentaje').val();

        var cktamano = $('input:checkbox[name=cktamano]:checked').val();

        var def = $('#seldefecto').val();

        if(cktamano==null || cktamano==""){ cktamano=0; }

        //var radestado = $('input:radio[name=radestado]:checked').val();

        if (txtnombre == "" || txtnombre == null) 

        {

            error('Diligenciar el nombre del mercado. Verificar');

        }  

        else if (cla == "" || cla == null) 

        {

            error('Seleccionar al menos un clasificacion a la cual pertenece mercado. Verificar');

        }

        else if(def=="" || def==null)

        {

        	error("Seleccionar el tipo de producto por defecto para mercado seleccionado. Verificar");

        } 

        else 

        {

            $.post('funciones/mercados/fnMercados.php', {

                    opcion: o,

                    nombre: txtnombre,

                    cla: cla,

                    tamano:cktamano, /*,estado:radestado*/ 

                    id: idedi,

                    porcentaje:txtporcentaje,

                    def:def

                },

                function(data) {

                	var res = data[0].res;

                	var msn = data[0].msn;

                    if (res == "ok") {

                        ok(msn);

                        // $('#myModal').modal('hide');

                        var table = $('#tbmercados').DataTable();

                        table.row('#row_mer' + idedi).draw(false);

                    } else {

                        error(msn);

                    }

                },"json");

        }

    } 

    else if (o == "ELIMINAR") 

    {

    	 swal({

			title: 'Realmente desea eliminar el mercado seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/mercados/fnMercados.php', { opcion: o, id: id }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						var table = $('#tbmercados').DataTable();

						table.row('#row_mer' + id).remove().draw(false);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

    }

    else if(o=="LISTAMERCADOS")

    {

    	 $.post('funciones/mercados/fnMercados.php', {opcion: o },

            function(data) {

                $('#tabladatos').html(data);

            });

    }

}



function CRUDSECTOR(v, o, id) //v = CIUDAD, DEPARTAMENTO,PAIS

{

	if(o=="LISTASECTORES" || o=="LISTABARRIOS" || o=="LISTADEPARTAMENTOS" || o=="LISTAMUNICIPIOS")

	{

		$.post('funciones/sectores/fnSectores.php', {opcion: o },

		function(data) {

			$('#tabladatos').html(data);

		});

	}

   	else

	if (v == "BARRIO" && o == "NUEVO") //REGISTRO DE NUEVA CIUDAD

	{        

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAR','')");

        $('#titlemodal').html("Registro Nuevo Barrio");

        $('#contenidomodal').html('');

        $.post('funciones/sectores/fnSectores.php', {

                opcion: o,

                ventana: v

            },

            function(data) {

                $('#contenidomodal').html(data);

            });

    } 

    else

	if (v == "MUNICIPIO" && o == "NUEVO") //REGISTRO DE NUEVA CIUDAD

	{        

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAR','')");

        $('#titlemodal').html("Registro Nuevo Munucipio");

        $('#contenidomodal').html('');

        $.post('funciones/sectores/fnSectores.php', {

                opcion: o,

                ventana: v

            },

            function(data) {

                $('#contenidomodal').html(data);

            });

    } 

    else if (v == "SECTOR" && o == "NUEVO") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAR','')");

        $('#titlemodal').html("Registro Nuevo Sector");

        $('#contenidomodal').html('');

        $.post('funciones/sectores/fnSectores.php', {

                opcion: o,

                ventana: v

            },

            function(data) {

                $('#contenidomodal').html(data);

            })

    }  

     else if (v == "DEPARTAMENTO" && o == "NUEVO") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAR','')");

        $('#titlemodal').html("Registro Nuevo Departamento");

        $('#contenidomodal').html('');

        $.post('funciones/sectores/fnSectores.php', {

                opcion: o,

                ventana: v

            },

            function(data) {

                $('#contenidomodal').html(data);

            })

    }  

    else if (v == "BARRIO" && o == "EDITAR") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAREDICION','')");

        $('#titlemodal').html("Editar Barrio");

        $('#contenidomodal').html('');

        $.post('funciones/sectores/fnSectores.php', {

                opcion: o,

                ventana: v,

                id: id

            },

            function(data) {

                $('#contenidomodal').html(data);

            })

    } 

    else if (v == "MUNICIPIO" && o == "EDITAR") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAREDICION','')");

        $('#titlemodal').html("Editar Municipio");

        $('#contenidomodal').html('');

        $.post('funciones/sectores/fnSectores.php', {

                opcion: o,

                ventana: v,

                id: id

            },

            function(data) {

                $('#contenidomodal').html(data);

            })

    } 

    else if (v == "SECTOR" && o == "EDITAR") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAREDICION','')");

        $('#titlemodal').html("Editar Sector");

        $('#contenidomodal').html('');

		$.post('funciones/sectores/fnSectores.php', {

		opcion: o,

		ventana: v,

		id: id

		},

		function(data) {

			$('#contenidomodal').html(data);

		})

    } 

     else if (v == "DEPARTAMENTO" && o == "EDITAR") //REGISTRO DE NUEVA CIUDAD

    {

        $('#btnguardar').attr('onclick',"CRUDSECTOR('"+v+"','GUARDAREDICION','')");

        $('#titlemodal').html("Editar Departamento");

        $('#contenidomodal').html('');

		$.post('funciones/sectores/fnSectores.php', {

		opcion: o,

		ventana: v,

		id: id

		},

		function(data) {

			$('#contenidomodal').html(data);

		})

    } 

    else if (v == "SECTOR" && o == "GUARDAR") 

    {       

        var txtsector = $('#txtsector').val();

        var radestado = $('input:radio[name=radestado]:checked').val();

        var hor = $('#txthoras').val();

        var min = $('#txtminutos').val();

        var dom = $('#txtdomicilio').val();

        var mon = $('#txtmonto').val();

        var mun = $('#selmunicipio').val();

        dom = dom.replace("$", "");

		dom = dom.replace(",", "").replace(",", "");

		dom = dom.replace(",", "").replace(",", "");

		if(dom==""){ dom = 0;}

		mon = mon.replace("$", "");

		mon = mon.replace(",", "").replace(",", "");

		mon = mon.replace(",", "").replace(",", "");

		if(mon==""){ mon = 0;}

		if(mun=="" || mun==null)

		{

			error("Seleccionar el municipio del sector");

		}

		else if (txtsector == "" || txtsector == null) {

            error('Diligenciar el nombre del sector');

        } 

        else 

        {

			$.post('funciones/sectores/fnSectores.php', {

				opcion: o,

				ventana: v,                    

				sector: txtsector,

				estado: radestado,

				hor:hor,

				min:min,

				dom:dom,

				mun:mun,

				mon:mon

			},

			function(data) {

				var res = data[0].res;

				var msn = data[0].msn;

				if (res == "ok") 

				{

					$('#txtsector').val('');

					ok(msn);

				// $('#myModal').modal('hide');

					setTimeout(CRUDSECTOR('','LISTASECTORES',''), 1000);

				} 

				else 

				{

					error(msn);

				} 

			},"json");

        }



    } 

     else if (v == "DEPARTAMENTO" && o == "GUARDAR") 

    {       

        var txtdepartamento = $('#txtdepartamento').val();

        var radestado = $('input:radio[name=radestado]:checked').val();

		if(dom==""){ dom = 0;}

        if (txtdepartamento == "" || txtdepartamento == null) {

            error('Diligenciar el nombre del departamento');

        } 

        else 

        {

			$.post('funciones/sectores/fnSectores.php', {

			opcion: o,

			ventana: v,                    

			departamento: txtdepartamento,

			estado: radestado		

			},

			function(data) {

				var res = data[0].res;

				var msn = data[0].msn;

				if (res == "ok") 

				{

					$('#txtdepartamento').val('');

					ok(msn);

				// $('#myModal').modal('hide');

					setTimeout(CRUDSECTOR('','LISTADEPARTAMENTOS',''), 1000);

				} 

				else 

				{

					error(msn);

				} 

			},"json");

        }



    } 

    else if (v == "BARRIO" && o == "GUARDAR") 

    {       

        var selsector = $('#selsector').val()

        var txtbarrio= $('#txtbarrio').val();

        var radestado = $('input:radio[name=radestado]:checked').val()

       

        if (selsector == "" || selsector == null) 

        {

            error('Seleccionar el sector');

        } 

        else if (txtbarrio == "" || txtbarrio == null) 

        {

            error('Diligenciar el nombre del barrio');

        } 

        else 

        {

            $.post('funciones/sectores/fnSectores.php', {

                    opcion: o,

                    ventana: v,                    

                    sector: selsector,

                    barrio: txtbarrio,

                    estado: radestado

                },

                function(data) {

                	var res = data[0].res;

                	var msn = data[0].msn;

                    if (res == "ok") {

                    	$('#txtbarrio').val('');

                        ok(msn);

                        // $('#myModal').modal('hide');

                        // cargarlistapaises();

                        CRUDSECTOR('','LISTABARRIOS','')

                    } 

                    else 

                    {

                        error(msn);

                    }

            },"json");

        }

    }

    else if (v == "MUNICIPIO" && o == "GUARDAR") 

    {       

        var seldepartamento = $('#seldepartamento').val()

        var txtmunicipio= $('#txtmunicipio').val();

        var radestado = $('input:radio[name=radestado]:checked').val()

       

        if (seldepartamento == "" || seldepartamento == null) 

        {

            error('Seleccionar el departamento');

        } 

        else if (txtmunicipio == "" || txtmunicipio == null) 

        {

            error('Diligenciar el nombre del municipio');

        } 

        else 

        {

            $.post('funciones/sectores/fnSectores.php', {

                    opcion: o,

                    ventana: v,                    

                    departamento: seldepartamento,

                    municipio: txtmunicipio,

                    estado: radestado

                },

                function(data) {

                	var res = data[0].res;

                	var msn = data[0].msn;

                    if (res == "ok") {

                    	$('#txtmunicipio').val('');

                        ok(msn);

                        // $('#myModal').modal('hide');

                        // cargarlistapaises();

                        CRUDSECTOR('','LISTAMUNICIPIOS','')

                    } 

                    else 

                    {

                        error(msn);

                    }

            },"json");

        }

    }

    //fin guardar nuevo inicio guardar edicion

     else if (v == "SECTOR" && o == "GUARDAREDICION") {

        var idedi = $('#idedicion').val();

      

        var txtsector = $('#txtsector').val();

        var radestado = $('input:radio[name=radestado]:checked').val();

        var hor = $('#txthoras').val();

        var min = $('#txtminutos').val();

        var dom = $('#txtdomicilio').val();

        var mon = $('#txtmonto').val();

        var mun = $('#selmunicipio').val();

        dom = dom.replace("$", "");

		dom = dom.replace(",", "").replace(",", "");

		dom = dom.replace(",", "").replace(",", "");

		mon = mon.replace("$", "");

		mon = mon.replace(",", "").replace(",", "");

		mon = mon.replace(",", "").replace(",", "");

		if(mon==""){ mon = 0;}

		if (mun == "" || mun == null) 

        {

            error('Seleccionar el municipio del sector');

        } 

        else 

        if (txtsector == "" || txtsector == null) 

        {

            error('Diligenciar el nombre del sector');

        } 

        else 

        {

            $.post('funciones/sectores/fnSectores.php', {

                    opcion: o,

                    ventana: v,                    

                    sector: txtsector,

                    estado: radestado,

                    id: idedi,

					hor:hor,

					min:min,

					dom:dom,

					mun:mun,

					mon:mon

                },

                function(data) {

                	var res = data[0].res;

                	var msn = data[0].msn;

                    if (res == "ok") {

                        ok(msn);

                        // $('#myModal').modal('hide');

                        setTimeout(CRUDSECTOR('','LISTASECTORES',''), 1000);

                    } else  

                    {

                        error(msn);

                    }

                },"json");

        }

    } 

      else if (v == "DEPARTAMENTO" && o == "GUARDAREDICION") {

        var idedi = $('#idedicion').val();

      

        var txtdepartamento = $('#txtdepartamento').val();

        var radestado = $('input:radio[name=radestado]:checked').val();

     

        if (txtdepartamento == "" || txtdepartamento == null) 

        {

            error('Diligenciar el nombre del departamento');

        } 

        else 

        {

            $.post('funciones/sectores/fnSectores.php', {

                    opcion: o,

                    ventana: v,                    

                    departamento: txtdepartamento,

                    estado: radestado,

                    id: idedi				

                },

                function(data) {

                	var res = data[0].res;

                	var msn = data[0].msn;

                    if (res == "ok") {

                        ok(msn);

                        // $('#myModal').modal('hide');

                        setTimeout(CRUDSECTOR('','LISTADEPARTAMENTOS',''), 1000);

                    } else  

                    {

                        error(msn);

                    }

                },"json");

        }

    } 

    else if (v == "BARRIO" && o == "GUARDAREDICION") 

    {

        var idedi = $('#idedicion').val();        

        var selsector = $('#selsector').val()

        var txtbarrio = $('#txtbarrio').val();

        var radestado = $('input:radio[name=radestado]:checked').val()

       

        if (selsector == "" || selsector == null) {

            error('Seleccionar el sector');

        } else if (txtbarrio == "" || txtbarrio == null) {

            error('Diligenciar el nombre del barrio');

        } else {

            $.post('funciones/sectores/fnSectores.php', {

                    opcion: o,

                    ventana: v,                   

                    sector: selsector,

                    barrio: txtbarrio,

                    estado: radestado,

                    id: idedi

                },

                function(data) {

                	var res = data[0].res;

                	var msn = data[0].msn;

                    if (res == "ok") 

                    {

                        ok(msn);                        

                        setTimeout(CRUDSECTOR('','LISTABARRIOS',''), 1000);

                    } 

                    else  

                    {

                        error(msn);

                    }

                },"json");

        }

    } 

     else if (v == "MUNICIPIO" && o == "GUARDAREDICION") 

    {

        var idedi = $('#idedicion').val();        

        var seldepartamento = $('#seldepartamento').val()

        var txtmunicipio = $('#txtmunicipio').val();

        var radestado = $('input:radio[name=radestado]:checked').val()

       

        if (seldepartamento == "" || seldepartamento == null) {

            error('Seleccionar el departamento');

        } else if (txtmunicipio == "" || txtmunicipio == null) {

            error('Diligenciar el nombre del municipio');

        } else {

            $.post('funciones/sectores/fnSectores.php', {

                    opcion: o,

                    ventana: v,                   

                    departamento: seldepartamento,

                    municipio: txtmunicipio,

                    estado: radestado,

                    id: idedi

                },

                function(data) {

                	var res = data[0].res;

                	var msn = data[0].msn;

                    if (res == "ok") 

                    {

                        ok(msn);                        

                        setTimeout(CRUDSECTOR('','LISTAMUNICIPIOS',''), 1000);

                    } 

                    else  

                    {

                        error(msn);

                    }

                },"json");

        }

    } 

    else if (o == "ELIMINAR" && v == "BARRIO") 

    {

    	swal({

			title: 'Realmente desea eliminar el barrio seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/sectores/fnSectores.php', { opcion: o, id: id, ventana: v }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						var table = $('#tbsectores').DataTable();

						table.row('#row_bar' + id).remove().draw(false);

					} else {

						error(msn);

					}

				}, "json");

			}

		});      

    } 

     else if (o == "ELIMINAR" && v == "MUNICIPIO") 

    {

    	swal({

			title: 'Realmente desea eliminar el municipio seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/sectores/fnSectores.php', { opcion: o, id: id, ventana: v }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						var table = $('#tbsectores').DataTable();

						table.row('#row_mun' + id).remove().draw(false);

					} else {

						error(msn);

					}

				}, "json");

			}

		});      

    } 

    else if (o == "ELIMINAR" && v == "SECTOR") 

    {

    	swal({

			title: 'Realmente desea eliminar el sector seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/sectores/fnSectores.php', { opcion: o, id: id, ventana: v }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						var table = $('#tbsectores').DataTable();

						table.row('#row_sec' + id).remove().draw(false);

					} else {

						error(msn);

					}

				}, "json");

			}

		});  

    } 

    else if (o == "ELIMINAR" && v == "DEPARTAMENTO") 

    {

    	swal({

			title: 'Realmente desea eliminar el departamento seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, eliminar!',

			cancelButtonText: 'No, eliminar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/sectores/fnSectores.php', { opcion: o, id: id, ventana: v }, function (data) {

					var res = $.trim(data[0].res);

					var msn = data[0].msn;

					if (res == "ok") {

						ok(msn);

						var table = $('#tbdepartamento').DataTable();

						table.row('#row_dep' + id).remove().draw(false);

					} else {

						error(msn);

					}

				}, "json");

			}

		});  

    } 

}
function whatTest(ev){
	console.log(ev);
}
function cargar_provincias(){

}
function CRUDVENTAS(o,id)

{

	if(o=="LISTAVENTAS")

	{

		$('#divventas').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/ventas/fnVentas.php',{opcion:o},

		function(data)

		{

			$('#divventas').html(data);

		});

	}

	else

	if(o=="GUARDARVENTA")

	{

		var txtnom = $('#txtnombrecliente').val();
		var txtced = $('#txtcedulacliente').val();
		var txtnomProd = $('#txtnombreproducto').val();

		var txttel = $('#txttelefonocliente').val();

		var txtdir = $('#txtdireccioncliente').val();

		var txtfec = $('#txtfechaventa').val();

		var selproduc = $('#selproductoventa').val();

		var txtcant = $('#txtcantventa').val();

		var tallaproduc = $('#tallaproductoventa').val();

		var txtval = $('#txtvalventa').val();

		var seltipoventa = $('#seltipoventa').val();

		var rutpro = $('#rutaproductoventa').text();

		var rutconv = $('#rutaconversacionventa').text();



		txtval = txtval.replace("$", "");

		txtval = txtval.replace(",", "").replace(",", "");

		txtval = txtval.replace(",", "").replace(",", "");



		if(txtnom=="" || txtnom==null)

		{

			error("Ingrese el nombre del cliente");

			$('#txtnombrecliente').focus();

		}

		else

		if(txttel=="" || txttel==null)

		{

			error("Ingrese el teléfono del cliente");

			$('#txttelefonocliente').focus();

		}

		else

		if(txtdir=="" || txtdir==null)

		{

			error("Ingrese la dirección del cliente");

			$('#txtdireccioncliente').focus();

		}

		else

		if(txtfec=="" || txtfec==null)

		{

			error("Seleccione la fecha de la entrada");

			$('#txtfechaventa').focus();

		}

		else

		if(selproduc=="" && seltipoventa == "CARRITO")

		{

			error("Seleccione el producto");

			$('#selproductoventa').focus();

		}

		else

		if((rutpro=="") && seltipoventa == "WHATSAPP")

		{

			error("Adjuente el producto y la conversación de la Venta");

			$('#selproductoventa').focus();

		}

		else

		if(txtcant=="" || txtcant==0 || txtcant <= 0)

		{

			error("Ingrese la cantidad vendida");

			$('#txtcantventa').focus();

		}

		else

		if(txtval=="" || txtval==0 || txtval <= 0)

		{

			error("Ingrese el valor del producto");

			$('#txtvalventa').focus();

		}

		else

		{
			

			$.post('funciones/ventas/fnVentas.php', {opcion:o,txtnom:txtnom,txtced: txtced,txtnomProd: txtnomProd, txttel:txttel,txtdir:txtdir,txtfec:txtfec,selproduc:selproduc,txtcant:txtcant,tallaproduc:tallaproduc,txtval:txtval,seltipoventa:seltipoventa,rutpro:rutpro,rutconv:rutconv}, function(data) {

				

				if(data>0)

				{
					$.post('funciones/ventas/fnVentasWhatsapp.php', {opcion:o,txtnom:txtnom,txtced:txtced,txtnomProd:txtnomProd,txttel:txttel,txtdir:txtdir,txtfec:txtfec,selproduc:selproduc,tallaproduc:tallaproduc,txtcant:txtcant,txtval:txtval,seltipoventa:seltipoventa,rutpro:rutpro,rutconv:rutconv}, function(data2) {
						//console.log(data2)
						window.open(data2)
					});

					ok("Venta anexada!");

					$('#txtnombrecliente').val('');
					$('#txtcedulacliente').val('');
					$('#txtnombreproducto').val('');

					$('#txttelefonocliente').val('');

					$('#txtdireccioncliente').val('');

					$('#txtfechaventa').val('');

					$('#selproductoventa>option[value=""]').attr('selected', 'selected');

					$('#selproductoventa').selectpicker('refresh');

					$('#txtcantventa').val('');

					$('#txtvalventa').val('');
					$('#txtvaltallas').val('');

					var table = $('#tbventas').DataTable();

					table.draw('full-hold');

					//setTimeout(CALCULARCANTIDAD(),1000);

				}

				else

				{

					error("Ocurrio un error, intentelo de nuevo, Verificar");

				}

			});

		}

	}

	else

	if(o=="PRECIOPRODUCTO")

	{

		$.post('funciones/ventas/fnVentas.php', {opcion:o,idproducto:id}, function(data) {
			data = JSON.parse(data);
			data =  data[0];
			//console.log("***", data)
			$('#txtvalventa').val(data.precios);
		});

	}
	
	else

	if(o=="TIPOVENTA")

	{

		if(id == "WHATSAPP")

		{

			$('#visibilidadproducto').css('display','none');
			$('#visibilidadtalla').css('display','none');
			$('#visibilidadtalla2').css('display','none');

			$('#imagenesventa').css('display','block');
			$('#visibilidadtallaInput').css('display','block');

		}

		else

		{

			$('#visibilidadproducto').css('display','block');
			$('#visibilidadtalla').css('display','block');
			$('#visibilidadtalla2').css('display','none');
			$('#imagenesventa').css('display','none');
			$('#visibilidadtallaInput').css('display','none');

		}

	}

	else

	if(o=="TIPOVENTAEDIT")

	{

		if(id == "WHATSAPP")

		{

			$('#visibilidadproducto1').css('display','none');

			$('#imagenesventa1').css('display','block');

		}

		else

		{

			$('#visibilidadproducto1').css('display','block');

			$('#imagenesventa1').css('display','none');

		}

	}

	else

	if(o=="APROBAR")

	{

		swal({

			title: 'Estas seguro de APROBAR esta venta?',

			text: "¡No podrás revertir esto!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, Aprobar!',

			cancelButtonText: 'No, Cancelar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/ventas/fnVentas.php', {opcion:o,idv:id}, function(data) {

					if(data == 1)

					{

						ok("Venta aprobada!");

						var table = $('#tbventas').DataTable();

						table.draw('full-hold');

					}

					else

					if(data == 0)

					{

						error("Ocurrio un error al intentar APROBAR, Verificar.");

					}

					else

					if(data == 2)

					{

						error("Esta venta ya fue aprobada anteriormente, Verificar.");

					}

					else

					if(data == 3)

					{

						error("Esta venta ya fue rechazada anteriormente, Verificar.");

					}

				});

			}

		});

	}

	else

	if(o=="RECHAZAR")

	{

		swal({

			title: 'Estas seguro de RECHAZAR esta venta?',

			text: "¡No podrás revertir esto!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, Rechazar!',

			cancelButtonText: 'No, Cancelar!'

		}).then(function (result) {

			if (result.value) {

				var motivoRechazo = prompt("Describa el motivo del rechazo");

				if(motivoRechazo.length < 10)

				{

					error("Debe indicar el motivo de rechazo, al menos 10 caracteres");

				}

				else

				{

					$.post('funciones/ventas/fnVentas.php', {opcion:o,idv:id,mtr:motivoRechazo}, function(data) {

						if(data == 1)

						{

							ok("Venta Rechazada!");

							var table = $('#tbventas').DataTable();

							table.draw('full-hold');

						}

						else

						if(data == 2)

						{

							error("Esta venta ya fue aprobada anteriormente, Verificar.");

						}

						else

						if(data == 3)

						{

							error("Esta venta ya fue rechazada anteriormente, Verificar.");

						}

						else

						{

							error("Ocurrio un error al intentar RECHAZAR, Verificar.");

						}

					});

				}

			}

		});

	}

	else

	if(o=="ELIMINAR")

	{

		swal({

			title: 'Estas seguro de ELIMINAR esta venta?',

			text: "¡No podrás revertir esto!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, Eliminar!',

			cancelButtonText: 'No, Cancelar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/ventas/fnVentas.php', {opcion:o,idv:id}, function(data) {

					if(data == 1)

					{

						ok("Venta eliminada!");

						var table = $('#tbventas').DataTable();

						table.draw('full-hold');

					}

					else

					if(data == 2)

					{

						error("Esta venta ya fue aprobada anteriormente, Verificar.");

					}

					else

					if(data == 3)

					{

						error("Esta venta ya fue rechazada anteriormente, Verificar.");

					}

					else

					{

						error("Ocurrio un error al intentar eliminar, Verificar");

					}

				});

			}

		});

	}

	else

	if(o=="EDITAR")

	{

		$('#titlemodal').html("Edición Venta");

		$('#btnguardar').attr('onclick',"CRUDVENTAS('GUARDAREDICION','"+id+"','','')");

		$.post('funciones/ventas/fnVentas.php', {opcion:o,id:id}, function(data, textStatus, xhr) {

			$('#contenidomodal').html(data);

		});

	}

	else

	if(o=="GUARDAREDICION")

	{

		var txtnom = $('#txtnombre1').val();

		var txttel = $('#txttelefono1').val();

		var txtdir = $('#txtdireccion1').val();

		var txtfec = $('#txtfechaventa1').val();

		var selproduc = $('#selproductoventa1').val();

		var txtcant = $('#txtcantidad1').val();

		var txtval = $('#txtvrunidad1').val();

		var seltipoventa = $('#seltipoventa1').val();

		var rutpro = $('#rutaimgproducto').text();

		var rutconv = $('#rutaimgconversacion').text();



		txtval = txtval.replace("$", "");

		txtval = txtval.replace(",", "").replace(",", "");

		txtval = txtval.replace(",", "").replace(",", "");



		if(txtnom=="" || txtnom==null)

		{

			error("Ingrese el nombre del cliente");

			$('#txtnombre1').focus();

		}

		else

		if(txttel=="" || txttel==null)

		{

			error("Ingrese el teléfono del cliente");

			$('#txttelefono1').focus();

		}

		else

		if(txtdir=="" || txtdir==null)

		{

			error("Ingrese la dirección del cliente");

			$('#txtdireccion1').focus();

		}

		else

		if(txtfec=="" || txtfec==null)

		{

			error("Seleccione la fecha de la entrada");

			$('#txtfechaventa1').focus();

		}

		else

		if(selproduc=="" && seltipoventa == "CARRITO")

		{

			error("Seleccione el producto");

			$('#selproductoventa1').focus();

		}

		else

		if((rutpro=="" || rutconv=="") && seltipoventa == "WHATSAPP")

		{

			error("Adjuente el producto y la conversación de la Venta");

		}

		else

		if(txtcant=="" || txtcant==0 || txtcant <= 0)

		{

			error("Ingrese la cantidad vendida");

			$('#txtcantidad1').focus();

		}

		else

		if(txtval=="" || txtval==0 || txtval <= 0)

		{

			error("Ingrese el valor del producto");

			$('#txtvrunidad1').focus();

		}

		else

		{

			$.post('funciones/ventas/fnVentas.php', {opcion:o,txtnom:txtnom,txttel:txttel,txtdir:txtdir,txtfec:txtfec,selproduc:selproduc,txtcant:txtcant,txtval:txtval,seltipoventa:seltipoventa,rutpro:rutpro,rutconv:rutconv,idv:id}, function(data) {

				if(data>0)

				{

					ok("Venta Actualizada!");

					var table = $('#tbventas').DataTable();

					table.draw('full-hold');

				}

				else

				{

					error("Ocurrio un error, intentelo de nuevo, Verificar");

				}

			});

		}

	}

}

function CRUDCOBROS(o,id)

{

	if(o=="LISTACOBROS")

	{

		$('#table-responsive').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/cobrar/fnCobros.php',{opcion:o},

		function(data)

		{

			$('#table-responsive').html(data);

		});

	}

	else

	if(o=="SOLICITARCOBRO")

	{

		var monto = $('#monto').val();

		var cedula = $('#cedula').val();

		var celular = $('#celular').val();

		var cuentabancaria = $('#cuentabancaria').val();

		var metodo = $('#metodo').val();

		var clave = $('#clave').val();



		monto = monto.replace("$", "");

		monto = monto.replace(",", "").replace(",", "");

		monto = monto.replace(",", "").replace(",", "");



		if(monto == "" || monto == " " || monto <= 0) {

			$('#err-monto').show(500);$('#err-monto').delay(4000);

			$('#err-monto').animate({ height: 'toggle' }, 500, function () {  });

			alertify.error("Ingrese el monto.");

			error = true; // change the error state to true

		}

		else

		if(cedula == "" || cedula == " ") {

			$('#err-cedula').show(500);$('#err-cedula').delay(4000);

			$('#err-cedula').animate({ height: 'toggle' }, 500, function () {  });

			alertify.error("Ingrese el número de su cédula.");

			error = true; // change the error state to true

		}

		else

		if(celular == "" || celular == " ") {

			$('#err-celular').show(500);$('#err-celular').delay(4000);

			$('#err-celular').animate({ height: 'toggle' }, 500, function () {  });

			alertify.error("Ingrese el número de su celular.");

			error = true; // change the error state to true

		}

		else

		if(cuentabancaria == "" || cuentabancaria == " ") {

			$('#err-cuentabancaria').show(500);$('#err-cuentabancaria').delay(4000);

			$('#err-cuentabancaria').animate({ height: 'toggle' }, 500, function () {  });

			alertify.error("Ingrese el número de su cuenta bancaria.");

			error = true; // change the error state to true

		}

		else

		if(metodo == "" || metodo == " ") {

			$('#err-metodo').show(500);$('#err-metodo').delay(4000);

			$('#err-metodo').animate({ height: 'toggle' }, 500, function () {  });

			alertify.error("Elija el metodo de pago.");

			error = true; // change the error state to true

		}

		else

		if(clave == "" || clave == " ") {

			$('#err-clave').show(500);$('#err-clave').delay(4000);

			$('#err-clave').animate({ height: 'toggle' }, 500, function () {  });

			alertify.error("Ingrese la clave de confirmación.");

			error = true; // change the error state to true

		}

		else

		{

			$('#progress').show(500);

			$("#buttonsolicitarcobro").attr('disabled','disabled');

			$.post('funciones/cobrar/fnCobros.php', {opcion:o,monto:monto,cedula:cedula,celular:celular,cuentabancaria:cuentabancaria,metodo:metodo,clave:clave}, function(data) {

				//alert(data);

				if(data.length > 5)

				{

					error(data);

				}

				else

				if(data == 1)

				{

					ok("Cobro realizado!");

					$('#monto').val('');

					$('#cedula').val('');

					$('#cuentabancaria').val('');

					$('#txtfechaventa').val('');

					$('#metodo>option[value=""]').attr('selected', 'selected');

					$('#clave').val('');

					var table = $('#tbcobros').DataTable();

					table.draw('full-hold');

				}

				var table = $('#tbcobros').DataTable();

				table.draw('full-hold');

				$('#progress').delay(0);

				$('#progress').animate({

					height: 'toggle'

				}, 2000, function () {

					// Animation complete.

					//location.reload();

					CRUDCOBROS('COBROS');

				});

				$("#buttonsolicitarcobro").removeAttr('disabled');

			});

		}

	}

	else

	if(o=="ELIMINAR")

	{

		swal({

			title: 'Estas seguro de ELIMINAR esta venta?',

			text: "¡No podrás revertir esto!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, Eliminar!',

			cancelButtonText: 'No, Cancelar!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/ventas/fnVentas.php', {opcion:o,idv:id}, function(data) {

					if(data == 1)

					{

						ok("Venta eliminada!");

						var table = $('#tbventas').DataTable();

						table.draw('full-hold');

					}

					else

					if(data == 2)

					{

						error("Esta venta ya fue aprobada anteriormente, Verificar.");

					}

					else

					if(data == 3)

					{

						error("Esta venta ya fue rechazada anteriormente, Verificar.");

					}

					else

					{

						error("Ocurrio un error al intentar eliminar, Verificar");

					}

				});

			}

		});

	}

	else

	if(o=="EDITAR")

	{

		$('#titlemodal').html("Edición Venta");

		$('#btnguardar').attr('onclick',"CRUDVENTAS('GUARDAREDICION','"+id+"','','')");

		$.post('funciones/ventas/fnVentas.php', {opcion:o,id:id}, function(data, textStatus, xhr) {

			$('#contenidomodal').html(data);

		});

	}

	else

	if(o=="GUARDAREDICION")

	{

		var txtnom = $('#txtnombre1').val();

		var txttel = $('#txttelefono1').val();

		var txtdir = $('#txtdireccion1').val();

		var txtfec = $('#txtfechaventa1').val();

		var selproduc = $('#selproductoventa1').val();

		var txtcant = $('#txtcantidad1').val();

		var txtval = $('#txtvrunidad1').val();

		var seltipoventa = $('#seltipoventa1').val();

		var rutpro = $('#rutaimgproducto').text();

		var rutconv = $('#rutaimgconversacion').text();



		txtval = txtval.replace("$", "");

		txtval = txtval.replace(",", "").replace(",", "");

		txtval = txtval.replace(",", "").replace(",", "");



		if(txtnom=="" || txtnom==null)

		{

			error("Ingrese el nombre del cliente");

			$('#txtnombre1').focus();

		}

		else

		if(txttel=="" || txttel==null)

		{

			error("Ingrese el teléfono del cliente");

			$('#txttelefono1').focus();

		}

		else

		if(txtdir=="" || txtdir==null)

		{

			error("Ingrese la dirección del cliente");

			$('#txtdireccion1').focus();

		}

		else

		if(txtfec=="" || txtfec==null)

		{

			error("Seleccione la fecha de la entrada");

			$('#txtfechaventa1').focus();

		}

		else

		if(selproduc=="" && seltipoventa == "CARRITO")

		{

			error("Seleccione el producto");

			$('#selproductoventa1').focus();

		}

		else

		if((rutpro=="" || rutconv=="") && seltipoventa == "WHATSAPP")

		{

			error("Adjuente el producto y la conversación de la Venta");

		}

		else

		if(txtcant=="" || txtcant==0 || txtcant <= 0)

		{

			error("Ingrese la cantidad vendida");

			$('#txtcantidad1').focus();

		}

		else

		if(txtval=="" || txtval==0 || txtval <= 0)

		{

			error("Ingrese el valor del producto");

			$('#txtvrunidad1').focus();

		}

		else

		{

			$.post('funciones/ventas/fnVentas.php', {opcion:o,txtnom:txtnom,txttel:txttel,txtdir:txtdir,txtfec:txtfec,selproduc:selproduc,txtcant:txtcant,txtval:txtval,seltipoventa:seltipoventa,rutpro:rutpro,rutconv:rutconv,idv:id}, function(data) {

				if(data>0)

				{

					ok("Venta Actualizada!");

					var table = $('#tbventas').DataTable();

					table.draw('full-hold');

				}

				else

				{

					error("Ocurrio un error, intentelo de nuevo, Verificar");

				}

			});

		}

	}

}

function CRUDINVENTARIO(o,id)

{

	if(o=="LISTAINVENTARIO")

	{

		$('#divinventario').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/inventario/fnInventario.php',{opcion:o},

		function(data)

		{		

			$('#divinventario').html(data);

		});

	}

	else if(o=="LISTAENTRADAS")

	{

		$('#diventradas').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/inventario/fnInventario.php',{opcion:o},

		function(data)

		{		

			$('#diventradas').html(data);

		});

	}

	else if(o=="LISTASALIDAS")

	{

		$('#divsalidas').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/inventario/fnInventario.php',{opcion:o},

		function(data)

		{		

			$('#divsalidas').html(data);

		});

	}

	else if(o=="GUARDARENTRADA")

	{

		var fecent = $('#txtfechaentrada').val();

		var idproducto = $('#selproductoentrada').val();

		var tipent = $('#seltipoentrada').val();

		var cantent = $('#txtcantentrada').val();

		var pesoent = $('#txtpesoentrada').val(); 

		var valent = $('#txtvalentrada').val();

		var provent = $('#selproveedor').val();

		var pesund = $('#txtpesunidad').val();



		valent = valent.replace("$", "");

		valent = valent.replace(",", "").replace(",", "");

		valent = valent.replace(",", "").replace(",", "");



		var calent = $('#selcalidad').val();



		var med = $('#selmedida').val();



		var uni = $("#selproductoentrada option:selected").attr('data-unidad');

		var pes = $("#selproductoentrada option:selected").attr('data-peso');

		var muni = $("#selproductoentrada option:selected").attr('data-min-unidad');

		var mpes = $("#selproductoentrada option:selected").attr('data-min-peso');





		if(idproducto=="")

		{

			error("Seleccionar el producto");

		}

		else

		if(provent=="")

		{

			error("Seleccionar el proveedor");

		}

		else

		if(fecent=="" || fecent==null)

		{

			error("Seleccionar la fecha de la entrada");

		}

		else if(tipent=="" || tipent==null)

		{

			error("Seleccionar el tipo de entrada");

		}

		else if(calent=="" || calent==null)

		{

			error("Seleccionar la calidad del producto");

		}

		//VALIDAR SEGUN TIPO DE ENTRADA

		else

		if(uni==1 && pes==1 && cantent>0 && (pesoent<=0 || pesoent==undefined))

		{

			error("Diligenciar el peso equivalente a la cantidad ingresada");

			$('#txtpesoentrada').focus();

		}

		else

		if(uni==1 && pes==1 && pesoent>0 && (cantent<=0 || cantent==undefined))

		{

			error("Diligenciar el cantidad equivalente al peso ingresado");

			$('#txtcantentrada').focus();

		}

		else if(uni==1 && cantent<=0)

		{

			error("La cantidad de entrada debe ser mayor a cero");

			$('#txtcantentrada').focus();

		}		

		else if(pes==1 && pesoent<=0)

		{

			error("El peso total de entrada debe ser mayor a cero");

			$('#txtpesoentrada').focus();

		}

		else if(pes==1 && pesund<=0)

		{

			error("El peso por unidad debe ser mayor a cero");

			$('#txtpesunidad').focus();

		}

		else if(uni==1 && parseInt(cantent)<parseInt(muni)  && med=="0")

		{

			error("La cantidad de entrada debe ser mayor o igual a: " + muni);

			$('#txtcantentrada').focus();

		}

		else if(pes==1 && parseInt(pesoent)<parseInt(mpes) && med=="1")

		{

			console.log(pesoent);

			error("El peso de entrada debe ser mayor o igual a: " + mpes);

			$('#txtpesoentrada').focus();

		}

		else if(valent<=0)

		{ 

			error("El valor por unidad debe ser mayor a cero");

			$('#txtvalentrada').focus();

		}

		else

		{

			$.post('funciones/inventario/fnInventario.php', {opcion:o,idproducto:idproducto,fecent:fecent,tipent:tipent,cantent:cantent,valent:valent,provent:provent,pesoent:pesoent,med:med,calent:calent,pesund:pesund,pes:pes,uni:uni}, function(data, textStatus, xhr) {

				/*optional stuff to do after success */

				var res = data[0].res;

				var msn = data[0].msn;

				if(res=="ok")

				{

					ok(msn);

					console.log(msn);

					$('#txtcantentrada').val('');

					$('#txtvalentrada').val('');

					$('#txtpesoentrada').val('');

					$('#txtpesunidad').val(''); 

					$('#selproductoentrada>option[value=""]').attr('selected', 'selected');

					$('#selproductoentrada').selectpicker('refresh');

					var table = $('#tbentradas').DataTable();

					table.draw('full-hold');

					setTimeout(CALCULARCANTIDAD(),1000);

				}

				else

				{

					error(msn);

				}

			},"json");

		}

	}

	else if(o=="GUARDARSALIDA")

	{

		var fecsal = $('#txtfechasalida').val();

		var idproducto = $('#selproductosalida').val();

		var tipsal = $('#seltiposalida').val();

		var cansal = $('#txtcantsalida').val();

		var calsal = $('#selcalidadsalida').val();

		var pesosal = $('#txtpesosalida').val();





		var uni = $("#selproductosalida option:selected").attr('data-unidad');

		var pes = $("#selproductosalida option:selected").attr('data-peso');

		var muni = $("#selproductosalida option:selected").attr('data-min-unidad');

		var mpes = $("#selproductosalida option:selected").attr('data-min-peso');

		

		if(idproducto=="")

		{

			error("Seleccionar el producto");

		}

		else

		if(fecsal=="" || fecsal==null)

		{

			error("Seleccionar la fecha de la salida");

		}

		else if(tipsal=="" || tipsal==null)

		{

			error("Seleccionar el motivo de salida");

		}

		else if(calsal=="" || calsal==null)

		{

			error("Seleccionar la calidad de salida");

		}



		else

		if(uni==1 && pes==1 && cansal>0 && (pesosal<=0 || pesosal==undefined))

		{

			error("Diligenciar el peso equivalente a la cantidad ingresada");

			$('#txtpesosalida').focus();

		}

		else

		if(uni==1 && pes==1 && pesosal>0 && (cansal<=0 || cansal==undefined))

		{

			error("Diligenciar el cantidad equivalente al peso ingresado");

			$('#txtcantentrada').focus();

		}

		else if(uni==1 && cansal<=0)

		{

			error("La cantidad de salida debe ser mayor a cero");

			$('#txtcantentrada').focus();

		}		

		else if(pes==1 && pesoent<=0)

		{

			error("El peso de salida debe ser mayor a cero");

			$('#txtpesoentrada').focus();

		}

		else if(uni==1 && cansal<muni  && med=="0")

		{

			error("La cantidad de salida debe ser mayor o igual a: " + muni);

		}

		else if(pes==1 && pesosal<mpes && med=="1")

		{

			error("La peso de salida debe ser mayor o igual a: " + mpes);

		}





/*

		else if(cansal<=0 || cansal==null)

		{

			error("La cantidad de salida debe ser mayor a cero");

		}		*/

		else

		{

			$.post('funciones/inventario/fnInventario.php', {opcion:o,idproducto:idproducto,fecsal:fecsal,tipsal:tipsal,cansal:cansal,calsal:calsal,pesosal:pesosal}, function(data, textStatus, xhr) {

				/*optional stuff to do after success */

				var res = data[0].res;

				var msn = data[0].msn;

				if(res=="ok")

				{

					ok(msn);

					$('#txtcantsalida').val('');	

					$('#txtpesosalida').val('');				

					$('#selproductosalida>option[value=""]').attr('selected', 'selected');

					$('#selproductosalida').selectpicker('refresh');

					var table = $('#tbsalidas').DataTable();

					table.draw('full-hold');

				}

				else

				{

					error(msn);

				}

			},"json");

		}

	}

	else if(o=="VALIDARMOTIVO")

	{

		var mot = $('#seltiposalida').val();

		if(mot=="otro")

		{

			$('#modalright').modal('show');

			$('#titleright').html('Registro Motivo Salida');

			$.post('funciones/inventario/fnInventario.php', {opcion: 'NUEVOMOTIVOSALIDA'}, function(data, textStatus, xhr) {

				$('#contenidomodalright').html(data);

			});

		}

		else

		{

			return false;

		}

	}

	else if(o=="GUARDARMOTIVOSALIDA")

	{

		var mot = $('#txtmotivo').val();

		if(mot=="" || mot==null)

		{

			error("Diligenciar el motivo de salida");

		}

		else

		{

			$.post('funciones/inventario/fnInventario.php', {opcion:o,mot:mot}, function(data, textStatus, xhr) {

				var res = data[0].res;

				var msn = data[0].msn;

				var idm = data[0].idm;

				if(res=="ok")

				{

					$('#modalright').modal('hide');

					ok(msn);

					setTimeout(CRUDINVENTARIO('CARGARMOTIVOS',idm),1000);

				}

				else

				{

					error(msn);

				}

				/*optional stuff to do after success */

			},"json");

		}

	}

	else if(o=="CARGARMOTIVOS")

	{

		var sel1 = $('#seltiposalida');

		sel1.find('option').remove().end().append('<option value="">Cargando...</option>').val('');  	



	  	$.post('funciones/inventario/fnInventario.php',{opcion:o,id:id},

		function(data)

		{

			sel1.empty();			

			sel1.append('<option value="otro">otro</option>');

			var res = data[0].res;

			if(res=="no")

			{

				sel1.selectpicker('refresh');

			}

		    else

		    {        

		        for (var i=0; i<data.length; i++)

		        {

		        	if(id==data[i].id)

		        	{

		        		sel1.append('<option selected value="' + data[i].id + '">' + data[i].literal + '</option>');

		        	}

		        	else

		        	{

		        		sel1.append('<option value="' + data[i].id + '">' + data[i].literal + '</option>');

		        	}

		        }

	       		 setTimeout(function(){

	        	sel1.selectpicker('refresh');

	        	},1000);

			}

		},"json");

	}

	else if(o=="VALIDARUNIDAD")

	{

		var uni = $("#selproductoentrada option:selected").attr('data-unidad');

		var pes = $("#selproductoentrada option:selected").attr('data-peso');

		var muni = $("#selproductoentrada option:selected").attr('data-min-unidad');

		var mpes = $("#selproductoentrada option:selected").attr('data-min-peso');

		if(uni==1)

		{

			$('#divcantentrada').show();

			$('#txtcantentrada').val(muni).attr('min', muni);

		}

		else

		{

			$('#divcantentrada').hide();

			$('#txtcantentrada').val(0);

		}



		if(pes==1)

		{

			$('#divpesoentrada').show();

			$('#divpesounidad').show();

			$('#divmedidaentrada').show();

			$('#divtotalunidad').show();

			$('#txtpesoentrada').val(mpes).attr('min', mpes);

			$('#selmedida>option[value="0"]').attr('disabled', 'disabled');

			$('#selmedida>option[value="1"]').attr('selected', 'selected');

		}

		else

		{

			$('#divpesoentrada').hide();

			$('#divpesounidad').hide();

			$('#divtotalunidad').hide();

			$('#txtpesoentrada').val(0);

			$('#selmedida>option[value="0"]').attr('selected', 'selected');

			$('#divmedidaentrada').hide();

		}

		setTimeout(function(){

		        	$('#selmedida').selectpicker('refresh');

		        },1000);

		//cargar proveedor

		setTimeout(CRUDINVENTARIO('CARGARCALIDAD',''),1000);



		

	}

	

	else if(o=="CARGARCALIDAD")

	{

		var sel2  = $('#selproductoentrada').val();

	  	var sel1 = $('#selcalidad');

	  	sel1.find('option').remove().end().append('<option value="">Cargando...</option>').val('');  	



	  	$.post('funciones/inventario/fnInventario.php',{opcion:o,idproducto:sel2},

		function(data)

		{

			sel1.empty();

			sel1.append('<option value="">--seleccione--</option>');

			var res = data[0].res;

			if(res=="no")

			{

				setTimeout(function(){

		        	sel1.selectpicker('refresh');

		        },1000);

		         setTimeout(CRUDINVENTARIO('CARGARPROVEEDOR',''),1000);

			}

		    else

		    {        

		        for (var i=0; i<data.length; i++)

		        {

		        	if(i==0 && data.length==1)

		        	{

		        		sel1.append('<option selected  value="' + data[i].id + '">' + data[i].literal + '</option>');

		        	}

		        	else

		        	{

		        		sel1.append('<option  value="' + data[i].id + '">' + data[i].literal + '</option>');

		        	}

		        }

		        setTimeout(function(){

		        	sel1.selectpicker('refresh');

		        },1000);

		        setTimeout(CRUDINVENTARIO('CARGARPROVEEDOR',''),1000);

			}

		},"json");

	}

	else if(o=="CARGARPROVEEDOR")

	{

		var sel2  = $('#selproductoentrada').val();

		var sel3  = $('#selcalidad').val();

	  	var sel1 = $('#selproveedor');

	  	sel1.find('option').remove().end().append('<option value="">Cargando...</option>').val('');  	



	  	$.post('funciones/inventario/fnInventario.php',{opcion:o,idproducto:sel2,idcalidad:sel3},

		function(data)

		{

			sel1.empty();

			sel1.append('<option value="">--seleccione--</option>');

			var res = data[0].res;

			if(res=="no")

			{

				setTimeout(function(){

		        	sel1.selectpicker('refresh');

		        },1000);

		         setTimeout(function(){

		        	CALCULARCANTIDAD();

		        },1000);

			}

		    else

		    {        

		        for (var i=0; i<data.length; i++)

		        {

		        	if(i==0 && data.length==1)

		        	{

		        		sel1.append('<option selected data-subtext="'+data[i].valor+'" value="' + data[i].id + '">' + data[i].literal + '</option>');

		        	}

		        	else

		        	{

		        	sel1.append('<option data-subtext="'+data[i].valor+'" value="' + data[i].id + '">' + data[i].literal + '</option>');

		        	}

		        }

		        setTimeout(function(){

		        	sel1.selectpicker('refresh');

		        },1000);



		         setTimeout(function(){

		        	CALCULARCANTIDAD();

		        },1000);

			}

		},"json");

	}

	else if(o=="VALIDARUNIDAD2")

	{

		var uni = $("#selproductosalida option:selected").attr('data-unidad');

		var pes = $("#selproductosalida option:selected").attr('data-peso');

		var muni = $("#selproductosalida option:selected").attr('data-min-unidad');

		var mpes = $("#selproductosalida option:selected").attr('data-min-peso');

		if(uni==1)

		{

			$('#divcantsalida').show();

			$('#txtcantsalida').val(muni).attr('min', muni);

		}

		else

		{

			$('#divcantesalida').hide();

			$('#txtcantsalida').val(0);

		}



		if(pes==1)

		{

			$('#divpesosalida').show();

			$('#txtpesosalida').val(mpes).attr('min',mpes);

		}

		else

		{

			$('#divpesosalida').hide();

			$('#txtpesosalida').val(0);

		}

	}

}





function CALCULARCANTIDAD()

{

	var pes = $('#txtpesoentrada').val(); if(pes=="" || pes==null){ pes = 0; }

	var med = $('#selmedida').val();

	var pesu = $('#txtpesunidad').val(); if(pesu=="" || pesu==null){ pesu = 0; }

	var spanu = $('#spanunidades');

	var totu = 0;

	if(pesu>0)

	{

		if(med==1)

		{			

			totu = pes/pesu;			

		}

		else if(med==2)

		{

			totu = (pes*1000)/pesu;

		}

	}

	spanu.html(totu);



}

function CRUDPEDIDOS(o,id,idc)

{

	//$('#btnenviar').hide();

	if(o=="CONTADORPEDIDOS")

	{

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#diventregados').html(data[0].entregados);

			$('#divproceso').html(data[0].proceso);

			$('#numpro').html(data[0].proceso).attr("data-original-title","Tienes "+data[0].pendientes+" pedidos en proceso de entrega");			

			$('#divpendientes').html(data[0].pendientes);

			$('#numped').html(data[0].pendientes).attr("data-original-title","Tienes "+data[0].pendientes+" pedidos pendientes por despachar");

			$('#divcancelados').html(data[0].cancelados);

		},"json");

	}

	else

	if(o=="LISTAPRODUCTOS")

	{

		//var bus = $('#busquedageneral').val();

		var nom = $('#busnombre').val();

		var mar = $('#busmarca').val();

		var cat = $('#buscategoria').val();

		var cod = $('#buscodigo').val();		

		//var uni = $('#busunidad').val();

		var pro = $('#bustxtproducto').val();// $('#busproductopedido').val();

		var idc = $('#idcategoria').val();

		var idtienda = $('#idtienda').val();



		var selcla = $('#selcla').val(); 

		$('#tabladatos').html("");

		$.post('funciones/pedidos/fnPedidos.php',{opcion:o,nom:nom,cod:cod,mar:mar,cat:cat,pro:pro,idc:idc,selcla:selcla,idtienda:idtienda},function(data){//,uni:uni

			$('#tabladatos').html(data);

			$('#bustxtproducto').val('');

		})

	}

	else if(o=="NUEVADIRECCION" || o=="NUEVADIRECCION2")

	{

		var div = "";

		if(o=="NUEVADIRECCION"){

			div = $('#acount');

		}

		else

		{

			div = $('#contenidomodalright');

			//$('#modalright').modal('show');

			$('#titleright').html('Mis Direcciones')

		}

		

		$.post('funciones/pedidos/fnPedidos.php',{opcion:o,idp:id},function(data){

			div.html(data);

		})

	}

	else if(o=="EDITARDIRECCION" || o=="EDITARDIRECCION2")

	{	

		var div = "";

		if(o=="EDITARDIRECCION"){

			div = $('#acount');

		}

		else

		{

			div = $('#contenidomodalright');

			$('#titleright').html("<a data-toggle='tooltip' title='Volver' onclick=CRUDPEDIDOS('NUEVADIRECCION2','')><i class='fa fa-angle-left fa-2x' aria-hidden='true'></i></a>Editar Dirección")

		

		}	

		$.post('funciones/pedidos/fnPedidos.php',{opcion:o,id:id},function(data){

			div.html(data);

		})

	}

	else if(o=="GUARDARDIRECCION" || o=="GUARDARDIRECCION2")

	{

		var bar = $('#selbarrio').val();

		var des = $('#txtdescripcion').val();

		var det = $('#txtdetalle').val().replace(new RegExp("\n","g"), "<br>");

		var nome = $('#selcalle').val();

		var let = $('#txtletdir').val();

		var num1 = $('#txtnumdir1').val();

		var num2 = $('#txtnumdir2').val();

		var tip = $("input:radio[name=radtipodireccion]:checked").val();

		var ico = $("input:radio[name=radtipodireccion]:checked").attr('data-icon');

		var lon = $('#longitud').val();

		var lat = $('#latitud').val();

		var ubi = $('#leaflet-control-geosearch-qry').val();

		var ubicorta = $('#geoubicacion').val();

		if(bar=="")

		{

			error("Seleccionar el barrio de tu ubicación");

		}

		else if(det=="")

		{

			error("Diligenciar el detalle de tu dirección");

		}

		/*else

		if(nome=="")

		{

			error("Seleccionar la nomenclatura de la dirección");

		}		

		else if(num1=="" || num2=="")

		{

			error("Completa la información de la dirección");

		}*/

		else if(lon=="" || lat=="")

		{

			error("Establecer una ubicacion validad en el mapa");

		}

		else

		{

			$.post('funciones/pedidos/fnPedidos.php', {opcion:o,bar:bar,des:des,det:det,nome:nome,let:let,num1:num1,num2:num2,tip:tip,ico:ico,lon:lon,lat:lat,ubi:ubi,ubicorta:ubicorta}, function(data) {

				/*optional stuff to do after success */

				var res = data[0].res;

				var msn = data[0].msn;

				var iddir = data[0].iddir;

				if(res=="ok")

				{

					

					$('.sc-cart-envio').html("$" + data[0].domicilio);

					ok(msn);

					if(o=="GUARDARDIRECCION")

					{

						setTimeout(CRUDPEDIDOS('NUEVADIRECCION','',''),1000);

					}

					else

					{

						$('#modalright').modal('hide');

						setTimeout(CRUDPEDIDOS('LISTADIRECCIONES','',''),1000);

					}

					setTimeout(CRUDPEDIDOS('ACTUALIZARDIRECCION2',iddir,''),1000);

					setTimeout(CRUDPEDIDOS('UPDATEDIRECCIONES','',''),2000);

				}

				else

				{

					error(msn);

				}

			},"json");

		}

	}

	else if(o=="GUARDAREDITARDIRECCION" || o=="GUARDAREDITARDIRECCION2")

	{

		var bar = $('#selbarrio').val();

		var des = $('#txtdescripcion').val();

		var det = $('#txtdetalle').val().replace(new RegExp("\n","g"), "<br>");

		var nome = $('#selcalle').val();

		var let = $('#txtletdir').val();

		var num1 = $('#txtnumdir1').val();

		var num2 = $('#txtnumdir2').val();

		var tip = $("input:radio[name=radtipodireccion]:checked").val();

		var ico = $("input:radio[name=radtipodireccion]:checked").attr('data-icon');

		var lon = $('#longitud').val();

		var lat = $('#latitud').val();

		var ubi = $('#leaflet-control-geosearch-qry').val();

		var ubicorta = $('#geoubicacion').val();

		var dirsel = $('input:radio[name=dirpedido2]:checked').val();



		if(bar=="")

		{

			error("Seleccionar el barrio de tu ubicación");

		}

		else if(det=="")

		{

			error("Diligenciar el detalle de tu dirección");

		}



		/*else

		if(nome=="")

		{

			error("Seleccionar la nomenclatura de la dirección");

		}		

		else if(num1=="" || num2=="")

		{

			error("Completa la información de la dirección");

		}*/

		else if(lon=="" || lat=="")

		{

			error("Establecer una ubicacion validad en el mapa");

		}

		else

		{

			$.post('funciones/pedidos/fnPedidos.php', {opcion:o,bar:bar,des:des,det:det,nome:nome,let:let,num1:num1,num2:num2,tip:tip,ico:ico,id:id,lon:lon,lat:lat,ubi:ubi,ubicorta:ubicorta}, function(data) {

				/*optional stuff to do after success */

				var res = data[0].res;

				var msn = data[0].msn;

				var iddir = data[0].iddir;

				if(res=="ok")

				{					

					//$('.sc-cart-envio').html("$" + data[0].domicilio);

					ok(msn);

					if(o=="GUARDAREDITARDIRECCION")

					{

						setTimeout(CRUDPEDIDOS('NUEVADIRECCION',iddir),1000);

					}

					else

					{

						setTimeout(CRUDPEDIDOS('NUEVADIRECCION2',''),1000);

						setTimeout(CRUDPEDIDOS('LISTADIRECCIONES',''),1000);

					}



					setTimeout(CRUDPEDIDOS('ACTUALIZARDIRECCION2',dirsel,''),1000);

					setTimeout(CRUDPEDIDOS('UPDATEDIRECCIONES','',''),2000);

					

				}

				else

				{

					error(msn);

				}

			},"json");

		}

	}

	else if(o=="CAMBIARPRECIO")

	{

		

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,idp:id,cla:idc}, function(data) {

			/*optional stuff to do after success */

			var ven = data[0].venta;

			var pesounidad = data[0].pesounidad;

			$('#precio_'+ id).html(ven);

			$('#product_price_'+ id).val(ven);	

			$('#product_quantity4_' + id).attr( 'data-peso-unidad',pesounidad); 			

			$('.currency2').formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

			var esti = ($('#product_quantity4_' + id).val() * pesounidad ) /1000;

			$('#estiinfo_' + id).html(esti+"kg");

			//setTimeout(IncDec('plusminus3 '),1000);

		},"json");

	}

	else if(o=="ACTUALIZARDIRECCION")

	{

		var dir = $('#dirpedido').val();

		var tel = $('#txttelefonoenvio').val();

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,dir:dir,tel:tel}, function(data) {

			/*optional stuff to do after success */

			var res = data[0].res;

			var msn = data[0].msn;

			var direccion = data[0].direccion;

			if(res=="error")

			{

				error(msn);

			}	

			else

			{

				$('.sc-cart-envio').html("$" + data[0].domicilio);

				$('#dirseleccionada').html(direccion).attr('title',direccion);

			}

		},"json");

	}

	else if(o=="ACTUALIZARDIRECCION2")

	{

		

		$('input:radio[name=dirpedido2]').each(function(index, el) {

			 index=$(this).index();

			 var idi = $(this).attr('data-id');

			 $(this).prop('checked', false);

			 $('#iop' + idi).removeClass('fa-dot-circle-o').addClass('fa-circle-o');	

		});

		$('#dirpedidord' + id).prop('checked', true);



		$('ul#divlistadireccionesguardadas').children('li').css('backgroundColor','');

		$('#lidir' + id).css('backgroundColor','antiquewhite');

		$('#iop' + id).addClass('fa-dot-circle-o');



		//console.log("Prueba");

		var dir = id;// $('input:radio[name=dirpedido2]:checked').val();

		var tel = "";// $('#txttelefonoenvio').val();

		$.post('funciones/pedidos/fnPedidos.php', {opcion: "ACTUALIZARDIRECCION",dir:dir,tel:tel}, function(data) {

			/*optional stuff to do after success */

			var res = data[0].res;

			var msn = data[0].msn;

			var direccion = data[0].direccion;

			if(res=="error")

			{

				error(msn);

			}	

			else

			{

				$('#dirseleccionada').html(direccion).attr('title',direccion);

				//$('.sc-cart-envio').html("$" + data[0].domicilio);



			}

		},"json");

	}

	else if(o=="UPDATEDIRECCIONES")

	{

		$('#divlistadireccionesguardadas').html('');

			$.post('funciones/pedidos/fnPedidos.php', {opcion: o}, function(data) {

			

				$('#divlistadireccionesguardadas').html(data);



			});

	}

	else if(o=="DETALLEPEDIDO")

	{

		var notapedido = localStorage.getItem('notapedido');

		var fecent = localStorage.getItem('fechaentrega');

		var horent = localStorage.getItem('horaentrega');

		var idt = $('#idtienda').val();

		$('#modalinfo').modal('hide');

		$('#titlepedido').html("Carrito de compras locomproaqui.com  <img class='img-cart' src='dist/img/car.png'><br><label style='font-size: smaller;font-style: italic'>Recuerda que pagas cuando recibes!<label>");

		$('#contenidomodalinfo').html("");

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,notapedido:notapedido,fecent:fecent,horent:horent,idt:idt}, function(data) {

			/*optional stuff to do after success */

			//$('#modalpedido').modal('show');

			$('#divdetallepedido').html(data);

		});

	}

	else if(o=="RESUMENPEDIDO")

	{

		var c = $('.sc-cart-count').text();

		var notapedido = localStorage.getItem('notapedido');

		var fecent = localStorage.getItem('fechaentrega');

		var horent = localStorage.getItem('horaentrega');

		if(parseInt(c)<=0 || c==null || c==undefined)

		{

			error("Tu carrito de compras esta vacio!");

		}

		else

		{

			$('#btnenviar').show();

			$('#btnenviar').attr('onclick',"CRUDPEDIDOS('HACERPEDIDO','"+id+"')");

			$('#btnenviar').text('Hacer pedido');

			$('#divdetallepedido').html("");

			$('#modalpedido').modal('hide');

			setTimeout(function(){

				$('#titleinfo').html("Tu Pedido")

				$.post('funciones/pedidos/fnPedidos.php',{opcion:o,nota:notapedido,fecent:fecent,horent:horent},function(data){

					$('#modalinfo').modal('show');

					$('#contenidomodalinfo').html(data);

				});

			},1000)

		}

	}

	else if(o=="VALFECENTREGA")

	{

		$('#ulhoraentrega').html("");

		var fecent = localStorage.getItem('fechaentrega');

		var horent = localStorage.getItem('horaentrega');

		$.post('funciones/pedidos/fnPedidos.php',{opcion:o,fecent:fecent,horent:horent},function(data){

			

			$('#ulhoraentrega').html(data);

		});



	}

	else if(o=="CANCELARPEDIDO")

	{

		var c = $('.sc-cart-count').text();		

		if(parseInt(c)<=0 || c==null || c==undefined)

		{

			error("Tu carrito de compras esta vacio!");

		}

		else

		{

			swal({

				title: 'Estas seguro de cancelar el pedido actual?',

				text: "¡No podrás revertir esto!",

				type: 'warning',

				showCancelButton: true,

				confirmButtonColor: '#3085d6',

				cancelButtonColor: '#d33',

				confirmButtonText: 'Si, cancelar!',

				cancelButtonText: 'No, cancelar!'

			}).then(function (result) {

				if (result.value) {

					$.post('funciones/pedidos/fnSolicitar.php', { opcion: o ,id:id}, function (dato) {

						var res = dato[0].res;

						var msn = dato[0].msn;

						if (res == 1) {

							ok(msn);

							$('#numpedido').html(0);

							$('#modalpedido').modal('hide');

							$('#modalinfo').modal('hide');

						} else {

							error(msn);

						}

					}, "json");

				}

			});

		}



	}

	else if(o=="HACERPEDIDO" || o=="HACERPEDIDO2")

	{

		var lista  = $('input:checkbox[name="cklista"]:checked').val();

		if(lista=="" || lista==undefined || lista==null){lista=0;}

		var notapedido = localStorage.getItem('notapedido');

		var fecent = localStorage.getItem('fechaentrega');

		var horent = localStorage.getItem('horaentrega');



		if(notapedido=="" || notapedido==null || notapedido==undefined)

		{

			notapedido = "";

		}

		else

		{

			notapedido = notapedido.replace(new RegExp("\n","g"), "<br>");

		}





		var nombrelista = "";

		if($('#txtnombrelista').length>0)

		{

		 	nombrelista = $('#txtnombrelista').val();

		}



		if(lista==1 && (nombrelista=="" || nombrelista==null) && o=="HACERPEDIDO")

		{

			error2("Ingresar el nombre de la lista que deseas guardar");

		}

		else if(fecent=="" || fecent==null || fecent==undefined || fecent=="0000-00-00")

		{

			error2("Seleccionar la fecha en que desea que se le haga entrega de su pedido");

		}

		else if(horent=="" || horent==null || horent==undefined || horent=="00:00")

		{

			error2("Seleccionar la hora en que desea que se le haga entrega de su pedido");

		}

		else

		{			

			var datos = new FormData();

			datos.append("notapedido", notapedido);

			datos.append('fechaentrega', fecent);

			datos.append('horaentrega',horent);

			$('#btnenviar').button('loading');

			jQuery.ajax({

	        url: "modulos/pedidos/enviarpedido.php?idpedido="+id+"&lista="+lista+"&nombrelista="+nombrelista,

	        type: "POST",

	       	data: datos,     

	        async:false,       

	        contentType: false,

	        cache: false,

	        processData:false,

	        dataType:"json",

	        crossDomain : true,

	        }).                               

	        done( function(data)

	        {

	        	console.log(data[0].res);

	        	var res = data[0].res;

	        	var msn = data[0].msn;

	        	var idpedido = data[0].idpedido;

	        	

	            

	             if(res=="ok")

	            {

					ok2(msn);

					$('#btnenviar').button('reset');

					$('#numpedido').html(0);

					$('#modalinfo').modal('hide');

					$('#modalpedido').modal('hide');

					localStorage.removeItem('notapedido');

					localStorage.removeItem('fechaentrega');

					localStorage.removeItem('horaentrega');

					setTimeout(CRUDPEDIDOS('LISTAPRODUCTOS',''),1000);

					//abri una ventana de soporte del pedido en ped

					num = 1;

	            } 

	            else

	            {

	            	if(res=="error1")

	            	{       	

					   	swal({

						position: 'bottom-end',

						type: 'info',

						title: msn,

						html:"",

						showConfirmButton: true,

						confirmButtonText: 'Ir a mis direcciones!'		

						})

						.then(function (result) 

						{

							if (result.value) {

									//$('#modalinfo').modal('hide');

								    //$('#modallogin').modal('show');

								   // CRUDUSUARIOS('LOGIN','','');

								   window.location.href = "index.php#/acount/Ajustes?Op=dir"; 

								   $('#modalinfo').modal('hide');

								   $('#modalpedido').modal('hide');

        						   //window.location.reload();



							}

						})

	            	}

	            	else if(res=="error2")

	            	{

	            		error2(msn);

	            	}

	            	else

	            	{

						error(msn);

						$('#btnenviar').button('reset');

					}

					num = 1;

				}              

	        })

	       .fail(function( jqXHR, textStatus, errorThrown ) {

			     if ( console && console.log ) {

			         console.log( "La solicitud a fallado: " +  textStatus);

	                 result = true;

			     }

			});

   		}

	}

	else if(o=="PEDIDOS")

	{		

		var estado  = $('#idestado').val();

		var lista = $('#idlista').val();

		if(estado=="0"){ $('#textestado').html("Pedidos en proceso");}

		if(estado=="1"){ $('#textestado').html("Pedidos pendientes");}

		if(estado=="2"){ $('#textestado').html("Pedidos en proceso de entrega");}

		if(estado=="3"){ $('#textestado').html("Pedidos entregados");}

		if(estado=="4"){ $('#textestado').html("Pedidos cancelados");}

		if(lista==1){ $('#textestado').html("Sugerencia");}

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,estado:estado}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#divfiltros').html(data);

		});

	}

	else if(o=="VERPEDIDOS")

	{

		var estado  = $('#idestado').val();

		var cliente = $('#selcliente').val();

		var lista = $('#idlista').val();

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,estado:estado,cliente:cliente,lista:lista}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#tabladatos').html(data);

		});

	}

	else if(o=="VERDETALLE")

	{

		$('#titleinfo').html("Detalle Pedido");	

		$('#btnenviar').hide();

		$('#modalinfo').modal('show');

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,idpedido:id}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodalinfo').html(data);

		});

	}

	else if(o=="VERIFICARPEDIDO")

	{

		$('#titleinfo').html("Verificacion de Pedido");	

		$('#btnenviar').show();

		$('#btnenviar').attr('onclick',"CRUDPEDIDOS('DESPACHARPEDIDO','"+id+"','')").text("Despachar pedido").attr('disabled', true);

		$('#modalinfo').modal('show');

		var fecd = localStorage.getItem('fechadespacho' + id);

		if(fecd=="" || fecd==null || fecd==undefined)

		{

			fecd = "";

		}

		var hord = localStorage.getItem('horadespacho' + id);

		if(hord=="" || hord==null || hord==undefined)

		{

			hord = "";

		}

		

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,idpedido:id,fecd:fecd,hord:hord}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodalinfo').html(data);

		});

	}

	else if(o=="GUARDARVERIFICACION")

	{

		var domi = $('#tddomicilio').text();

		domi = domi.replace("$", "").replace("$", "");

		domi = domi.replace(",", "").replace(",", "");

		domi = domi.replace(",", "").replace(",", "");





		var conf =  $("input:radio[name='conf_"+idc+"']:checked").val();



		

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,idpedido:id,iddetalle:idc,conf:conf,domi:domi}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			var res = data[0].res;

			var msn = data[0].msn;

			var confirmados = data[0].confirmados;

			var sinconfirmar = data[0].sinconfirmar;

			var total = data[0].total;

			var subtotal = data[0].subtotal;

			if(res=="ok")

			{

				$('#spanconfirmados').html(confirmados);

				$('#spansinconfirmar').html(sinconfirmar);

				$('#tdtotal').html(total);

				$('#tdsubtotal').html(subtotal);

				

				if(subtotal<=0)

				{

					$('#btnenviar').attr('onclick',"CRUDPEDIDOS('CANCELARPEDIDO','"+id+"','')").text("Cancelar pedido").attr('disabled', false);

				}

				else

				{

					$('#btnenviar').attr('onclick',"CRUDPEDIDOS('DESPACHARPEDIDO','"+id+"','')").text("Despachar pedido");

					if(sinconfirmar<=0 )

					{

						$('#btnenviar').attr('disabled', false);

					}

					else

					{

						$('#btnenviar').attr('disabled', true);

					}

				}

				

				setTimeout(INICIALIZARCONTENIDO(),1000);

			}

			else

			{

				error(msn);

			}

		},"json");



	}

	else if(o=="DESPACHARPEDIDO")

	{

		var porconfirmar = parseInt($.trim($('#spansinconfirmar').text()));



		var fechadespacho = $('#txtfechadespacho').val();

		var horadespacho = $('#txthoradespacho').val();

		if(porconfirmar>0)

		{

			error2("Falta "+porconfirmar+" productos por verificar");

		}

		else if(fechadespacho=="" || fechadespacho==null || fechadespacho=="0000-00-00")

		{

			error2("Seleccionar la fecha en que se entregara el pedido");

		}

		else if(horadespacho=="" || horadespacho==null)

		{

			error2("Seleccionar la hora en que se entregara el pedido");

		}



		else

		{

			//window.open("modulos/pedidos/informes/impfactura.php?clave="+id);

			swal({

				title: 'Desea enviar confirmacion al cliente?',

				text: "",

				type: 'info',

				showCancelButton: true,

				confirmButtonColor: '#3085d6',

				cancelButtonColor: '#d33',

				confirmButtonText: 'Si, enviar!',

				cancelButtonText: 'No, enviar!'

			}).then(function (result) {

				if (result.value) 

				{

					$.post('funciones/pedidos/fnPedidos.php', { opcion: o, idpedido: id ,conf:"si",fechadespacho:fechadespacho,horadespacho:horadespacho}, function (dato) {

						var res = dato[0].res;

						var msn = dato[0].msn;

						if (res == "ok") {

							$('#modalinfo').modal('hide');

							var table = $('#tbpedidos').DataTable();

							table.row('#rowp_' + id).draw(false);



							ok2(msn);

							setTimeout(function()

							{

								window.open("modulos/pedidos/informes/impfactura.php?clave="+id);

							},100)

							

							//setTimeout(CRUDPEDIDOS('VERPEDIDOS', '',''), 1000);

						} else {

							error(msn);

						}

					}, "json");

				}

				else

				{

					$.post('funciones/pedidos/fnPedidos.php', { opcion: o, idpedido: id,conf:"no" ,fechadespacho:fechadespacho,horadespacho:horadespacho}, function (dato) {

						var res = dato[0].res;

						var msn = dato[0].msn;

						if (res == "ok") {

							$('#modalinfo').modal('hide');

							var table = $('#tbpedidos').DataTable();

							table.row('#rowp_' + id).draw(false);

							ok2(msn);

							setTimeout(function()

							{

								window.open("modulos/pedidos/informes/impfactura.php?clave="+id);

							},100)							

							//setTimeout(CRUDPEDIDOS('VERPEDIDOS', '',''), 1000);

						} else {

							error(msn);

						}

					}, "json");

				}

			});

		}

	}

	else if(o=="TOMARPEDIDO")

	{

		swal({

			title: 'Estas seguro de tomar el pedido seleccionado?',

			text: "¡No podrás revertir esto!!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, tomar entrega!',

			cancelButtonText: 'No, tomar entrega!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/pedidos/fnPedidos.php', { opcion: o, id: id }, function (dato) {

					var res = dato[0].res;

					var msn = dato[0].msn;

					if (res == "ok") {

						ok(msn);

						setTimeout(CRUDPEDIDOS('VERPEDIDOS', '',''), 1000);

					} else {

						error(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="ASIGNARPEDIDO")

	{

		$('#titleright').html("Asignación domiciliario a Pedido");			

		$('#modalright').modal('show');

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,idpedido:id}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodalright').html(data);

		});

	}

	else if(o=="CERRARPEDIDO" || o=="CERRARPEDIDO2")

	{

		swal({

			title: 'Estas seguro de cerrar el pedido?',

			text: "!",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, cerrar pedido!',

			cancelButtonText: 'No, cerrar pedido!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/pedidos/fnPedidos.php', { opcion: "CERRARPEDIDO", id: id }, function (dato) {

					var res = dato[0].res;

					var msn = dato[0].msn;

					if (res == "ok") {

						ok(msn);

						if(o=="CERRARPEDIDO")

						{

							setTimeout(CRUDPEDIDOS('VERPEDIDOS', '',''), 1000);

						}

						else

						{

							var table = $('#tbpedidos').DataTable();

							table.row('#rowp_' + id).draw(false);

						}

					} else {

						error(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="GUARDARASIGNACION")

	{

		var dom = $('#seldomiciliario').val();

		if(dom=="")

		{

			error("Debe seleccionar el domiciliario a asignar al pedido");

		}

		else

		{

			swal({

				title: 'Estas seguro de asignar el pedido al domiciliario seleccionado?',

				text: "!",

				type: 'warning',

				showCancelButton: true,

				confirmButtonColor: '#3085d6',

				cancelButtonColor: '#d33',

				confirmButtonText: 'Si, asignar!',

				cancelButtonText: 'No, asignar!'

			}).then(function (result) {

				if (result.value) {

					$.post('funciones/pedidos/fnPedidos.php', { opcion: o, id: id, dom: dom }, function (dato) {

						var res = dato[0].res;

						var msn = dato[0].msn;

						if (res == "ok") {

							ok(msn);

							$('#modalright').modal('hide');

							var table = $('#tbpedidos').DataTable();

							table.row('#rowp_' + id).remove().draw(false);

							//setTimeout(CRUDPEDIDOS('VERPEDIDOS', ''), 1000);

						} else {

							error(msn);

						}

					}, "json");

				}

			});

		}

	}	

	else if(o=="ANADIRLISTA")

	{

		swal({

			title: 'Estas seguro de añadir la lista seleccionada ?',

			text: "",

			type: 'warning',

			showCancelButton: true,

			confirmButtonColor: '#3085d6',

			cancelButtonColor: '#d33',

			confirmButtonText: 'Si, añadir!',

			cancelButtonText: 'No añadir!'

		}).then(function (result) {

			if (result.value) {

				$.post('funciones/pedidos/fnPedidos.php', { opcion: o, id: id }, function (dato) {

					var res = dato[0].res;

					var msn = dato[0].msn;

					var can = dato[0].can;

					var idpedido = dato[0].idpedido;

					if (res == "ok") {

						ok("Lista de deseo agregada correctamente para pedir");

						$('#numpedido').html(can);

						setTimeout(CRUDPEDIDOS('DETALLEPEDIDO', idpedido,''), 1000);

						//setTimeout(CRUDPEDIDOS('LISTAPRODUCTOS',''),1000);

					} else {

						error2(msn);

					}

				}, "json");

			}

		});

	}

	else if(o=="INFOPRODUCTO")

	{

		var canp = $('#product_quantity_' + id ).val();

		var selcla = $('#selcla').val();

		$('#titleinfo').html("Info Producto");	

		$('#btnenviar').hide();

		$('#contenidomodalinfo').html('');

		var idt = $('#idtienda').val();

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,idproducto:id,canp:canp,selcla:selcla,idt:idt}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#contenidomodalinfo').html(data);

		});

	}

	else if(o=="VALIDARLISTADESEO")

	{

		var li = $('#cklista:checked').val();

		if(li==1)

		{

			$('#trlista').removeClass('hide');

		}

		else

		{

			$('#trlista').addClass('hide');

		}

	}

	else if(o=="VERLISTAPRODUCTOSAGREGAR")

	{

		var idp = $('#btnagregarproducto').attr('data-pedido');	

		$('#divproductosagregar').html('');

		$.post('funciones/pedidos/fnPedidos.php', {opcion: o,idcalidad:idc,idpedido:idp}, function(data, textStatus, xhr) {

			/*optional stuff to do after success */

			$('#divproductosagregar').html(data);

		});

	}

}



function INICIALIZARCONTENIDO()

{

	//adjuntos

	$(".dropify").dropify({

        messages: {

            'default': 'Arrastre imagen o haga click aqui',

            'replace': 'Arrastre y suelte o haga clic para reemplazar',

            'remove':  'Eliminar',

            'error':   'Ooops, algo pasó mal'

        }

    });



    autosize($('textarea'));



	//lista con filtros

    $('.selectpicker').selectpicker({

      liveSearch: true,

	  hideDisabled: true

     

    }).on('change',function(){

	    //$(this).selectpicker('toggle');	

		////console.log("Por aca");	

	});

    $('.currency4').formatCurrency({ symbol: '', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

    $('.currency').formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

    $('.currency3').formatCurrency({ symbol: '%', eventOnDecimalsEntered: true, roundToDecimalPlace: 1 });

    $('.currency2').formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });



	$('.currency2').blur(function() {

		//$('.currency').html(null);

		$(this).formatCurrency({ symbol: '', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

	})

	.focus(function(){

		$(this).formatCurrency({ symbol: '', eventOnDecimalsEntered: true, roundToDecimalPlace: 0, digitGroupSymbol: '', });			

	})

	.bind('decimalsEntered', function(e, cents) {

		var errorMsg = 'Please do not enter any cents (0.' + cents + ')';				

		//console.log('Event on decimals entered: ' + errorMsg);

	});	



	$('.currency').blur(function() {

		//$('.currency').html(null);

		$(this).formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

	})

	.focus(function(){

		$(this).formatCurrency({ symbol: '', eventOnDecimalsEntered: true, roundToDecimalPlace: 0, digitGroupSymbol: '', });			

	})

	.bind('decimalsEntered', function(e, cents) {

		var errorMsg = 'Please do not enter any cents (0.' + cents + ')';				

		//console.log('Event on decimals entered: ' + errorMsg);

	});	

	//horas

	 $(".timepicker").timepicker({

      showInputs: false,

      showMeridian: false,

      minuteStep:5

    });



	 $('.datepicker').datepicker({clearBtn:true,language:"es",todayBtn:'linked',todayHighlight:true,enableOnReadonly:true});



	 $('.radiospedido').radiosToSlider({

    	animation: true,

	});



	 $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({

      checkboxClass: 'icheckbox_flat-green',

     radioClass: 'iradio_flat-green'

    });



	 $('[data-toggle="tooltip"]').tooltip(); 



	$(document).ready(function(){

		 $("img").bind("contextmenu", function(){

    		return false;

   		});

	});

}

function EDITARDETALLE(det,cant,idt)

{

	if(cant<=0)

	{

		error("Indicar una cantidad mayor a cero");

	}

	else

	{

		$.post('funciones/pedidos/fnSolicitar.php', {opcion: 'ACTUALIZARPRODUCTO',iddetalle:det,cant:cant,idt:idt}, function(data, textStatus, xhr) {

			var res = data[0].res;

			var msn = data[0].msn;

			var sub = data[0].sub;

			var tot = data[0].tot;



			if(res==1)

			 {

			 	$('#subtotal_' + det).html(sub);

			    $('.sc-cart-summary').html("Total: "+tot);

			 }

			 else

			 {

			 	error(msn);

			 }

		},"json");

		

	}

}





function IncDec(pik)

{

	//plugin bootstrap minus and plus

//http://jsfiddle.net/laelitenetwork/puJ6G/



 //

  $('.' + pik).each(function(index, el) {

  		var picker = $(this);

  		var p = picker.find('button:last-child');

        var m = picker.find('button:first-child');

        var input = picker.find('input'); 

        var span = picker.find('span');                

        var min = parseInt(input.attr('min'), 10);

        var max = parseInt(input.attr('max'), 10);

        var step = parseInt(input.attr('step'),10);

        var dun = input.attr('data-unidad');

        var sav = input.attr('data-save');

        var det = input.attr('data-detalle');

        var un = input.attr('data-un');

        var unv = input.attr('data-un');

        var pesou = input.attr('data-peso-unidad');

        picker.attr('data-after',unv);

        var valoact = input.val();

        if(parseInt(valoact, 10)>=1000 && un=="GR"){ unv = "KG";  valoact = valoact/1000; }else{unv = un;}

	    span.html(valoact);

	    picker.attr('data-after',unv);

	    var visprecio = $('#pricesmall_' + det);//precio x cantidad

	    var viscantidad = $('#product_quantity_' + det);//precio x cantidad

    	var visprecio2 = $('#precio_' + det);//precio x cantidad 

    	var precio = $('#product_price2_' + det).val();// precio unidad



	    var estimado  = (input.val()*pesou)/1000;	

		if(un=="UND")

		{

			var totprecio = precio * input.val();

			visprecio.html(totprecio);

			viscantidad.val(input.val());

			visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

			visprecio2.html(totprecio);

			visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });



			$('#emestimado_' + det).show();

			$('#esti_' + det).html(estimado + "kg");

			if($('#emestimadoinfo_'+det).length>0)

			{

				$('#emestimadoinfo_' + det).show();

				$('#estiinfo_' + det).html(estimado + "kg");

			}

			if($('#emestimadodetalle_'+det).length>0)

			{

				$('#emestimadodetalle_' + det).show();

				$('#estidetalle_' + det).html(estimado + "kg");

			}

		}

		else

		{

			var totprecio = precio * (input.val()/input.attr('min'));

			visprecio.html(totprecio);

			viscantidad.val(input.val());

					visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					visprecio2.html(totprecio);

					visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

			$('#emestimado_' + det).hide();

			if($('#emestimadoinfo_'+det).length>0)

			{

				$('#emestimadoinfo_' + det).hide();

			}

			if($('#emestimadodetalle_'+det).length>0)

			{

				$('#emestimadodetalle_' + det).hide();

			}

		}

  });



$('.' +pik).on("click", ".btn-number", function(e){

    var picker = $(this).parents('.'+pik);

    var span = picker.find('span');



    var fieldName = $(this).attr('data-field');

	var type = $(this).attr('data-type');



    var input = $("#" + fieldName); //$("input[name='"+fieldName+"']");

    var dun = input.attr('data-unidad');

	var sav = input.attr('data-save');

	var det = input.attr('data-detalle');//iddeproducto

	var un = input.attr('data-un');

	var unv = input.attr('data-un');

    var step = input.attr('step'); if(step<=0 || step==undefined){step=1; console.log("por aca");}

    var pesou = input.attr('data-peso-unidad');



    var precio = $('#product_price2_' + det).val();// precio unidad

	var viscantidad = $('#product_quantity_' + det);//precio x cantidad

    var visprecio = $('#pricesmall_' + det);//precio x cantidad

    var visprecio2 = $('#precio_' + det);//precio x cantidad

    var currentVal = parseInt(input.val());

    var valoact = 0;

    var valoractual = 0;

    var g = 0;



	if (!isNaN(currentVal))

	{

	    if(type == 'minus')

	    {

	        console.log("minus");

	        if(currentVal > input.attr('min'))

	        {

	            input.val(currentVal - parseInt(step)).change();

	            valoact = currentVal - parseInt(step);

	            valoactual = currentVal - parseInt(step);

	            if(parseInt(valoact, 10)>=1000 && un=="GR"){ unv = "KG";  valoact = valoact/1000; }else{unv = un;}

	            span.html(valoact);

	            picker.attr('data-after',unv);

				var estimado  = (input.val()*pesou)/1000;



				if(un=="UND")

				{

					var totprecio = precio * input.val();

					$('#emestimado_' + det).show();

					$('#esti_' + det).html(estimado + "kg");

					visprecio.html(totprecio);

					viscantidad.val(input.val());

					visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					visprecio2.html(totprecio);

					visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					if($('#emestimadoinfo_'+det).length>0)

					{

						$('#emestimadoinfo_' + det).show();

						$('#estiinfo_' + det).html(estimado + "kg");

					}

					if($('#emestimadodetalle_'+det).length>0)

					{

						$('#emestimadodetalle_' + det).show();

						$('#estidetalle_' + det).html(estimado + "kg");

					}

				}

				else

				{

					var totprecio = precio * (input.val()/input.attr('min'));

					$('#emestimado_' + det).hide();

					visprecio.html(totprecio);

					viscantidad.val(input.val());

					visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					visprecio2.html(totprecio);

					visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					if($('#emestimadoinfo_'+det).length>0)

					{

						$('#emestimadoinfo_' + det).hide();

					}

					if($('#emestimadodetalle_'+det).length>0)

					{

						$('#emestimadodetalle_' + det).hide();

					}

				}

	        }



	        if(parseInt(input.val()) == parseInt(input.attr('min'))) {

	            $(this).attr('disabled', true);

	        }

	        else

	        {

	        	$(this).attr('disabled', false);

	        }



	    }

	    else if(type == 'plus')

	    {

	    	console.log("plus");

	        if(currentVal < input.attr('max')) {

	            input.val(currentVal + parseInt(step)).change();

	            valoact = currentVal + parseInt(step);

	             if(parseInt(valoact, 10)>=1000 && un=="GR"){ unv = "KG";  valoact = valoact/1000; }else{unv = un;}

	            span.html(valoact);

	            picker.attr('data-after',unv);

	            var estimado  = (input.val()*pesou)/1000;



				if(un=="UND")

				{

					var totprecio = precio * input.val();

					$('#emestimado_' + det).show();

					$('#esti_' + det).html(estimado + "kg");

					visprecio.html(totprecio);

					viscantidad.val(input.val());

					visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					visprecio2.html(totprecio);

					visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					if($('#emestimadoinfo_'+det).length>0)

					{

						console.log("Actualiza info")

						$('#emestimadoinfo_' + det).show();

						$('#estiinfo_' + det).html(estimado + "kg");

					}

					else

					{

						console.log("No Actualiza info")

					}

					if($('#emestimadodetalle_'+det).length>0)

					{

						$('#emestimadodetalle_' + det).show();

						$('#estidetalle_' + det).html(estimado + "kg");

					}

				}

				else

				{

					var totprecio = precio * (input.val()/input.attr('min'));

					$('#emestimado_' + det).hide();

					visprecio.html(totprecio);

					viscantidad.val(input.val());

					visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					visprecio2.html(totprecio);

					visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

					if($('#emestimadoinfo_'+det).length>0)

					{

						$('#emestimadoinfo_' + det).hide();

					}

					if($('#emestimadodetalle_'+det).length>0)

					{

						$('#emestimadodetalle_' + det).hide();

					}

				}

	        }

	        if(parseInt(input.val()) == input.attr('max')) {

	            $(this).attr('disabled', true);

	        }



	    }

	}

	else

	{

	    input.val(0);

	    span.html(0);

	}

		var minValue =  parseInt(input.attr('min'));

	    var maxValue =  parseInt(input.attr('max'));

	    var valueCurrent = parseInt(input.val());

	    //name = $(this).attr('id');

	    var gu = 0;

	    if(valueCurrent >= minValue) {



	    	gu = 1;

	        $(".btn-number[data-type='minus'][data-field='"+fieldName+"']").removeAttr('disabled')

	    }

	    else

	    {

	    	gu = 0;

	        error('Lo sentimos, se alcanzó el valor mínimo');

	        input.val(input.data('oldValue'));

	        valoact = input.data('oldValue');

	         if(parseInt(valoact, 10)>=1000 && un=="GR"){ unv = "KG";  valoact = valoact/1000; }else{unv = un;}

	        span.html(valoact);

	        picker.attr('data-after',unv);

	        var estimado  = (input.val()*pesou)/1000;



			if(un=="UND")

			{

				var totprecio = precio * input.val();

				$('#emestimado_' + det).show();

				$('#esti_' + det).html(estimado + "kg");

				visprecio.html(totprecio);

				viscantidad.val(input.val());

				visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				visprecio2.html(totprecio);

				visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				if($('#emestimadoinfo_'+det).length>0)

				{

					$('#emestimadoinfo_' + det).show();

					$('#estiinfo_' + det).html(estimado + "kg");

				}

				if($('#emestimadodetalle_'+det).length>0)

				{

					$('#emestimadodetalle_' + det).show();

					$('#estidetalle_' + det).html(estimado + "kg");

				}

			}

			else

			{

				var totprecio = precio * (input.val()/input.attr('min'));

				$('#emestimado_' + det).hide();

				visprecio.html(totprecio);

				viscantidad.val(input.val());

				visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				visprecio2.html(totprecio);

				visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				if($('#emestimadoinfo_'+det).length>0)

				{

					$('#emestimadoinfo_' + det).hide();

				}

				if($('#emestimadodetalle_'+det).length>0)

				{

					$('#emestimadodetalle_' + det).hide();

				}

			}

	    }



	    if(valueCurrent <= maxValue) {

	    	gu = 1;

	        $(".btn-number[data-type='plus'][data-field='"+fieldName+"']").removeAttr('disabled')

	    }

	    else

	    {

	    	gu = 0;

	        error('Lo sentimos, se alcanzó el valor máximo');

	        input.val(input.data('oldValue'));

	        valoact = input.data('oldValue');

	        if(parseInt(valoact, 10)>=1000 && un=="GR"){ unv = "KG";  valoact = valoact/1000; }else{unv = un;}



	        span.html(valoact);

	        picker.attr('data-after',unv);

	        var estimado  = (input.val()*pesou)/1000;



			if(un=="UND")

			{

				var totprecio = precio * input.val();

				$('#emestimado_' + det).show();

				$('#esti_' + det).html(estimado + "kg");

				visprecio.html(totprecio);

				viscantidad.val(input.val());

				visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				visprecio2.html(totprecio);

				visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				if($('#emestimadoinfo_'+det).length>0)

				{

					$('#emestimadoinfo_' + det).show();

					$('#estiinfo_' + det).html(estimado + "kg");

				}

				if($('#emestimadodetalle_'+det).length>0)

				{

					$('#emestimadodetalle_' + det).show();

					$('#estidetalle_' + det).html(estimado + "kg");

				}

			}

			else

			{

				var totprecio = precio * (input.val()/input.attr('min'));

				$('#emestimado_' + det).hide();

				visprecio.html(totprecio);

				viscantidad.val(input.val());

				visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				visprecio2.html(totprecio);

				visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				if($('#emestimadoinfo_'+det).length>0)

				{

					$('#emestimadoinfo_' + det).hide();

				}

				if($('#emestimadodetalle_'+det).length>0)

				{

					$('#emestimadodetalle_' + det).hide();

				}

			}

	    }

//alert("sav: "+sav+" / gu: "+gu);

			if(sav==1 && gu==1)

			{

				console.log("por aca" + gu);

				var ct = input.val();

				var idt = $('#idtienda').val();

				EDITARDETALLE(det,ct,idt);

			}

	     e = $.event.fix(e);

    	 e.preventDefault();

	});



	$('.input-number').focusin(function(){

	   $(this).data('oldValue', $(this).val());

	});

	$('.input-number').on('change keyup',function() {



		 var dun = $(this).attr('data-unidad');

		 var sav = $(this).attr('data-save');

		 var det = $(this).attr('data-detalle');

		 var un = $(this).attr('data-un');

		 var unv = $(this).attr('data-un');

         var step = $(this).attr('step'); if(step<=0 || step==undefined){ step=1; console.log("por aca");}

         var pesou = $(this).attr('data-peso-unidad');



         var precio = $('#product_price2_' + det).val();// precio unidad

    	 var visprecio = $('#pricesmall_' + det);//precio x cantidad

    	 var visprecio2 = $('#precio_' + det);



	    minValue =  parseInt($(this).attr('min'));

	    maxValue =  parseInt($(this).attr('max'));

	    valueCurrent = parseInt($(this).val());



	    name = $(this).attr('name');

	    var gu = 0;

	    if(valueCurrent >= minValue) {

	    	gu = 1;

	        $(".btn-number[data-type='minus'][data-field='"+name+"']").removeAttr('disabled')

	    } else {

	    	gu  = 0;

	        error('Lo sentimos, se alcanzó el valor mínimo');

	        $(this).val($(this).data('oldValue'));

	    }



	    if(valueCurrent <= maxValue) {

	    	gu = 1;

	        $(".btn-number[data-type='plus'][data-field='"+name+"']").removeAttr('disabled')

	    } else {

	    	gu  = 0;

	        error('Lo sentimos, se alcanzó el valor máximo');

	        $(this).val($(this).data('oldValue'));

	    }



	    if(sav==1 && gu==1)

		{

			console.log("por aca" + gu);

			var g = $(this).val();

			EDITARDETALLE(det,g,minValue,dun);

		}

		else if(gu==1)

		{

			var estimado  = ($(this).val()*pesou)/1000;



			if(un=="UND")

			{

				var totprecio = precio * $(this).val();

				$('#emestimado_' + det).show();

				$('#esti_' + det).html(estimado + "kg");

				visprecio.html(totprecio);

				visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				visprecio2.html(totprecio);

				visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				if($('#emestimadoinfo_'+det).length>0)

				{

					$('#emestimadoinfo_' + det).show();

					$('#estiinfo_' + det).html(estimado + "kg");

				}

				if($('#emestimadodetalle_'+det).length>0)

				{

					$('#emestimadodetalle_' + det).show();

					$('#estidetalle_' + det).html(estimado + "kg");

				}

			}

			else

			{

				var totprecio = precio * ($(this).val()/$(this).attr('min'));

				$('#emestimado_' + det).hide();

				visprecio.html(totprecio);

				visprecio.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });

				visprecio2.html(totprecio);

				visprecio2.formatCurrency({ symbol: '$', eventOnDecimalsEntered: true, roundToDecimalPlace: 0 });



				if($('#emestimadoinfo_' + det).length>0)

				{

					$('#emestimadoinfo_' + det).hide();

				}

				if($('#emestimadodetalle_'+det).length>0)

				{

					$('#emestimadodetalle_' + det).hide();

				}

			}

		}





	});

	$(".input-number").keydown(function (e) {

	    // Allow: backspace, delete, tab, escape, enter and .

	    if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||

	         // Allow: Ctrl+A

	        (e.keyCode == 65 && e.ctrlKey === true) ||

	         // Allow: home, end, left, right

	        (e.keyCode >= 35 && e.keyCode <= 39)) {

	             // let it happen, don't do anything

	             return;

	    }

	    // Ensure that it is a number and stop the keypress

	    if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {

	        e.preventDefault();

	    }

	});

}

function ACTUALIZARTALLAS(idd)

{

	var tall = $('#seltallas_'+idd).val();

	if(tall == null){ tall = ""; }

	$.post('funciones/pedidos/fnPedidos.php',{opcion:"ACTUALIZARTALLAS",idd:idd,tall:tall.toString()},

	function(data)

	{

		if(data<=0)

		{

			error("Ocurrio un error al actualizar las tallas, Verificar.");

		}

	});

}

function menulateral()

{

	 $("div.bhoechie-tab-menu>div.list-group>a").click(function(e) {

        e.preventDefault();

        $(this).siblings('a.active').removeClass("active");

        $(this).addClass("active");

        var index = $(this).index();

        $("div.bhoechie-tab>div.bhoechie-tab-content").removeClass("active");

        $("div.bhoechie-tab>div.bhoechie-tab-content").eq(index).addClass("active");

    });

}

function setpreview(rut,inp,formu) // creamos la función

 { 

 	$("#" + formu).attr('target', 'null');

 	$("#" + formu).attr('action', 'uploader.php?ruta='+ rut+'&input='+inp);

	 $('form[name="'+formu+'"]').submit();
	 console.log(formu)
	 parent.document.getElementById('visibilidadtalla2').style.display = "block";

//document.formu.target='null'; // seteamos el target del formulario en null para que se ejecute dentro del iframe llamado "null"-->

 //document.formu.action='uploader.php?ruta='+ rut+'&input='+inp; // seteamos la acción del formulario hacia nuestro archivo "uploader.php" -->

 //document.formu.submit(); // hacemos el envío de información sin salir de la pantalla del formulario -->

 }

function cargarsector(sel1,sel2,o,s,b)

{

	var sel2  = $('#'+sel2).val();

  	var sel1 = $('#'+sel1);

  	sel1.find('option').remove().end().append('<option value="">Cargando...</option>').val('');  	



  	$.post('funciones/sectores/fnSectores.php',{opcion:o,sel2:sel2},

	function(data)

	{

		sel1.empty();

		sel1.append('<option value="">--seleccione--</option>');

		var res = data[0].res;

		if(res=="no")

		{

		sel1.selectpicker('refresh');

		}

	    else

	    {        

	        for (var i=0; i<data.length; i++)

	        {

	        	var se = "";

	        	if(s==data[i].id)

	        	{

	        		se = "selected";

	        	}

	        	sel1.append('<option '+se+' value="' + data[i].id + '">' + data[i].literal + '</option>');

	        }

	        setTimeout(function(){

	        	sel1.selectpicker('refresh');

	        },1000);

	        setTimeout(cargarbarrio('selbarrio','selsector',b),1000);

		}

	},"json");

} 

function cargarbarrio(sel1,sel2,b)

{

	var sel2  = $('#'+sel2).val();

  	var sel1 = $('#'+sel1);

  	sel1.find('option').remove().end().append('<option value="">Cargando...</option>').val('');  	



  	$.post('funciones/pedidos/fnPedidos.php',{opcion:'CARGARBARRIOS',sector:sel2},

	function(data)

	{

		sel1.empty();

		sel1.append('<option value="">--seleccione--</option>');

		var res = data[0].res;

		if(res=="no")

		{

		sel1.selectpicker('refresh');

		}

	    else

	    {        

	        for (var i=0; i<data.length; i++)

	        {

	        	var se = "";

	        	if(b==data[i].id){ se ="selected"; }

	        	sel1.append('<option '+se+' value="' + data[i].id + '">' + data[i].literal + '</option>');

	        }

	        setTimeout(function(){

	        	sel1.selectpicker('refresh');

	        },1000);

		}

	},"json");

}



function ckradio(name,value,pik)

{

	$("input[name="+name+"][value='"+value+"']").prop("checked",true);

	var idp = $("input[name="+name+"][value='"+value+"']").attr('data-idp');

	var min = $("input[name="+name+"][value='"+value+"']").attr('data-uni-min');

	var tex = $("input[name="+name+"][value='"+value+"']").attr('data-text-min');

	var ste = $("input[name="+name+"][value='"+value+"']").attr('data-uni-step');

	//$('#product_quantity_' + idp).val(min).prop('step',min).prop('min',min);

	$('#product_quantity4_' + idp).val(min).prop('step',ste).prop('min',min);

	$('#product_quantity4_' + idp).attr('data-un',tex).val(min); 

	$('#spanproduct_quantity2_' + idp).html(min);



	//$('#unidadproducto_' + idp).html(tex);

	if(value==0)

	{

		$('#spanproduct_quantity2_' + idp).addClass('hide');

	}

	else

	{

		$('#spanproduct_quantity2_' + idp).removeClass('hide');

	}



	$('#plus_' + idp).attr('data-after',tex);



	setTimeout(function(){

		 //$('#plus_' + idp).numberPicker();

	},100);

}

 window.fbAsyncInit = function() {

    FB.init({

      appId      : '2165776403659021',

      cookie     : true,  // enable cookies to allow the server to access 

                          // the session

      xfbml      : true,  // parse social plugins on this page

      version    : 'v2.8' // use graph api version 2.8

  });

  };

 function LOGOUT()

   {

   	// e.preventDefault();



	 FB.getLoginStatus(function(response){



	 	 if(response.status === 'connected'){     

	 	 

	 	 	FB.logout(function(response){



	 	 		deleteCookie("fblo_307504983059062");



	 	 		// console.log("salir");



	 	 		setTimeout(function(){



	 	 			setTimeout(function(){



			           		window.location='data/logout.php';



			         },500)



	 	 		},500)



	 	 	});



	 	 	function deleteCookie(name){



	 	 		 document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';



	 	 	}



	 	 }



	 })



   }



   function localStora(input, valor)

   {

   		if (typeof(Storage) !== "undefined") {

    	// Code for localStorage/sessionStorage.

    		// Store

			localStorage.setItem(input, valor);

			if(input=="fechaentrega")

			{

				setTimeout(function() { CRUDPEDIDOS('VALFECENTREGA','',''); } , 1000);

			}

			else if(input=="horaentrega")

			{

				$('#spanhora').html(valor);

			}

		}

		 else 

		{

		    error("Sorry! No Web Storage support..")

		}

   }





   function CRUDREGLAS(o,id)

   {

   	 if(o=="REGLASNEGOCIO")

   	 {

   	 	$('#titlelogin').html("Reglas de negocio");

		$('#divlogin').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

        {

			$('#divlogin').html(data);

		});		

   	 }

   	 else if(o=="LISTAFECHASOMITIR")

   	 {

   	 	$('#divfechasomitir').html('');

		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o},

		function(data)

        {

			$('#divfechasomitir').html(data);

		});		

   	 }

   	 else if(o=="GUARDARFECHA")

   	 {

   	 	var fec = $('#txtfechaomitir').val();

   	 	if(fec=="" || fec==null || fec==undefined)

   	 	{

   	 		error("Seleccionar fecha a agregar");

   	 	}

   	 	else

   	 	{

   	 		$.post('funciones/usuarios/fnUsuarios.php',{opcion:o,fec:fec},

			function(data)

        	{

				var res = data[0].res;

				var msn = data[0].msn;

				if(res=="ok")

				{

					ok(msn);

					$('#txtfechaomitir').val('');

					setTimeout(function(){

						CRUDREGLAS('LISTAFECHASOMITIR');

					},100);

				}

				else

				{

					error(msn);

				}

			},"json");	

   	 	}

   	 }

   	 else if(o=="ELIMINARFECHA")

   	 {

   	 	$.post('funciones/usuarios/fnUsuarios.php',{opcion:o,id:id},

			function(data)

        	{

				var res = data[0].res;

				var msn = data[0].msn;

				if(res=="ok")

				{

					$('#rowf_'+id).fadeOut('slow');					

				}

				else

				{

					error(msn);

				}

			},"json");

   	 }

   	 else if(o=="GUARDARREGLA")

   	 {

		var mon = $('#txtmonto').val(); 

		mon = mon.replace("$", "").replace("$", "");

		mon = mon.replace(",", "").replace(",", "");

		mon = mon.replace(",", "").replace(",", ""); if(mon==null || mon==undefined){ mon = 0; }

   	 	var horaped = $('#txthoraped').val();

   	 	var horaent = $('#txthoraent').val();

   	 	var horamax = $('#txthoramaxent').val();



   	 	$.post('funciones/usuarios/fnUsuarios.php',{opcion:o,mon:mon,horaped:horaped,horaent:horaent,horamax:horamax},

		function(data)

        {

        	var res = data[0].res;

        	var msn = data[0].msn;

        	if(res=="ok")

        	{

        		ok(msn);

        	}

        	else

        	{

        		error(msn);

        	}

		},"json");		

   	 }



   }



   function validarTamanoImg(fileUpload,h,w)

   {

   	  //Check whether the file is valid Image.

        var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(.jpg|.jpeg|.png|.gif)$");

        if (regex.test(fileUpload.value.toLowerCase())) {

            //Check whether HTML5 is supported.

            if (typeof (fileUpload.files) != "undefined") {

                //Initiate the FileReader object.

                var reader = new FileReader();

                //Read the contents of Image File.

                reader.readAsDataURL(fileUpload.files[0]);

                reader.onload = function (e) {

                    //Initiate the JavaScript Image object.

                    var image = new Image();

                    //Set the Base64 string return from FileReader as source.

                    image.src = e.target.result;

                    image.onload = function () {

                        //Determine the Height and Width.

                        var height = this.height;

                        var width = this.width;

                        if (height > h || width > w) {

                            error("Height and Width must not exceed 100px.");

                            return 2;

                        }

                        //ok("Uploaded image has valid Height and Width.");

                        

                        return 1;

                    };

                }

                console.log( reader );

            } else {

                error("This browser does not support HTML5.");

                return 2;

            }

        } else {

            error("Please select a valid Image file.");

            return 2;

        }

   }



  function CRUDINFORMES(o,fec,idp,idc,tam,mad)

  {



  	if(o=="INFORMEDESPACHOS")

  	{

  		$('#tabladatos').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/informes/fnInformes.php',{opcion:o},

		function(data)

		{		

			$('#tabladatos').html(data);

		});

  	}

  	else if(o=="LISTAINFORMEDESPACHOS")

  	{

  		$('#divlistadespacho').html('<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div></div>');

		$.post('funciones/informes/fnInformes.php',{opcion:o},

		function(data)

		{		

			$('#divlistadespacho').html(data);

		});

  	}

  	else if(o=="GUARDARVERIFICACION")

  	{

  		$.post('funciones/informes/fnInformes.php',{opcion:o,fec:fec,idp:idp,idc:idc,tam:tam,mad:mad},

		function(data)

		{		

			var res = data[0].res;

			var msn = data[0].msn;

			if(res=="error")

			{

				error(msn);

			}

			else

			{

				

			}

		},"json");

  	}

  }



  function selectDatosDireccion(ciu,bar,sec,ciudades,barrios)

  {

  	

  	console.log("Lista de barrios" + barrios);

  	console.log("Lista de ciudades" + ciudades);





  	$.post('funciones/pedidos/fnPedidos.php',{opcion:"VALIDARDIRECCION",ciu:ciu,bar:bar,sec:sec,ciudades:ciudades,barrios:barrios},

  		function(data){

  			var res = data[0].res;

  			var codciu = data[0].codciu;

  			var codsec = data[0].codsec;

  			var codbar = data[0].codbar;

  			if(res=="ok")

  			{

  				$('#selmunicipio>option[value="'+codciu+'"]').attr('selected','selected');

  				$('#selmunicipio').selectpicker('refresh');

  				setTimeout(function(){

  					 cargarsector('selsector','selmunicipio','CARGARSECTORES',codsec,codbar)

  				},1000);

  			}

  			else

  			{

  				error("Tu dirección no concuerda entre los barrios que abarcamos, seleccionalo de la lista");

  				setTimeout(function(){

  					 cargarsector('selsector','selmunicipio','CARGARSECTORES',codsec,codbar)

  				},1000);

  			}

  		},"json");

  }

function COPIARLINK(clave,opc)

{

	// Crea un campo de texto "oculto"

	var aux = document.createElement("input");

	// Asigna el contenido del elemento especificado al valor del campo

	if(opc == "tienda")

	{

		aux.setAttribute("value", "http://www.locomproaqui.com/?idtienda="+clave);

	}

	else

	{

		aux.setAttribute("value", "http://www.locomproaqui.com/?idtienda="+clave+"&registro=1");

	}

	// Añade el campo a la página

	document.body.appendChild(aux);

	// Selecciona el contenido del campo

	aux.select();

	// Copia el texto seleccionado

	document.execCommand("copy");

	// Elimina el campo de la página

	document.body.removeChild(aux);

	ok("URL copiada al portapapeles");

}

function SOLICITAR(idtienda,idp)

{
	$.post('funciones/pedidos/fnSolicitar.php', { opcion:'SOLICITARPRODUCTO',idtienda:idtienda,idp:idp }, function(data){

		window.open(data, '_blank');

	});

}

function SOLICITARPEDIDOPENDIENTE(idt)

{
	var notap = $('#txtnotapedido').val();

	$.post('funciones/pedidos/fnSolicitar.php', { opcion:'SOLICITARPEDIDOPENDIENTE',idtienda:idt,notap:notap }, function(data){

		window.open(data, '_blank');

	});

}

function AGREGARPEDIDO(idtienda,idp)

{

	var cp = $('#product_quantity_'+idp).val();

	$.post('funciones/pedidos/fnSolicitar.php', { opcion:'AGREGARPRODUCTO',idtienda:idtienda,idp:idp,cp:cp }, function(data){

		if(data >= 1)

		{

			ok("Producto agregado al carrito. <img class='img-cart' style='height: 65px;width: 65px' src='dist/img/car.png'><img class='img-cart' style='height: 100px;width: 65px' src='dist/img/logomano.png'>");

			$('#numpedido').html(data);

		}

		else

		{

			error("Hubo un error al agregar producto. Intentelo de nuevo");

		}

	});

}

function NUEVOREGISTRO()

{

	$("#modallogin").modal("show");

	CRUDUSUARIOS('REGISTRONUEVO','','');

}

$(window).scroll(function() {

	if($(window).scrollTop() + $(window).height() >= $(document).height()) {

		var last_id = $(".post-id:last").attr("id");

		loadMoreData(last_id);

	}

});

function loadMoreData(last_id){

	$.ajax(

		{

			url: 'loadMoreData.php?last_id=' + last_id,

			type: "get",

			beforeSend: function()

			{

				$('.ajax-load').show();

			}

		})

		.done(function(data)

		{

			$('.ajax-load').hide();

			$("#post-data").append(data);

		})

		.fail(function(jqXHR, ajaxOptions, thrownError)

		{

			alert('server not responding...');

		});

}

$("<a>")

	.attr("href", "img.jpg")

	.attr("download", "output.jpg")

	.appendTo("body")

	.click()

	.remove();